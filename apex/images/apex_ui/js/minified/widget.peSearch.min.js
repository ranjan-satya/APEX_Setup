/*!
 * Copyright (c) 2013, 2023, Oracle and/or its affiliates.
 */
!function(e,t,n){"use strict";var a="search_",o="warning",p="a-Icon icon-search";const i=n.hasOwnProperty;var r=null;function s(t,a){const i='\n            <li class="a-AlertMessages-item" data-typeid="#TYPEID#" data-componentid="#COMPONENTID#" data-propertyid="#PROPERTYID#">\n                <a href="#" class="a-MediaBlock a-AlertMessages-message">\n                    <div class="a-MediaBlock-graphic">\n                        <span class="#ICON_CLASS#"></span>\n                    </div>\n                    <div class="a-MediaBlock-content">\n                        <h5 class="a-AlertMessages-propertyTitle">#COMPONENT_TYPE#&colon; #COMPONENT# &rarr; #DISPLAY_GROUP# &rarr; #PROPERTY#</h5>\n                        <p class="a-AlertMessages-messageDescription"><pre>#VALUE#</pre></p>\n                    </div>\n                </a>\n            </li>';var r=t.component,s=t.getMetaData(),c=t.getDisplayValue();return c=(c=n.escapeHTML(c.replace(a,"~~peSearchHitBegin~~$&~~peSearchHitEnd~~"))).replace(/~~peSearchHitBegin~~/g,'<span class="a-Search-term">').replace(/~~peSearchHitEnd~~/g,"</span>"),i.replace(/#CSS_CLASS#/g,o).replace(/#ICON_CLASS#/g,p).replace("#TYPEID#",r.typeId).replace("#COMPONENTID#",r.id).replace("#PROPERTYID#",t.id).replace("#COMPONENT_TYPE#",n.escapeHTML(e.getComponentType(r.typeId).title.singular)).replace("#COMPONENT#",n.escapeHTML(r.getDisplayTitle())).replace("#DISPLAY_GROUP#",n.escapeHTML(e.getDisplayGroup(s.displayGroupId).title)).replace("#PROPERTY#",n.escapeHTML(s.prompt)).replace("#VALUE#",c)}t.widget("apex.peSearch",{options:{componentType:e.COMP_TYPE.PAGE},_create:function(){var n,o=this;o.componentType=this.options.componentType,this.element.empty(),n=t("<div>",{class:"a-AlertMessages"}).appendTo(this.element),this._container$=t("<ul></ul>",{class:"a-AlertMessages-list"}).appendTo(n).on("click","a",this._goToComponent),t(document).on("modelReady",(function(){e.observer(a+this.uuid,{events:[e.EVENT.CHANGE,e.EVENT.DELETE,e.EVENT.REMOVE_PROP]},(function(e){o._update(e)})),t(document).one("modelCleared",(function(){o._container$.empty(),r=null}))}))},_init:function(){},_destroy:function(){this.element.empty(),t(document).off("modelReady"),t(document).off("modelCleared"),e.unobserver(a+this.uuid)},search:function(t){r=t instanceof RegExp?t:""!==t&&void 0!==t?new RegExp(n.escapeRegExp(t),"gi"):null,this._container$.empty(),null!==r&&this._container$.append(function t(n,a){var o,p,i,r,c="";for(i=0,r=(o=e.fullTextSearch(a,{typeId:n})).length;i<r;i++)c+=s(o[i],a);for(i=0,r=(p=e.getComponentType(n)).childComponentTypes.length;i<r;i++)c+=t(p.childComponentTypes[i],a);return c}(this.componentType,r))},clear:function(){r=null,this._container$.empty()},_update:function(n){var a,o,p=r,c=n.component,l="li[data-typeid='"+c.typeId+"'][data-componentid='"+c.id+"']";if(null!==p)if(t.inArray(e.EVENT.DELETE,n.events)>=0)this._container$.find(l).remove();else for(var d in n.properties)i(n.properties,d)&&(a=this._container$.find(l+"[data-propertyid='"+d+"']"),t.inArray(e.EVENT.REMOVE_PROP,n.properties[d])>=0?a.remove():t.inArray(e.EVENT.CHANGE,n.properties[d])>=0&&a.length>0&&(o=[n.component.getProperty(d)],(o=e.fullTextSearch(p,{properties:o})).length>0?a.replaceWith(s(o[0],p)):a.remove()))},_goToComponent:function(){var n=t(this).closest("li"),a=e.getComponents(n.data("typeid"),{id:n.data("componentid")})[0];window.pageDesigner.goToComponent(a.typeId,a.id,n.data("propertyid"))}})}(window.pe,apex.jQuery,apex.util);