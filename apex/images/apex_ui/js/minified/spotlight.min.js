!function(e,t,s,i,a,l,r,n,o,c){"use strict";let h,p,d=0;const{formatMessage:g,getMessage:u}=r,y=o.APP_SESSION,f=$v("F4000_P1_FLOW")||$v("P4500_CURRENT_APP")||$v("P0_FLOWPAGE").split(";")[0]||null,m="search-page",_="search-app",S="search-all-apps",v="search-workspace",$="pe";class b{#e;#t;#s;static typeOf={function:"function",object:"object",string:"string"};constructor(e=[],t={}){this.#s={isCaseSensitive:!1,ignoreLocation:!1,includeScore:!1,includeMatches:!1,shouldSort:!0,keys:[],location:0,threshold:.6,distance:100,maxScore:.8,sortFn:this.#i},Object.freeze(this.#s),this.list=e,this.options=t}#a(e=""){if(this.options.keys.length){const t=1,s=[],i={};this.options.keys.forEach((a=>{let l,r;const n=new Set;if(typeof a===b.typeOf.object?Array.isArray(a)||void 0===a.name||(l={name:typeof a.name===b.typeOf.string?a.name:JSON.stringify(a.name),list:[]},r=a.weight??t):typeof a!==b.typeOf.function&&(l={name:typeof a===b.typeOf.string?a:JSON.stringify(a),list:[]},r=t),void 0!==l){let t;if(Array.isArray(l.name))t=l.name;else if(typeof l.name!==b.typeOf.function){const e=typeof l.name===b.typeOf.string?l.name:JSON.stringify(l.name);t=e.split(".")}void 0!==t&&this.#e.forEach(((e,s)=>{let a=e[t[0]];if(void 0!==a){if(t.length>1)for(let e=1;e<t.length;e++)a=void 0!==a[t[e]]?a[t[e]]:void 0;void 0!==a&&n.add(a);const e={item:a,refIndex:s,score:void 0===a?1:void 0};i[a]?i[a].push(e):i[a]=[e],l.list.push(e)}}));const a=this.#l(e,Array.from(n),r);if(a.length){for(let e=0;e<a.length;e++){const t=a[e],s=i[t.item];t.matches?.forEach((e=>{e.key=l.name})),s?.forEach((e=>{e.score=t.score,t.matches&&(e.matches=t.matches)}))}s.push(l)}}}));const a={};if(!s.length)return[];for(let e=0;e<s.length;e++){s[e].list.forEach((({score:e,refIndex:t,matches:s})=>{if(void 0!==e){let i=a[t];i?(e<i.score&&(i.score=e),i.matches=[...i.matches,s]):(i={item:this.#e[t],refIndex:t,matches:s,score:e},a[t]=i)}}))}return Object.values(a)}return[]}#r(e,t){const{ignoreLocation:s,location:i,threshold:a,distance:l}=this.options,r={matches:[],location:-1};let n;if(s?n=t.length-1:(n=a*l+i,n>t.length-i&&(n=t.length-1)),""===e||e.length>t.length)return r;const o=Array.from(new Set(`${e}`)),c=Array.from(e).reverse(),h={},p=Array(e.length).fill(1);let d=p;o.forEach((e=>{const t=[];c.forEach((s=>{t.push(e===s?0:1)})),h[e]=t}));for(let s=0;s<t.length;s++){let a=e.length-1;const l=t.substring(s,t.length);if(l.length<e.length)break;d=p;for(let t=0;t<l.length;t++){const o=l[t],c=h[o]||p,g=d.slice(1,d.length);g.push(0),d=[];for(let e=0;e<g.length;e++)d.push(g[e]||c[e]);if(1===d[a])break;if(0===a&&0===d[a]){s>=i&&s<=n&&-1===r.location&&(r.location=s),r.matches.push([s,s+(e.length-1)]);break}a-=1}}return r}#n(e,t,s){const i=t/s.length,{ignoreLocation:a,location:l,distance:r}=this.options;if(a||e<=-1)return i;const n=Math.abs(l-e);return r?(i+n/r)/100:n?1:i}#o(e="",t=""){if(!e.length)return t.length;if(!t.length)return e.length;const s=[];for(let i=0;i<=t.length;i++){s[i]=[i];for(let a=1;a<=e.length;a++)s[i][a]=0===i?a:Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+(e[a-1]===t[i-1]?0:1))}return s[t.length][e.length]}#l(e="",t=this.#e,s=1){const i=[],a=[],l=this.options.isCaseSensitive?e.trim():e.trim().toLowerCase();return t.forEach((e=>{if(typeof e!==b.typeOf.function){const t=typeof e===b.typeOf.string?e:JSON.stringify(e);a.push(t)}})),a.forEach(((e,t)=>{const a=this.options.isCaseSensitive?e.trim():e.trim().toLowerCase();if(a.includes(l)){const{location:r,matches:n}=this.#r(l,a),o=this.#o(l,a),c={item:e,refIndex:t,score:this.#n(r,o,l)/(s||.01),...this.options.includeMatches&&{matches:[{indices:n,value:e}]}};i.push(c)}})),i}#i(e){return(e=e.filter((e=>void 0!==e.score))).sort(((e,t)=>e.score-t.score))}search(e=""){if(!this.#e.length||""===e)return[];const t=typeof this.#e[0];return this.options.sortFn(t===b.typeOf.object?this.#a(e):this.#l(e),e)}get list(){return this.#e}set list(e){this.#e=Array.isArray(e)?e:[e]}get options(){return this.#t}set options(e){const t=Object.keys(this.#s),s={};Object.entries(e).forEach((([e,i])=>{t.includes(e)&&typeof this.#s[e]==typeof i&&(s[e]=i)})),this.#t={...this.#s,...s}}}class E{#c;#h;#p;#d;#g;#u;#y;#f;#m;constructor(){this.#c={},this.#d=[],this.#g=[],this.#u={},this.#y=0,this.#_(),this.#f={includeScore:!0,includeMatches:!0,keys:[{name:"alias",weight:.5},{name:"initials",weight:.9},{name:"name",weight:0},{name:"pageId",weight:0}],sortFn:this.#i},this.#m={includeScore:!0,includeMatches:!0,keys:[{name:"alias",weight:.5},{name:"initials",weight:.9},{name:"appId",weight:.5},{name:"name",weight:0},{name:"pageId",weight:0}],sortFn:this.#i},this.#p=new b([],this.#m)}#i(e,t){let s=e.length;const a=window.pe;if(void 0!==a){const l=((e,t)=>{let l=[];const r=function(e,t){let s=a.displayTitleSearch(e,t),i=a.getComponentType(t);if(i)for(let t=0;t<i.childComponentTypes.length;t++)s=r(e,i.childComponentTypes[t]).concat(s);return s},n=r(e,t);for(let e=0;e<n.length;e++){const t=n[e],r={},o=a.getComponentType(t.typeId);r.name=i.escapeHTML(t.getDisplayTitle()),r.category=i.escapeHTML(o.title.singular),r.icon='<span class="a-Spotlight-icon" aria-hidden="true"><span class="a-Icon icon-page-designer"></span></span>',r.pe="pe",r.typeid=t.typeId,r.componentid=t.id,r.propertyid=o.displayPropertyId,r.context="app",l.push({item:r,refIndex:s+=1,score:.5})}return l})(t,"4000"===o.APP_ID&&"9600"===o.APP_PAGE_ID?a.COMP_TYPE.WORKFLOW:a.COMP_TYPE.PAGE);e=[...e,...l]}const l={};let r=[];return e.forEach((e=>{if(void 0!==e.score){const{item:{category:t}}=e;l[t]?l[t].push(e):l[t]=[e]}})),Object.keys(l).forEach((e=>{let t=l[e].sort(((e,t)=>e.score-t.score)),s=t.reduce(((e,t)=>e+t.score),0)/t.length;r.push({avrgScore:s,category:e,results:t}),r=r.sort(((e,t)=>e.avrgScore-t.avrgScore))})),r}#S(e,t=[]){const s=(e,s)=>{if("initials"===s.key){const i=e.item.name.toLowerCase();let a=i.split(" ");if(a.length>1){let e=Array.from(new Set([...s.value.toLowerCase()]));const l=[],r=[];e.forEach(((e,s)=>{t.includes(e)||l.unshift(s)})),l.forEach((t=>{a.splice(t,1),e.splice(t,1)})),e.forEach((e=>{a.forEach((t=>{if(0===t.indexOf(e)){const e=i.indexOf(t);r.push([e,e])}}))})),s.indices=r}}};let i=JSON.stringify(e);return i=JSON.parse(i),i.forEach((e=>{e.results.forEach((e=>{e.matches?.forEach((t=>{Array.isArray(t)?t.forEach((t=>{s(e,t)})):s(e,t)}))}))})),i}validInput(e){return!0}search(e){let t=this.#p.search(e);if(t.length){if(e.length>1){const s=Array.from(new Set([...`${e}`]));t=this.#S(t,s)}return t}return[]}async#_(e){if(e){if(this.#h!==`app_${e}`){let t=this.#c[e]??[];if(!t||!t.length){this.awaitingIndices=!0,this.#y=this.#y+1;try{const{global:s,pages:i}=await c.process("spotlightIndex",{x01:e,x02:"Y"});i.length&&(t=[...s.filter((e=>"app"===e.context)),...i],this.#c[e]=t)}catch(e){l.warn(JSON.parse(e.responseText)),t=[]}finally{this.#y=this.#y-1,0===this.#y&&(this.awaitingIndices=!1)}}this.#p.list=t,this.#p.options=this.#f,this.#h=`app_${e}`}}else if("static"!==this.#h){if(!this.#d.length&&!this.awaitingIndices){this.awaitingIndices=!0,this.#y=this.#y+1;let e=[];try{const t=await c.process("spotlightIndex",{x01:f,x02:"N"});p=t.shortcuts,e=[...t.global,...t.apps],this.#g=t.global.filter((e=>"app"===e.context)),t.apps.forEach((e=>{null!=e.alias&&(this.#u[e.alias.toUpperCase()]=e.appId)})),f&&t.pages&&(e=[...e,...t.pages],this.#c[f]=[...this.#g,...t.pages])}catch(e){l.warn(JSON.parse(e.responseText))}finally{this.#y=this.#y-1,this.#d=e,0===this.#y&&(this.awaitingIndices=!1)}}this.#p.list=this.#d,this.#p.options=this.#m,this.#h="static"}}updateIndices(e){if(e&&e.is){if(!isNaN(e.app))return void this.#_(e.app);{let t=this.#u[e.app];if(t)return void this.#_(t);{const s=new RegExp("^(?<alias>[\\w@#$%^&*<>{}()!?-]+)[-:]").exec(e.searchInput),i=s?.groups.alias?.toUpperCase();if(t=this.#u[i],t)return e.app=t,e.searchTerm=e.searchInput.substring(s.groups.alias.length+1,e.searchInput.length),void this.#_(t)}}}this.#_()}}class I{constructor(e,t){this.metadata=e,this.HTMLElement=t}}class C{#v;#$;#b;#E;#I;#C;#A;#w;#x;#P;#L;#O;#T;#R;#k;static aliasAllowedChars="\\w@#$%^&*<>{}()!?";static advancedSearchRegex=new RegExp(`^(?<app>[${C.aliasAllowedChars}]+-?)[-:]`);static aria={autocomplete:"aria-autocomplete",expanded:"aria-expanded",haspopup:"aria-haspopup",hidden:"aria-hidden",label:"aria-label",labelledby:"aria-labelledby",owns:"aria-owns",selected:"aria-selected",activedescendant:"aria-activedescendant"};static role={none:"none",region:"region",option:"option",listbox:"listbox"};static selector={class:{is_active:"is-active",spotlight:"a-Spotlight",spotlight_body:"a-Spotlight-body",spotlight_category:"a-Spotlight-category",spotlight_desc:"a-Spotlight-desc",spotlight_field:"a-Spotlight-field",spotlight_icon:"a-Spotlight-icon",spotlight_info:"a-Spotlight-info",spotlight_input:"a-Spotlight-input",spotlight_link:"a-Spotlight-link",spotlight_recent:"a-Spotlight-category--recent",spotlight_result_label:"a-Spotlight-label",spotlight_result:"a-Spotlight-result",spotlight_result_page:"a-Spotlight-result--page",spotlight_results:"a-Spotlight-results",spotlight_no_results:"a-Spotlight-noResults",spotlight_results_list:"a-Spotlight-resultsList",spotlight_search:"a-Spotlight-search",spotlight_shortcut:"a-Spotlight-shortcut",spotlight_shortcuts:"a-Spotlight-category--shortcuts",spotlight_category_title:"a-Spotlight-categoryTitle",spotlight_skeleton:"a-Spotlight-skeleton",spotlight_wrap_skeleton:"a-Spotlight-wrap-skeleton",spotlight_icon_skeleton:"a-Spotlight-icon-skeleton",spotlight_info_skeleton:"a-Spotlight-info-skeleton",spotlight_category_container:"a-Spotlight-categoryContainer",spotlight_clear_button:"a-Button a-Button--noUI",spotlight_clear_all:"a-Spotlight-clearAll"},id:{category_title:"category-title--",spotlight_result_list:"sp-result-list",spotlight_header:"header-spotlightSearch"},attr:{spotlight_is_visible:"is-visible"}};static staticMsg={app:u("SL.APP"),page:u("SL.PAGE"),placeHolder:u("SL.PLACEHOLDER"),oneMatchFound:u("SL.MATCH.FOUND"),noMatchFound:u("SL.NO.MATCH.FOUND"),enterKeywords:u("SL.SEARCH.HELP")};static template={body:`<div class="${C.selector.class.spotlight_body}">\n                          \x3c!-- Search --\x3e\n                          <div class="${C.selector.class.spotlight_search}">\n                              <div class="${C.selector.class.spotlight_icon}">\n                                  <span class="a-Icon icon-search" ${C.aria.hidden}="true"></span>\n                              </div>\n                              <div class="${C.selector.class.spotlight_field}">\n                                  <input type="text" role="combobox" ${C.aria.expanded}="false" ${C.aria.autocomplete}="none" ${C.aria.haspopup}="true" ${C.aria.label}="${u("SL.PLACEHOLDER")}" ${C.aria.owns}="${C.selector.id.spotlight_result_list}" autocomplete="off" autocorrect="off" spellcheck="false" class="${C.selector.class.spotlight_input}" placeholder="${C.staticMsg.placeHolder}">\n                              </div>\n                          </div>\n                          \x3c!-- end Search --\x3e\n\n                          <div class="${C.selector.class.spotlight_results}" aria-label="Search Results">\n\n                              <div class="${C.selector.class.spotlight_category} ${C.selector.class.spotlight_recent}"></div>\n\n                              <div class="${C.selector.class.spotlight_category} ${C.selector.class.spotlight_shortcuts}" role="${C.role.region}" aria-labelledby="${C.selector.id.category_title}shortcuts"></div>\n                          </div>\n                          \x3c!-- <div class="${C.selector.class.spotlight_results} results"></div> --\x3e\n                      </div>`,empty_results:`<div class="${C.selector.class.spotlight_no_results}">${u("APEX.SEARCH.NO_RESULTS_FOUND")}</div>`,category_container:(e="")=>{const t=""!==(e=e.toLowerCase().replace(" ","-"))?` ${C.selector.class.spotlight_category}--${e}`:"";return`<div class="${C.selector.class.spotlight_category}${t}"></div>`},category_title:(e="")=>{const t=""!==e?`${C.selector.id.category_title}${e.toLowerCase().replace(" ","-")}`:"";return"category-title--recently-visited"!==t?`<div class="${C.selector.class.spotlight_category_title}" id="${t}">${e}</div>`:`<div class="${C.selector.class.spotlight_category_container}">\n                                  <div class="${C.selector.class.spotlight_category_title}" id="${t}">${e}</div>\n                                  <button type="button" class="${C.selector.class.spotlight_clear_button} ${C.selector.class.spotlight_clear_all}" title=${u("APEX.SEARCH.CLEAR_ALL")}" aria-label="${u("APEX.SEARCH.CLEAR_ALL")}">${u("APEX.SEARCH.CLEAR_ALL")}</button>\n                              </div>`},result:({alias:e,category:t,highlightText:s,icon:i,name:a,nameNnumber:l,path:r="",shortcut:n,url:o,index:c,pe:h,typeid:p,componentid:d,propertyid:y})=>`<li id="sp-result-${c}" ${C.aria.selected}="false" role="${C.role.option}" class="${C.selector.class.spotlight_result} ${C.selector.class.spotlight_result_page}" data-category=${u(t).toLowerCase().replace(/ /g,"_")} ${C.aria.label}="${g("SL.GOTO",a,l,e||"Without alias",n||"Without shortcut")}">\n                              <span class="${C.selector.class.spotlight_link}"${o?` data-url="${o}"`:""} ${h?` data-type="${h}"`:""} ${p?` data-typeid="${p}"`:""} ${d?` data-componentid="${d}"`:""} ${y?` data-propertyid="${y}"`:""}>\n                                  ${i||""}\n                                  <span class="${C.selector.class.spotlight_info}">\n                                  <span class="${C.selector.class.spotlight_result_label}" ${C.aria.hidden}="true">${s||a}</span>\n                                  <span class="${C.selector.class.spotlight_desc}" ${C.aria.hidden}="true">${r.replace("{APP_ID}",f)}</span>\n                                  </span>\n                              </span>\n                          </li> `,skeleton:`<div class="${C.selector.class.spotlight_wrap_skeleton}">\n                              <ul role="${C.role.listbox}" class="${C.selector.class.spotlight_results_list}">\n                                  <li>\n                                      <span class="${C.selector.class.spotlight_link} ${C.selector.class.spotlight_skeleton}">\n                                          <span class="${C.selector.class.spotlight_icon} ${C.selector.class.spotlight_icon_skeleton}"></span>\n                                          <span class="${C.selector.class.spotlight_info} ${C.selector.class.spotlight_info_skeleton}"></span>\n                                      </span>\n                                  </li>\n                                  <li>\n                                      <span class="${C.selector.class.spotlight_link} ${C.selector.class.spotlight_skeleton}">\n                                          <span class="${C.selector.class.spotlight_icon} ${C.selector.class.spotlight_icon_skeleton}"></span>\n                                          <span class="${C.selector.class.spotlight_info} ${C.selector.class.spotlight_info_skeleton}"></span>\n                                      </span>\n                                  </li>\n                                  <li>\n                                      <span class="${C.selector.class.spotlight_link} ${C.selector.class.spotlight_skeleton}">\n                                          <span class="${C.selector.class.spotlight_icon} ${C.selector.class.spotlight_icon_skeleton}"></span>\n                                          <span class="${C.selector.class.spotlight_info} ${C.selector.class.spotlight_info_skeleton}"></span>\n                                      </span>\n                                  </li>\n                              </ul>\n                          </div>`,results_list:`<ul ${C.aria.activedescendant}="" role="${C.role.listbox}" class="${C.selector.class.spotlight_results_list}"></ul>`,shortcut:{ctrl_1:`<li role="option" class="${C.selector.class.spotlight_result} ${C.selector.class.spotlight_result_page}" ${C.aria.label}="" id="sp-result-sc-1" ${C.aria.selected}="true">\n                    <span class="${C.selector.class.spotlight_link}" data-type="${v}" data-url="">\n                        <span class="${C.selector.class.spotlight_icon}" ${C.aria.hidden}="true">\n                            <span class="a-Icon icon-search"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_info}">\n                            <span class="ctrl-label ${C.selector.class.spotlight_result_label}" ${C.aria.hidden}="true"></span>\n                            <span class="${C.selector.class.spotlight_desc}" ${C.aria.hidden}="true"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_shortcut}">Ctrl + 1</span>\n                    </span>\n                </li>`,ctrl_2:`<li role="option" class="${C.selector.class.spotlight_result} ${C.selector.class.spotlight_result_page}" ${C.aria.label}="" id="sp-result-sc-2" ${C.aria.selected}="true">\n                    <span class="${C.selector.class.spotlight_link}" data-type="${S}">\n                        <span class="${C.selector.class.spotlight_icon}" ${C.aria.hidden}="true">\n                            <span class="a-Icon icon-search"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_info}">\n                            <span class="ctrl-label ${C.selector.class.spotlight_result_label}" ${C.aria.hidden}="true"></span>\n                            <span class="${C.selector.class.spotlight_desc}" ${C.aria.hidden}="true"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_shortcut}">Ctrl + 2</span>\n                    </span>\n                </li>`,ctrl_3:`<li role="option" class="${C.selector.class.spotlight_result} ${C.selector.class.spotlight_result_page}" ${C.aria.label}="" id="sp-result-sc-3" ${C.aria.selected}="false">\n                    <span class="${C.selector.class.spotlight_link}" data-type="${_}">\n                        <span class="${C.selector.class.spotlight_icon}" ${C.aria.hidden}="true">\n                            <span class="a-Icon icon-search"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_info}">\n                            <span class="ctrl-label ${C.selector.class.spotlight_result_label}" ${C.aria.hidden}="true"></span>\n                            <span class="${C.selector.class.spotlight_desc}" ${C.aria.hidden}="true"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_shortcut}">Ctrl + 3</span>\n                    </span>\n                </li>`,ctrl_4:`<li role="option" class="${C.selector.class.spotlight_result} ${C.selector.class.spotlight_result_page}" ${C.aria.label}="" id="sp-result-sc-4" ${C.aria.selected}="false">\n                    <span class="${C.selector.class.spotlight_link}" data-type="${m}">\n                        <span class="${C.selector.class.spotlight_icon}" ${C.aria.hidden}="true">\n                            <span class="a-Icon icon-search"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_info}">\n                            <span class="ctrl-label ${C.selector.class.spotlight_result_label}" ${C.aria.hidden}="true"></span>\n                            <span class="${C.selector.class.spotlight_desc}" ${C.aria.hidden}="true"></span>\n                        </span>\n                        <span class="${C.selector.class.spotlight_shortcut}">Ctrl + 4</span>\n                    </span>\n                </li>`}};constructor(e,t){this.#b=(()=>{const e={4e3:()=>{switch(+o.APP_PAGE_ID){case 1500:break;case 4500:t="page";break;default:t="app"}}}[o.APP_ID];return e&&e(),t})(),this.#v={},this.#x=e,this.#C=[],this.#k=[],this.#$=this.#M("body"),this.#L={onScreen:!1,title:this.#M("category_title",{},u("APEX.SEARCH.SC.SHORTCUTS")),ul:this.#V(),container:this.#$.querySelector(`.${C.selector.class.spotlight_category}.${C.selector.class.spotlight_shortcuts}`)},this.#O={};for(let e of this.#L.ul.children)this.#O[e.id]={li:e,span:e.children[0],label:e.querySelector(".ctrl-label")};this.#P=this.#$.querySelector("input"),this.#A=this.#$.querySelector(`.${C.selector.class.spotlight_results}`),this.#R={},this.#E={onScreen:!1,parent:this.#A,span:this.#M("empty_results"),show:function(){!this.onScreen&&this.parent&&(this.parent.insertBefore(this.span,this.parent.firstElementChild),this.onScreen=!0)},hide:function(){this.onScreen&&this.parent&&(this.span.remove(),this.onScreen=!1)}},this.skeleton={onScreen:!1,wrapper:this.#M("skeleton",{}),resultsContainer:this.#A,show(){this.onScreen||(this.resultsContainer.appendChild(this.wrapper),this.onScreen=!0)},hide(){this.onScreen&&(this.wrapper.remove(),this.onScreen=!1)}},this.#T=new IntersectionObserver(this.#H,{threshold:1}),this.#N(this.#P,"input",(e=>{this.#v=this.#q(e.target.value),this.#x(e.target.value,this.#v),this.#D(e.target.value),this.#F(e.target.value),this.#U(d=0)})),document.addEventListener("spotlightDialogClose",(()=>{this.#z()})),this.#N(this.#P,"keyup",i.debounce((e=>{""!==this.#P.value&&(e.ctrlKey&&49===e.which?this.#J(document.querySelectorAll(`[ data-type="${v}" ]`)[0]):e.ctrlKey&&50===e.which?this.#J(document.querySelectorAll(`[ data-type="${S}" ]`)[0]):e.ctrlKey&&51===e.which?this.#J(document.querySelectorAll(`[ data-type="${_}" ]`)[0]):e.ctrlKey&&52===e.which&&this.#J(document.querySelectorAll(`[ data-type="${m}" ]`)[0]))}),50)),this.#N(this.#$,"keydown",i.debounce((e=>{if(38===e.which)e.preventDefault(),this.#j();else if(40===e.which)e.preventDefault(),this.#G();else if(13===e.which){e.preventDefault();const t=document.querySelector(`li.${C.selector.class.spotlight_result}.${C.selector.class.is_active}`),s=t.closest("ul[data-category]");if(s){let e;const i=s.dataset.category;if("recently_visited"===i){const i=Array.from(s.childNodes).indexOf(t);e=this.#C[i]}else"static_shortcuts"!==i&&(e=this.#k[t.dataset.index].metadata.item);this.#J(t.firstElementChild,e)}}}),50)),this.#B()}async#B(){this.#I={onScreen:!1,title:this.#M("category_title",{},u("APEX.SEARCH.CATEGORY.RECENTLY_VISITED")),ul:await this.#Y()},this.#I.container=this.#$.querySelector(`.${C.selector.class.spotlight_category}.${C.selector.class.spotlight_recent}`),this.#C.length&&this.#W(this.#I)}#X(e){e.onScreen||(this.#A.insertBefore(e.container,this.#L.container),e.onScreen=!0)}#K(e){e.onScreen&&(e.container.remove(),e.onScreen=!1)}#Q(){const e=Object.keys(this.#R);for(let t=0;t<e.length;t++){let s=this.#R[e[t]];for(;s.ul.firstChild;)s.ul.removeChild(s.ul.lastChild);this.#K(s)}}#W(e){e&&!e.onScreen&&(e.container.appendChild(e.title),e.container.appendChild(e.ul),e.onScreen=!0)}#Z(e){e.onScreen&&(e.title.remove(),e.ul.remove(),e.onScreen=!1)}#z(){this.#P.value="",this.#F(this.#P.value),this.#x(this.#P.value,!1)}#ee(e,t){let s="",i=0;return t.forEach((t=>{let a=t[0],l=t[1];a>=i&&(s+=e.substring(i,a),s+='<span class="a-Spotlight-highlight">'+e.substring(a,l+1)+"</span>",i=l+1)})),s+=e.substring(i),s}#te(e){return e.forEach((e=>{e.results.forEach((e=>{const{item:t}=e;let s=t.name;e.matches?.forEach((e=>{s=s.replace(/<\/?span.*?>/g,""),e.length>0?e.forEach((e=>{"name"!==e.key&&"initials"!==e.key||(s=this.#ee(s,e.indices))})):"name"!==e.key&&"initials"!==e.key||(s=this.#ee(s,e.indices))})),t.highlightText=s}))})),e}#q(e){const t={is:!1};if(e=e.trim(),C.advancedSearchRegex.test(e)){const s=e.match(C.advancedSearchRegex),i=e.split(s[0])[1];t.is=!0,t.app=s.groups.app.toUpperCase(),t.searchTerm=i,t.searchInput=e}return t}#H(e){e.forEach((e=>{e.target.setAttribute(C.selector.attr.spotlight_is_visible,e.isIntersecting)}))}#G(){const e=document.querySelectorAll(`.${C.selector.class.spotlight_result}`);d<e.length&&(d+=1,this.#U(d)),e.forEach((t=>{d===e.length&&(d=0,this.#U(d)),t.classList.contains(C.selector.class.is_active)&&"false"===t.getAttribute(C.selector.attr.spotlight_is_visible)&&t.scrollIntoView({block:"end",behavior:"smooth"})}))}#j(){const e=document.querySelectorAll(`.${C.selector.class.spotlight_result}`);d>=0&&(d-=1,this.#U(d)),e.forEach((t=>{-1===d&&(d=e.length-1,this.#U(d)),t.classList.contains(C.selector.class.is_active)&&"false"===t.getAttribute(C.selector.attr.spotlight_is_visible)&&t.scrollIntoView({block:"nearest",behavior:"smooth"})}))}#U(e){document.querySelectorAll(`.${C.selector.class.spotlight_result}`).forEach(((t,s)=>{s===e?(t.scrollIntoView({block:"nearest",behavior:"smooth"}),t.classList.add(C.selector.class.is_active),t.setAttribute(C.aria.selected,!0),this.#P.setAttribute(C.aria.activedescendant,t.id)):(t.classList.remove(C.selector.class.is_active),t.setAttribute(C.aria.selected,!1))}))}#F(e){document.querySelector(`#${C.selector.id.spotlight_header}`).innerHTML=`${i.escapeHTML(e||u("SL.PLACEHOLDER"))} <span class="a-Icon icon-search"></span>`}#D(e){const t=Object.keys(this.#O);t.forEach(((s,i)=>{s=t[i];const a=this.#O[s];switch(s){case"sp-result-sc-1":a.li.setAttribute("aria-label",r.formatMessage("SL.SEARCH.WP",e)+", ,  , Ctrl + 1 "),a.label.innerHTML=r.formatMessage("SL.SEARCH.WP",e);break;case"sp-result-sc-2":a.li.setAttribute("aria-label",r.formatMessage("SL.SEARCH.ALLAPPS",e)+", ,  , Ctrl + 2 "),a.label.innerHTML=r.formatMessage("SL.SEARCH.ALLAPPS",e);break;case"sp-result-sc-3":a.li.setAttribute("aria-label",r.formatMessage("SL.SEARCH.APP",e)+", ,  , Ctrl + 3 "),a.label.innerHTML=r.formatMessage("SL.SEARCH.APP",e);break;case"sp-result-sc-4":a.li.setAttribute("aria-label",r.formatMessage("SL.SEARCH.PAGE",e)+", ,  , Ctrl + 4 "),a.label.innerHTML=r.formatMessage("SL.SEARCH.PAGE",e)}}))}#M(e,t={}){if(null!=e){let s=C.template[e];if(s){"function"==typeof s&&(s=s(arguments[2]||""));const e=document.createElement("div");e.innerHTML=s;const i=e.firstChild;return Object.keys(t).forEach((e=>{i.setAttribute(e,t[e])})),i}}}async#Y(){let e=this.#M("results_list");const t=document.createElement("div");return e.length=this.#C.length,this.#C.forEach((s=>{let i=s.path?.replace("{APP_ID}",s.appId||"");i=i?.replace("&#92;","&#8212;"),s.path=i,t.innerHTML=i,i=t.textContent,t.textContent="",e.setAttribute("data-category",u("APEX.SEARCH.CATEGORY.RECENTLY_VISITED").toLowerCase().replace(/ /g,"_")),s.highlightText=s.highlightText?.replace(/<\/?span.*?>/g,"")||s.name,s.recentlyVisited="Y",e.appendChild(this.#se(s))})),e}async#ie(e){let t=JSON.stringify(e);t=JSON.parse(t),delete t.highlightText,delete t.recentlyVisited;const s=JSON.stringify(t);let i=-1,a=[];for(let e=0;e<this.#C.length;e++){let t=JSON.stringify(this.#C[e]);t=JSON.parse(t),delete t.highlightText,delete t.recentlyVisited;s===JSON.stringify(t)?i=e:a.push(this.#C[e])}if(e.appId||(e.appId=f),i>-1)0!==i&&(this.#C=[t,...a]);else if(this.#C.length>=3){const e=this.#C.slice(0,2);this.#C=[t,...e]}else this.#C=[t,...this.#C];try{await c.process("spotlightRecentlyVisited",{x01:o.APP_USER,x02:"SET",x03:JSON.stringify(this.#C)})}catch(e){l.warn(e.responseText)}}#se(e,t){let s="";e.path&&"string"==typeof e.path&&(s=e.path?.replace("{APP_ID}",e.appId)||"",s=s.replace("&#92;","&#8212;"),e.path=s);const i=document.createElement("div");i.innerHTML=C.template.result({...e,nameNnumber:s,index:t});const a=i.firstChild;void 0!==t&&(a.dataset.index=t),this.#N(a,"mouseenter",this.#ae),a.setAttribute(C.aria.selected,!1),this.#P.setAttribute(C.aria.selected,a.getAttribute("data-index"));const l=a.querySelector(`.${C.selector.class.spotlight_link}`);return this.#N(l,"click",(()=>{this.#J(l,e)})),a}async#le(){this.#C=[];try{await c.process("spotlightRecentlyVisited",{x01:o.APP_USER,x02:"SET",x03:JSON.stringify(this.#C)})}catch(e){l.warn(e.responseText)}if(0===this.#C.length){const e=document.querySelector(`.${C.selector.class.spotlight_recent}`);e.parentNode.removeChild(e),this.#P.focus()}}#V(){const e=this.#M("results_list",{"data-category":"static_shortcuts"}),t={app:C.template.shortcut.ctrl_3,page:C.template.shortcut.ctrl_4+C.template.shortcut.ctrl_3};e.innerHTML=`${t[this.#b]||""} ${C.template.shortcut.ctrl_2} ${C.template.shortcut.ctrl_1}`;for(let t of e.children)this.#N(t,"mouseenter",this.#ae),this.#N(t,"click",(()=>{this.#J(t.firstElementChild)}));return e}#re(e,t){if(e){if(e.indexOf("&DEBUG.")>0){let t="::::";e=e.substring(0,e.indexOf("&DEBUG.")+7).concat(t)}e=e.replace("%SESSION%",y).replace("%25SESSION%25",y).replace("&DEBUG.","NO").replace("&APP_SESSION.",y),t&&(t.url=e),s.redirect(e)}}#N(e,t,s){e.addEventListener(t,s)}async#J(t,i){const a=t?.dataset.url,l=t?.dataset.type,r=this.#P.value;switch(l){case $:window.pageDesigner.goToComponent(t.getAttribute("data-typeid"),t.getAttribute("data-componentid"),t.getAttribute("data-propertyid"));break;case m:window.pageDesigner.activateTab("search"),e("#P4500_LOCAL_SEARCH").val(r).trigger("change").trigger("focus"),A.close(h);break;case _:s.popup({url:p[0].url.replace("SEARCH_TERMS",encodeURIComponent(r)).replace("%SESSION%",y),name:"SEARCH_RESULTS",width:1e3,height:800});break;case S:s.popup({url:p[1].url.replace("SEARCH_TERMS",encodeURIComponent(r)).replace("%SESSION%",y),name:"SEARCH_RESULTS",width:1e3,height:800});break;case v:this.#re(p[2].url.replace("SEARCH_TERMS",encodeURIComponent(r)).replace("%SESSION%",y),i);break;default:this.#re(a,i)}}#ae(e){const t=document.querySelectorAll(`.${C.selector.class.spotlight_result}`),s=document.querySelector(`li.${C.selector.class.spotlight_result}.${C.selector.class.is_active}`),i=document.querySelector(`.${C.selector.class.spotlight_input}`);s.classList.remove(C.selector.class.is_active),s.setAttribute(C.aria.selected,!1),e.target.classList.add(C.selector.class.is_active),e.target.setAttribute(C.aria.selected,!0),i.setAttribute(C.aria.activedescendant,e.target.id),t.forEach(((t,s)=>{e.target===t&&(d=s)}))}#ne(e,t){let s=this.#R[t];const i=u(t);s||(s={onScreen:!1,container:this.#M("category_container",{role:C.role.region,[C.aria.labelledby]:`${C.selector.id.category_title}${i.toLowerCase().replace(" ","-")}`},i),title:this.#M("category_title",{},i),ul:this.#M("results_list",{"data-category":i.toLowerCase().replace(" ","_")})},s.container.appendChild(s.title),s.container.appendChild(s.ul),this.#R[t]=s),s.ul.appendChild(e),this.#X(s)}initView(e){e.appendChild(this.#$),e.classList.add(C.selector.class.spotlight),this.#x()}clearView(){this.#E.hide(),this.#Z(this.#I),this.#Z(this.#L),this.#Q()}render(e=[]){this.#w=this.#te(e),this.#k=[],this.#w.forEach((e=>{e.results.forEach((e=>{const t=e.item.context;(this.#v.is||"global"===this.#b&&"global"===t||"app"===this.#b&&("global"===t||"app"===t)||"page"===this.#b&&("global"===t||"app"===t||"page"===t))&&(this.#v.is&&t&&"app"===t?e.item.appId=this.#v.app:e.item.path&&e.item.path.indexOf("{APP_ID}")>-1&&(e.item.appId=f),this.#k.push(new I(e,this.#se(e.item,this.#k.length))))}))})),this.#Q(),this.#k.forEach((e=>{const t=e.metadata.item.category;this.#ne(e.HTMLElement,t)})),this.#L.onScreen&&this.#Z(this.#L);0===this.#A.querySelectorAll(`.${C.selector.class.spotlight_category}:not(.${C.selector.class.spotlight_recent}, .${C.selector.class.spotlight_shortcuts} )`).length?(""!==this.#P.value?this.#E.show():this.#E.hide(),0===this.#I?.ul.length||this.#I?.onScreen||this.#W(this.#I)):(this.#I?.onScreen&&this.#Z(this.#I),this.#E.onScreen&&this.#E.hide()),""===this.#P.value||this.#L.onScreen||this.#W(this.#L);const t=document.querySelectorAll(`.${C.selector.class.spotlight_result}`);t[0]?.classList.add(C.selector.class.is_active),t[0]?.setAttribute(C.aria.selected,!0),this.#P.setAttribute(C.aria.activedescendant,t[0]?.id),t.forEach((e=>{this.#T.observe(e)}))}}const A={init:()=>{h=document.createElement(L.webComponentName)},open:t=>{const i=e(t),a=window.scrollY||window.pageYOffset;i.hasClass("ui-dialog-content")&&i.dialog("isOpen")||i.dialog({width:650,resizable:!1,height:"auto",modal:!0,position:{my:"center top",at:"center top+"+(a+64),of:e("body")},dialogClass:"ui-dialog--apexspotlight",open:function(){i.css("min-height","auto").prev(".ui-dialog-titlebar").remove(),s.beginFreezeScroll(),e(".ui-widget-overlay").on("click",(()=>{A.close(t)})),this.addEventListener("keydown",(e=>{9===e.which&&A.close(t)}))},close:function(){const e=new Event("spotlightDialogClose");document.dispatchEvent(e),s.endFreezeScroll()}})},close:t=>{e(t).dialog("close")}},w={context:{type:n.dataTypes.string,sync:!0,defaultValue:"global"}},x=[];t.ItemComponent._addCommonAttributes(x,w),n._addHyphenCaseAttrNames(w);const P=n._configObservedAttributes(w,x);class L extends t.ItemComponent{#oe={};#ce;#he;#pe;#de;static webComponentName="a-spotlight-search";constructor(){super(),this._configPrivateState(this.#oe),this.#ce="",this.#he=new E,this.#pe=new C(this.search.bind(this),this.#oe.context)}async search(e="",t){let s;this.#he.updateIndices(t),s=t&&t.is?t.searchTerm:e,this.#he.validInput(s)&&(this.#ce=s,this.#he.awaitingIndices?(this.#pe.skeleton.onScreen?""===s&&this.#pe.skeleton.hide():(""!==s||t?.is)&&(t?.is&&this.#pe.clearView(),this.#pe.skeleton.show()),void 0===this.#de&&(this.#de=setInterval((()=>{this.#he.awaitingIndices||(clearInterval(this.#de),this.#de=void 0,this.#pe.skeleton.hide(),this.#pe.render(this.#he.search(this.#ce)))}),50))):this.#pe.render(this.#he.search(this.#ce)))}_render(e){this.rendered||this.#pe.initView(this)}static get observedAttributes(){return P}static get delegatedAttributes(){return x}static get componentMetaData(){return w}}let O;customElements.define(L.webComponentName,L),window.addEventListener("DOMContentLoaded",(()=>{O=document.querySelector("#header-spotlightSearch"),O&&O.removeAttribute("data-action")}),!1),window.addEventListener("load",(()=>{let e=0;const t="spotlight-search",s=setInterval((()=>{a.add?(clearInterval(s),a.add({name:t,label:null,title:null,shortcut:"Ctrl+Quote",action:()=>(h||A.init(),A.open(h),!0)}),O&&O.setAttribute("data-action",t)):e>=5e3?(l.warn("apex.actions.add could not be loaded"),clearInterval(s)):e+=100}),100)}))}(apex.jQuery,apex.item,apex.navigation,apex.util,apex.actions,apex.debug,apex.lang,apex.WebComponent,apex.env,apex.server);