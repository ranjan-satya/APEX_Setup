/*!
 * Copyright (c) 2023, Oracle and/or its affiliates.
 */
!function(e,t,n,r,o,i){"use strict";const a={WORKFLOWS:"workflows",WORKFLOW:"workflow",WF_PARAMS:"workflow_params",WF_PARAM:"workflow_param",WF_VERSION:"workflow_version",WF_ACTIVITIES:"workflow_activities",WF_ACTIVITY:"workflow_activity",WF_ACTIVITY_VARS:"workflow_activity_vars",WF_ACTIVITY_VAR:"workflow_activity_var",WF_TRANSITIONS:"workflow_transitions",WF_TRANSITION:"workflow_transition",WF_BRANCHES:"workflow_branches",WF_BRANCH:"workflow_branch",WF_INCOMING_LINKS:"workflow_incoming_links",WF_INCOMING_LINK:"workflow_incoming_link",WF_OUTGOING_LINKS:"workflow_outgoing_links",WF_OUTGOING_LINK:"workflow_outgoing_link",WF_PARTICIPANTS:"workflow_participants",WF_PARTICIPANT:"workflow_participant",WF_VARS:"workflow_variables",WF_VAR:"workflow_variable",WF_TASK_PARAMS:"workflow_task_params",WF_TASK_PARAM:"workflow_task_param",WF_API_PARAMS:"workflow_api_params",WF_API_PARAM:"workflow_api_param",WF_API_WS_PARAMS:"workflow_api_ws_params",WF_API_WS_PARAM:"workflow_api_ws_param",WF_INVOKE_WF_PARAMS:"workflow_invoke_wf_params",WF_INVOKE_WF_PARAM:"workflow_invoke_wf_param"},s="DEVELOPMENT",_="ACTIVE",p="INACTIVE",T="NATIVE_WORKFLOW_SWITCH",O="NATIVE_WORKFLOW_END",l="NATIVE_INVOKE_API",d=[{typeId:e.COMP_TYPE.BUILD_OPTION,type:"build_option"},{typeId:e.COMP_TYPE.EMAIL_TEMPLATE,type:"email_template"},{typeId:e.COMP_TYPE.WS_REF,type:"web_service"},{typeId:e.COMP_TYPE.TASK_DEFINITION,type:"task_definition"}];function P(e,t=!0){return t?n.getMessage("PD.TREE."+e):o.msg(e)}function I(t){function n(){let n,r=t.designerTree("getNearestComponent",e.COMP_TYPE.WORKFLOW_ACTIVITY,this[0]);if(r&&r.typeId===e.COMP_TYPE.WORKFLOW_ACTIVITY&&[a.WF_API_PARAMS,a.WF_API_WS_PARAMS].includes(this[0].type))return r.getProperty(e.PROP.PAGE_PROCESS_TYPE).getValue()===l&&(n=r.getProperty(e.getPluginProperty(r.typeId,l,1).id).getValue(),"WEB_SOURCE"!==n)}return[{label:P("WF.ACTIVATE",!1),action:function(){let n=t.designerTree("getComponent",this[0]),i=n.getProperty(e.PROP.STATE);o.validateVersionStateChange(n,_,(function(){let o=e.transaction.message({action:e.MESSAGE_ACTION.CHANGE,component:n,property:i}),a=e.transaction.start("",o);i.setValue(_),apex.commandHistory.execute(a),r("div.a-Property",r(`input[data-property-id="${i.id}"]`)).trigger("change"),r(document).trigger("selectionChanged",[t[0].id,t.designerTree("getSelectedComponents")])}))},visible:function(){let n=t.designerTree("getComponent",this[0]);return t.designerTree("isCreatable",this,[a.WF_VERSION])&&n.getProperty(e.PROP.STATE).getValue()===s}},{label:P("WF.DEACTIVATE",!1),action:function(){let n=t.designerTree("getComponent",this[0]),i=n.getProperty(e.PROP.STATE);o.validateVersionStateChange(n,p,(function(){let o=e.transaction.message({action:e.MESSAGE_ACTION.CHANGE,component:n,property:i}),a=e.transaction.start("",o);i.setValue(p),apex.commandHistory.execute(a),r("div.a-Property",r(`input[data-property-id="${i.id}"]`)).trigger("change"),r(document).trigger("selectionChanged",[t[0].id,t.designerTree("getSelectedComponents")])}))},visible:function(){let n=t.designerTree("getComponent",this[0]);return t.designerTree("isCreatable",this,[a.WF_VERSION])&&n.getProperty(e.PROP.STATE).getValue()===_}},{type:"separator",visible:function(){let n=t.designerTree("getComponent",this[0]);return t.designerTree("isCreatable",this,[a.WF_VERSION])&&[_,s].includes(n.getProperty(e.PROP.STATE).getValue())}},{typeId:e.COMP_TYPE.WORKFLOW,visible:function(){return t.designerTree("isCreatable",this,[a.WORKFLOWS])}},{typeId:e.COMP_TYPE.WORKFLOW_VERSION,visible:function(){return t.designerTree("isCreatable",this,[a.WORKFLOW])}},{typeId:e.COMP_TYPE.WORKFLOW_PARAM,visible:function(){return t.designerTree("isCreatable",this,[a.WORKFLOW,a.WF_PARAMS])}},{typeId:e.COMP_TYPE.WORKFLOW_ACTIVITY,visible:function(){return!!t.designerTree("isCreatable",this,[a.WF_VERSION,a.WF_ACTIVITIES])&&c(this[0].type===a.WF_VERSION?this[0]:this[0]._parent)}},{typeId:e.COMP_TYPE.WORKFLOW_VARIABLE,visible:function(){return t.designerTree("isCreatable",this,[a.WF_VERSION,a.WF_VARS])&&c(this[0].type===a.WF_VERSION?this[0]:this[0]._parent)}},{typeId:e.COMP_TYPE.WORKFLOW_PARTICIP,visible:function(){return t.designerTree("isCreatable",this,[a.WF_VERSION,a.WF_PARTICIPANTS])&&!E(this[0].type===a.WF_VERSION?this[0]:this[0]._parent)}},{label:P("WF.CREATE_ACTIVITY_BELOW",!1),action:function(){t.designerTree("createComponent",this[0],e.COMP_TYPE.WORKFLOW_ACTIVITY,"BELOW")},visible:function(){return t.designerTree("isCreatable",this,[a.WF_ACTIVITY])&&c(this[0])}},{label:P("WF.CREATE_ACTIVITY_AFTER",!1),visible:function(){if(t.designerTree("isCreatable",this,[a.WF_ACTIVITY])&&!c(this[0]))return!1;let n=t.designerTree("getComponent",this[0]),r=n?.getProperty?n.getProperty(e.PROP.PAGE_PROCESS_TYPE):void 0;return!!r&&!["NATIVE_WORKFLOW_SWITCH","NATIVE_WORKFLOW_END"].includes(r.getValue())},action:function(){let n,r,o=t.designerTree("getComponent",this[0]),i=e.transaction.message({action:e.MESSAGE_ACTION.CREATE,component:o,count:this.length}),a=e.transaction.start("",i),s=new e.Component({typeId:e.COMP_TYPE.WORKFLOW_ACTIVITY,parentId:o.parentId,previousComponent:o});n=o.getChilds(e.COMP_TYPE.WORKFLOW_TRANS,{filters:[{id:e.PROP.TRANSITION_TYPE,value:"NORMAL"}]}),n.length?(r=n[0].getProperty(e.PROP.TO_WORKFLOW_ACTIVITY).getValue(),n[0].getProperty(e.PROP.TO_WORKFLOW_ACTIVITY).setValue(s.id,!1,!1)):new e.Component({typeId:e.COMP_TYPE.WORKFLOW_TRANS,parentId:o.id,previousComponent:o,values:[{id:e.PROP.FROM_WORKFLOW_ACTIVITY,value:o.id},{id:e.PROP.TO_WORKFLOW_ACTIVITY,value:s.id}]}),r&&new e.Component({typeId:e.COMP_TYPE.WORKFLOW_TRANS,parentId:s.id,previousComponent:s,values:[{id:e.PROP.FROM_WORKFLOW_ACTIVITY,value:s.id},{id:e.PROP.TO_WORKFLOW_ACTIVITY,value:r}]}),apex.commandHistory.execute(a)}},{typeId:e.COMP_TYPE.WORKFLOW_ACT_VAR,visible:function(){return t.designerTree("isCreatable",this,[a.WF_ACTIVITY_VARS,a.WF_ACTIVITY])&&!E(this[0].type===a.WF_ACTIVITY?this[0]:this[0]._parent)}},{label:P("WF.CREATE_CONNECTION",!1),visible:function(){let n=this[0].type===a.WF_ACTIVITY?this[0]:this[0]._parent;if(!n||!t.designerTree("isCreatable",this,[a.WF_OUTGOING_LINKS,a.WF_ACTIVITY])||!c(n))return!1;let r=t.designerTree("getComponent",n),o=r?.getProperty?r.getProperty(e.PROP.PAGE_PROCESS_TYPE):void 0;return o&&o.getValue()!==O},action:function(){let n=this[0].type===a.WF_ACTIVITY?this[0]:this[0]._parent,r=t.designerTree("getComponent",n),o=r?.getProperty?r.getProperty(e.PROP.PAGE_PROCESS_TYPE):void 0;if(o){let n=o.getValue()===T?e.COMP_TYPE.WORKFLOW_BRANCH:e.COMP_TYPE.WORKFLOW_TRANS;t.designerTree("createComponent",this[0],n)}}},{type:"separator",visible:n},{label:P("SYNCHRONIZE_API_PARAMS"),action:function(){let n=t.designerTree("getNearestComponent",e.COMP_TYPE.WORKFLOW_ACTIVITY,this[0]),r=n.getProperty(e.getPluginProperty(n.typeId,l,4).id);r||(r=n.getProperty(e.getPluginProperty(n.typeId,l,5).id));let o=e.transaction.message({action:e.MESSAGE_ACTION.CHANGE,component:n,property:r}),i=e.transaction.start("",o);r.setValue(r.getValue(),!0),apex.commandHistory.execute(i)},visible:n},{type:"separator"},{label:P("DUPLICATE"),action:function(){t.designerTree("duplicateNodes",this)},visible:function(){for(let e=0;e<this.length;e++)if(!t.designerTree("getNodeAdapter").check("canDuplicate",this[e]))return!1;let n=t.designerTree("getComponent",this[0]);return!(n&&n.typeId===e.COMP_TYPE.WORKFLOW_VERSION&&e.getComponents(e.COMP_TYPE.WORKFLOW_VERSION,{parentId:n.parentId,properties:[{id:e.PROP.STATE,value:s}]}).length>1)}},{type:"separator",visible:function(){for(let e=0;e<this.length;e++)if(!t.designerTree("getNodeAdapter").check("canDuplicate",this[e]))return!1;return!0}},{label:P("EXPAND_ALL_BELOW"),action:function(){t.designerTree("expandAll",t.designerTree("getSelection"))},visible:function(){return!!this[0].children?.length}},{label:P("COLLAPSE_ALL_BELOW"),action:function(){t.designerTree("collapseAll",t.designerTree("getSelection"))},visible:function(){return!!this[0].children?.length}},{type:"separator"},{label:P("DELETE"),accelerator:"Del",action:function(){let n,r,T,O=t.designerTree("getSelection");if(this[0].type===a.WORKFLOW){if(n=R(this[0]),r=o.getConnectedWorkflows(n.id),r.length>0)return void i.alert(o.msg("WF.ERROR.CHILD_WORKFLOW"),(()=>{}));if(T=n.getChildrenUntil(e.COMP_TYPE.WORKFLOW_VERSION),T.some((t=>[_,s].includes(t.getProperty(e.PROP.STATE).getValue()))))return void i.confirm(P("WF.ALERT_DELETE_WF_WITH_VERSION",!1),(e=>{e&&t.designerTree("deleteNodes",O)}))}else if(this[0].type===a.WF_VERSION){n=R(this[0]);let a=n.getProperty(e.PROP.STATE).getValue();if(a===p)return void i.confirm(P("WF.ALERT_DELETE_VERSION",!1),(e=>{e&&t.designerTree("deleteNodes",O)}));if(a===s&&(r=o.getConnectedWorkflows(n.parentId),r.length>0)){if(0===n.getSiblings().length)return void i.alert(o.msg("WF.ERROR.AT_LEAST_ONE_VERSION"),(()=>{}))}}else if(this[0].type===a.WF_PARAM){n=R(this[0]);let r=n.getProperty(e.PROP.PARAMETER_REQUIRED)?.getValue(),a=o.getConnectedWorkflows(n.parentId);if("Y"===r&&a?.length>0)return void i.confirm(P("WF.ALERT_DELETE_PARAM",!1),(e=>{e&&t.designerTree("deleteNodes",O)}))}t.designerTree("deleteNodes",O)},visible:function(){for(let n=0;n<this.length;n++){let r=t.designerTree("getComponent",this[0]);if(r.typeId===e.COMP_TYPE.WORKFLOW_VERSION&&r.getProperty(e.PROP.STATE).getValue()===_||r.typeId!==e.COMP_TYPE.WORKFLOW&&!t.designerTree("getNodeAdapter").allowDelete(this[n]))return!1}return!0}}]}function c(e){let t=e&&R(e);return!!t&&A(t,s)}function E(e){let t=R(e);return!!t&&A(t,p)}function A(t,n){let r=t;for(;r&&r.typeId!==e.COMP_TYPE.WORKFLOW_VERSION;)r=r.getParent();return!!r&&r.getProperty(e.PROP.STATE).getValue()===n}function R(t){if(t.data&&Object.keys(t.data).length)return e.getComponents(t.data.typeId,{id:t.data.componentId})[0]}function C(){return{default:{operations:{canAdd:!1,canDuplicate:!1,canDelete:!1,canRename:!1,canDrag:!1,canSearch:!1,canExtCreate:!1,canExtEdit:!1,canExtCopy:!1}},[a.WF_PARAM]:{operations:{canDelete:!0,canDuplicate:!0}},[a.WORKFLOW]:{icon:"icon-gears-alt",operations:{canDelete:function(e){let t=R(e);return!(o.getConnectedWorkflows(t.id).length>0)||(o.showError(o.msg("WF.ERROR.CHILD_WORKFLOW")),!1)},canDuplicate:!0}},[a.WF_VERSION]:{icon:"icon-activity-native-workflow-version",operations:{canDelete:function(t){let n=R(t);if(n.getProperty(e.PROP.STATE)===s){if(o.getConnectedWorkflows(n.parentId).length>0){if(0===n.getSiblings(!1).length)return o.showError(o.msg("WF.ERROR.AT_LEAST_ONE_VERSION")),!1}}return!function(e){let t=R(e);return!!t&&A(t,_)}(t)},canDuplicate:function(e){return!c(e)}},validChildren:[a.WF_VAR,a.WF_ACTIVITY]},[a.WF_VAR]:{operations:{canDelete:c,canDuplicate:c,canAdd:c}},[a.WF_ACTIVITIES]:{operations:{canAdd:!0},validChildren:[a.WF_ACTIVITY]},[a.WF_ACTIVITY]:{operations:{canDelete:function(e){return c(e)},canDuplicate:function(e){return c(e)},canDrag:function(e){return!E(e)},drag:{normal:"move"}},validChildren:[a.WF_INCOMING_LINKS,a.WF_OUTGOING_LINKS,a.WF_ACTIVITY_VAR]},[a.WF_OUTGOING_LINKS]:{operations:{canAdd:!0}},[a.WF_BRANCH]:{operations:{canDelete:function(e){return c(e)},canDrag:function(e){return!E(e)}}},[a.WF_TRANSITION]:{operations:{canDelete:function(e){return c(e)},canDrag:function(t){let n=R(t);return!E(t)&&"ERROR"===n.getProperty(e.PROP.TRANSITION_TYPE).getValue()}}},[a.WF_PARTICIPANT]:{operations:{canDelete:function(e){return c(e)},canDuplicate:function(e){return!E(e)}}},[a.WF_ACTIVITY_VAR]:{operations:{canDelete:!0}},build_options:{operations:{canExtCreate:!0}},build_option:{icon:"icon-tree-build-option",operations:{canExtCreate:!0,canExtEdit:!0}},email_templates:{},email_template:{icon:"icon-tree-email",operations:{canExtEdit:!0}},web_services:{operations:{canExtCreate:!0}},web_service:{icon:"icon-tree-web-service",operations:{canExtCreate:!0}},references:{},referenced_by:{operations:{canRename:!0}}}}function W(){let t=r.apex.designerTree.addHeaderNode(void 0,{title:P("WF.TREE.WORKFLOWS",!1),type:a.WORKFLOWS,showHasComponents:!0,omitIfEmpty:!1});return function(t){let n=r.apex.designerTree.addNode;n(t,{header:!1,setFilter:!1,component:[{type:a.WORKFLOW,typeId:e.COMP_TYPE.WORKFLOW,filter:{},addSubComponents:function(t,r){!function(t,r){n(t,{header:{type:a.WF_PARAMS,isOpen:!0,omitIfEmpty:!0},setFilter:!1,component:{type:a.WF_PARAM,typeId:e.COMP_TYPE.WORKFLOW_PARAM,filter:{parentId:r.id}}})}(t,r),function(t,r){n(t,{header:!1,setFilter:!1,component:{type:a.WF_VERSION,typeId:e.COMP_TYPE.WORKFLOW_VERSION,filter:{parentId:r.id},addSubComponents:function(t,r){!function(t,r){n(t,{header:{type:a.WF_ACTIVITIES,isOpen:!0,omitIfEmpty:!1},setFilter:!1,component:{type:a.WF_ACTIVITY,typeId:e.COMP_TYPE.WORKFLOW_ACTIVITY,filter:{parentId:r.id},addSubComponents:function(t,r){!function(t,r){let o=r.getProperty(e.PROP.PAGE_PROCESS_TYPE).getValue();"NATIVE_CREATE_TASK"===o&&n(t,{header:{type:a.WF_TASK_PARAMS,isOpen:!0,omitIfEmpty:!0},setFilter:!1,component:{type:a.WF_TASK_PARAMS,typeId:e.COMP_TYPE.WF_ACTIVITY_TASK_PARAM,filter:{parentId:r.id}}}),o===l&&(n(t,{header:{type:a.WF_API_PARAMS,isOpen:!1,omitIfEmpty:!0},setFilter:!1,component:{type:a.WF_API_PARAM,typeId:e.COMP_TYPE.WF_ACTIVITY_API_PARAM,filter:{parentId:r.id}}}),n(t,{header:{type:a.WF_API_WS_PARAMS,isOpen:!1,omitIfEmpty:!0},setFilter:!1,component:{type:a.WF_API_WS_PARAM,typeId:e.COMP_TYPE.WF_ACTIVITY_WS_PARAM,filter:{parentId:r.id}}})),"NATIVE_INVOKE_WF"===o&&n(t,{header:{type:a.WF_INVOKE_WF_PARAMS,isOpen:!0,omitIfEmpty:!0},setFilter:!1,component:{type:a.WF_INVOKE_WF_PARAM,typeId:e.COMP_TYPE.WF_ACTIVITY_WF_PARAM,filter:{parentId:r.id}}})}(t,r),function(t,r){n(t,{header:{type:a.WF_ACTIVITY_VARS,isOpen:!0,omitIfEmpty:!0,title:P("WF.VARIABLES",!1)},setFilter:!1,component:{type:a.WF_ACTIVITY_VAR,typeId:e.COMP_TYPE.WORKFLOW_ACT_VAR,filter:{parentId:r.id}}})}(t,r),function(t,r){n(t,{header:{type:a.WF_OUTGOING_LINKS,isOpen:!0,omitIfEmpty:!0,title:P("WF.OUTGOING",!1)},setFilter:!1,component:[{type:a.WF_TRANSITION,typeId:e.COMP_TYPE.WORKFLOW_TRANS,filter:{filterFunction:function(){return this.getProperty(e.PROP.FROM_WORKFLOW_ACTIVITY).getValue()===r.id}}},{type:a.WF_BRANCH,typeId:e.COMP_TYPE.WORKFLOW_BRANCH,filter:{filterFunction:function(){return this.parentId===r.id}}}]})}(t,r),function(t,r){n(t,{header:{type:a.WF_INCOMING_LINKS,isOpen:!0,omitIfEmpty:!0,title:P("WF.INCOMING",!1)},setFilter:!1,component:[{type:a.WF_TRANSITION,typeId:e.COMP_TYPE.WORKFLOW_TRANS,filter:{filterFunction:function(){return this.getProperty(e.PROP.TO_WORKFLOW_ACTIVITY).getValue()===r.id}}},{type:a.WF_BRANCH,typeId:e.COMP_TYPE.WORKFLOW_BRANCH,filter:{filterFunction:function(){return this.getProperty(e.PROP.TO_WORKFLOW_ACTIVITY).getValue()===r.id}}}]})}(t,r)}}})}(t,r),function(t,r){n(t,{header:{type:a.WF_PARTICIPANTS,isOpen:!0,omitIfEmpty:!1},setFilter:!1,component:{type:a.WF_PARTICIPANT,typeId:e.COMP_TYPE.WORKFLOW_PARTICIP,filter:{parentId:r.id}}})}(t,r),function(t,r){n(t,{header:{type:a.WF_VARS,isOpen:!0,omitIfEmpty:!1},setFilter:!1,component:{type:a.WF_VAR,typeId:e.COMP_TYPE.WORKFLOW_VARIABLE,filter:{parentId:r.id}}})}(t,r)}}})}(t,r)}}]})}(t),r.apex.designerTree.postProcessNodes(t),t}function g(p,T,O){let l=`${p[0].id}Menu`;p.designerTree({getNodeAdapter:o.getTreeNodeAdapter(T,!1,C()),showRoot:O,collapsibleRoot:!1,expandRoot:!1,contextMenuEntries:I(p),contextMenuId:l,multiple:!0,doubleClick:"toggle",clickToRename:!1,keyboardRename:!1,keyboardAdd:!1,keyboardDelete:!0,tooltip:{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){let n=R(t);if(n)return o.tooltipContentForComponent(n)}},dragAndDrop:!0,dragMultiple:!0,dragReorder:!0,delay:10,distance:5,dragAppendTo:document.body,dragCursor:"move",dragOpacity:.6,dragCursorAt:{left:10,bottom:10},dragAnimate:!1,dragContainment:"document",createComponent:function(a,s){let p,T,O,l,d,I,c,E=this,A=this.getComponent(a),R=[];switch(s){case e.COMP_TYPE.WORKFLOW_PARAM:case e.COMP_TYPE.WORKFLOW_VERSION:T=E.getNearestComponent(e.COMP_TYPE.WORKFLOW,a),p=T.id;break;case e.COMP_TYPE.WORKFLOW_ACTIVITY:case e.COMP_TYPE.WORKFLOW_VARIABLE:case e.COMP_TYPE.WORKFLOW_PARTICIP:T=E.getNearestComponent(e.COMP_TYPE.WORKFLOW_VERSION,a),p=T.id;break;case e.COMP_TYPE.WORKFLOW_TRANS:case e.COMP_TYPE.WORKFLOW_BRANCH:case e.COMP_TYPE.WORKFLOW_ACT_VAR:T=E.getNearestComponent(e.COMP_TYPE.WORKFLOW_ACTIVITY,a),p=T.id,s===e.COMP_TYPE.WORKFLOW_BRANCH&&function(e){let t;Object.prototype.hasOwnProperty.call(e,"value")?R.push({id:e.id,value:e.value}):e.typeId?(t=E.getNearestComponent(e.typeId,a),R.push({id:e.id,value:t?t.id:""})):e.id&&R.push({id:e.id,value:E.getNearestValue(e.id,a)+""})}({id:e.PROP.SWITCH_TYPE,value:T.getProperty(e.getPluginProperty(e.COMP_TYPE.PAGE_PROCESS,"NATIVE_WORKFLOW_SWITCH",1).id).getValue()})}if(A?(O=a._parent.id,I=A):I="last",c=e.transaction.message({action:e.MESSAGE_ACTION.CREATE,component:s}),l=e.transaction.start("",c),d=new e.Component({previousComponent:I,typeId:s,parentId:p,values:R}),s===e.COMP_TYPE.WORKFLOW_VERSION){let p=e.getComponents(s,{parentId:E.getComponent(a).id}),T=p.filter((t=>t.id!==d.id&&"DEVELOPMENT"===t.getProperty(e.PROP.STATE).getValue()));if(T.length){let t=T.reduce(((t,n)=>(t.push(n.getProperty(e.PROP.WORKFLOW_VERSION).getValue()),t)),[]);i.alert(function(e){let t=[P(e)].concat(Array.prototype.slice.call(arguments,1));return n.formatNoEscape.apply(this,t)}("WF.ALERT_DUP_DEV_VERSION",t.join(", ")),(()=>{l.cancel()}))}else p.some((t=>t.getProperty(e.PROP.STATE).getValue()===_))?i.showDialog(o.msg("WF.ALERT_NEW_VERSION"),{confirm:!0,modern:!0,dialogClass:"ui-dialog--notification ",extraButtons:[{text:o.msg("TREE.DUPLICATE"),click:function(){let t,n,o;l.cancel(),t=E.getComponent(a),n=t.getChilds(e.COMP_TYPE.WORKFLOW_VERSION,{properties:[{id:e.PROP.STATE,value:_}]})[0],o=E.getComponentNode(n,a.id),E.duplicateNodes([o],s),r(this).data().uiDialog.close()}}],callback:e=>{if(e)apex.commandHistory.execute(l),E.setSelectedComponents([d],O,!0);else try{l.cancel()}catch(e){t.info("There's no pending transaction")}}}):(apex.commandHistory.execute(l),E.setSelectedComponents([d],O,!0))}else apex.commandHistory.execute(l),E.setSelectedComponents([d],O,!0)}}),r(`#${l}`).on("menubeforeopen",(function(){0===p.designerTree("getSelection").length&&p.designerTree("setSelection",r("[aria-level='1']",p).first().parent())})),p.on("refresh",(function(e,n){let r=p.designerTree("getExpandedState");n&&(r[n]=!0),t.trace("%s: refresh tree",p[0].id),p.designerTree("option","getNodeAdapter",o.getTreeNodeAdapter(T,r,C()))})),function(n){let i,p,T=n[0].id;"PDSharedCompTree"===T?(p=[],function e(t){let n;for(let r=0;r<t.length;r++){if(Object.prototype.hasOwnProperty.call(t[r],"typeId")){n=o.getRefByCompProps(t[r].typeId);for(let e=0;e<n.length;e++)p.push({typeId:n[e].typeId}),i.push(n[e].propertyId)}t[r].children&&e(t[r].children)}}(d)):p=[{typeId:e.COMP_TYPE.WORKFLOW},{typeId:e.COMP_TYPE.WORKFLOW_VERSION},{typeId:e.COMP_TYPE.WORKFLOW_ACTIVITY},{typeId:a.WF_PARAMS},{typeId:e.COMP_TYPE.WORKFLOW_PARAM},{typeId:e.COMP_TYPE.WORKFLOW_PARTICIP},{typeId:e.COMP_TYPE.WORKFLOW_VARIABLE},{typeId:e.COMP_TYPE.WORKFLOW_ACT_VAR},{typeId:e.COMP_TYPE.WORKFLOW_BRANCH},{typeId:e.COMP_TYPE.WORKFLOW_TRANS},{typeId:e.COMP_TYPE.WF_ACTIVITY_TASK_PARAM},{typeId:e.COMP_TYPE.WF_ACTIVITY_API_PARAM},{typeId:e.COMP_TYPE.WF_ACTIVITY_WS_PARAM},{typeId:e.COMP_TYPE.WF_ACTIVITY_WF_PARAM}],"PDsharedCompTree"===T?e.observer(T,{components:p,events:[e.EVENT.CHANGE,e.EVENT.ADD_PROP,e.EVENT.REMOVE_PROP],properties:i},(function(e){t.trace("%s: CHANGE/ADD_PROP/REMOVE_PROP component notification received for shared component reference properties",T,e),n.trigger("refresh")}),!0):(e.observer(T,{components:p,events:[e.EVENT.CHANGE],properties:[e.PROP.DISPLAY_SEQUENCE,e.PROP.EXECUTION_SEQUENCE]},(function(){n.trigger("refresh")})),e.observer(T,{components:p,events:[e.EVENT.CHANGE]},(function(e){e.component.hasChanged()?n.designerTree("addComponentClass",e.component,o.CSS.IS_CHANGED,n):n.designerTree("removeComponentClass",e.component,o.CSS.IS_CHANGED,n)})),e.observer(T,{components:p,events:[e.EVENT.DISPLAY_TITLE]},(function(r){t.trace("%s: DISPLAY_TITLE component notification received",T,r);let i=r.component;n.designerTree("updateComponentNode",i,n,(function(){if(this.label=i.getDisplayTitle(),i.typeId===e.COMP_TYPE.WORKFLOW_VERSION){let t=i.getProperty(e.PROP.STATE).getValue();t===_?this.label+=` [${o.msg("WF.ACTIVE")}]`:t===s&&(this.label+=` [${o.msg("WF.DEV")}]`)}}))})),e.observer(T,{components:p,events:[e.EVENT.CREATE,e.EVENT.DELETE]},(function(e){t.trace("%s: CREATE/DELETE component notification received",T,e),n.trigger("refresh")}),!0),e.observer(T,{components:p,events:[e.EVENT.CHANGE,e.EVENT.ADD_PROP,e.EVENT.REMOVE_PROP],properties:[e.PROP.STATE,e.PROP.TO_WORKFLOW_ACTIVITY,e.PROP.FROM_WORKFLOW_ACTIVITY,e.PROP.ITEM_LABEL]},(function(e){t.trace("%s: CHANGE/ADD_PROP/REMOVE_PROP component notification received for shared component reference properties",T,e),n.trigger("refresh")}),!0),e.observer(T,{components:p,events:[e.EVENT.ERRORS,e.EVENT.NO_ERRORS,e.EVENT.VALIDATE_COMPONENT]},(function(e){e.component.hasErrors()?n.designerTree("addComponentClass",e.component,o.CSS.IS_ERROR,n):n.designerTree("removeComponentClass",e.component,o.CSS.IS_ERROR,n)})),e.observer(T,{components:p,events:[e.EVENT.WARNINGS,e.EVENT.NO_WARNINGS]},(function(e){e.component.hasWarnings()?n.designerTree("addComponentClass",e.component,o.CSS.IS_WARNING,n):n.designerTree("removeComponentClass",e.component,o.CSS.IS_WARNING,n)})),o.observerIsConditional(T,p,(function(e){n.designerTree("removeComponentClass",e.component,o.CSS.IS_CONDITIONAL,n),n.designerTree("removeComponentClass",e.component,o.CSS.IS_NEVER,n),o.isInactive(e.component)?n.designerTree("addComponentClass",e.component,o.CSS.IS_NEVER,n):o.isConditional(e.component)&&n.designerTree("addComponentClass",e.component,o.CSS.IS_CONDITIONAL,n)}))),r(document).on("selectionChanged."+T,(function(e,r,o){r!==T&&(t.trace("%s: selectionChanged event received from %s",T,r,o),(0===o.length||p.some((e=>e.typeId===o[0].typeId)))&&n.designerTree("setSelectedComponents",o,null,!1,!0))}))}(p)}o.WF_TREE_NODE_TYPE=a,r(document).on("modelReady",(function(){let e=r("#trees"),n=r("#workflowTree"),i=r("#PDsharedCompTree");e.on("tabsactivate",(function(e,n){let o,i=n.newPanel.find(".a-TreeView");i.length>0&&(o=i.designerTree("getSelectedComponents"),o.length>0&&(t.trace("%s: trigger event selectionChanged",i.id,o),r(document).trigger("selectionChanged",[i.id,o])))})),g(n,W,!0),g(i,(function(){return o.getSharedData(d)}),!1)}))}(window.pe,apex.debug,apex.lang,apex.jQuery,window.pageDesigner,apex.message);