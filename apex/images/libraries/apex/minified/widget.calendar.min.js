/*!
 Copyright (c) 2003, 2021, Oracle and/or its affiliates. All rights reserved.
*/
apex.widget.calendar={ajax_calendar:function(a,e,t,r,d){var n=$v("p_cal_type_field_id"),i=$v("p_cal_date_field_id"),p=$v("p_cal_end_date_field_id"),_=$v("p_calendar_id"),c=apex.util.escapeCSS("calendar"+_),l=$v("p_cal_enable_drag_add"),x=l.charAt(0),o=l.charAt(1),g=$v("p_cal_highlight_data");"C"!=a?$s(i,$v("p_calendar_date")):(""==$v(i)&&$s(i,$v("p_calendar_date")),""==$v(p)&&$s(p,$v("p_calendar_end_date"))),"S"==a?a=$v("p_calendar_type"):$s(n,a);var u=t&&""!==t?t:$v(i);if("C"==a)var v=r&&""!==r?r:$v(p);var s=apex.jQuery.extend({dataType:"html",refreshObject:"#"+c,success:function(e){apex.jQuery("#"+c,apex.gPageContext$).html(e),$s(i,$v("p_calendar_date")),"C"==a&&$s(p,$v("p_calendar_end_date")),"Y"==x&&apex.widget.calendar.initDragDrop(),"Y"==o&&apex.widget.calendar.initAjaxDataAdd(),apex.widget.calendar.initAjaxDataModify(),"Y"==g&&loadCalendarData(),"Y"==$v("p_cal_is_mobile")&&apex.jQuery("#"+c,apex.gPageContext$).find('[data-role="listview"]').listview(),document.body.style.cursor=""}},d);apex.server.widget("calendar",{p_widget_action:e,p_widget_mod:a,x01:_,x02:u,x05:v},s)},initAjaxDataModify:function(){apex.jQuery("div.apex_cal_data_grid_src",apex.gPageContext$).on("click",(function(a){})),apex.jQuery("div.apex_cal_data_grid_src",apex.gPageContext$).on("mouseenter",(function(a){this.style.cursor="pointer"}))},ajaxAddData:function(a){var e=apex.jQuery(a.target).find("input.apex_cal_add_url").val();if(null!=e&&""!=e||(e=apex.jQuery(a.target).parent().find("input.apex_cal_add_url").val()),null!=e&&""!=e){var t=apex.jQuery("#p_cal_url_new_window",apex.gPageContext$).val();""!=e&&("P"==t?apex.navigation.popup({url:e,name:"popupwindow",width:800,height:600}):window.location.href=e)}},initAjaxDataAdd:function(){var a,e=apex.jQuery("#p_cal_add_url",apex.gPageContext$).val(),t=apex.jQuery("#p_cal_url_new_window",apex.gPageContext$).val();-1!=e.indexOf("#DATE_VALUE#")&&apex.jQuery(".calDragDrop",apex.gPageContext$).parent().on("click",(function(r){if("A"!=r.target.nodeName&&"apex_cal_data_grid_src"!=r.target.id){var d=apex.jQuery(this).find("input.apex_cal_grid_target").val();e=e.replace("#DATE_VALUE#",d),a=apex.jQuery(this).find("input.apex_cal_add_url").val(),"P"==t?apex.navigation.popup({url:a,name:"popupwindow",width:800,height:600}):window.location.href=a}})),apex.jQuery(".calDragDrop",apex.gPageContext$).parent().on("mouseenter",(function(a){this.style.cursor="pointer"}))},initAjaxDataShow:function(){apex.jQuery(".calDragDrop",apex.gPageContext$).parent().on("click",(function(a){var e=apex.jQuery(this).find("input.apex_cal_grid_target").val();""!=e&&apex.widget.calendar.show(apex.jQuery(this),e)}))},initDragDrop:function(){var a=apex.jQuery("#calendar_data_drag",apex.gPageContext$);apex.jQuery("div.apex_cal_data_grid_src",a).draggable({revert:"invalid",helper:function(){return apex.jQuery(this).clone().width(this.clientWidth)},cursor:"move",dragstart:function(a,e){apex.jQuery(this).height(180),apex.jQuery(this).width(181)}}),apex.jQuery("div.calDragDrop",a).parent().droppable({accept:"#calendar_data_drag div.apex_cal_data_grid_src",activeClass:"custom-state-active",drop:function(a,e){apex.widget.calendar.move(this,a,e.draggable)}})},move:function(a,e,t,r){var d=$v("p_calendar_id"),n=apex.util.escapeCSS("calendar"+d),i=$v("p_cal_date_field_id"),p=$v("p_cal_end_date_field_id"),_=apex.jQuery(a),c=t.find("input.apex_cal_date_source").val(),l=_.find("input.apex_cal_grid_target").val();$s(i,$v("p_calendar_date"));var x=$v("p_calendar_id"),o="calendar"+x,g=$v("p_cal_enable_drag_add"),u=g.charAt(0),v=g.charAt(1),s=$v("p_cal_highlight_data"),$=$v("p_cal_drag_process");$&&apex.server.process($,{x01:l,x02:c},{dataType:"",loadingIndicator:"#"+n,loadingIndicatorPosition:"centered",success:function(){var a=$v(i);if("C"==$v("p_calendar_type"))var e=$v(p);var t=apex.jQuery.extend({dataType:"html",refreshObject:"#"+o,success:function(a){apex.jQuery("#"+o,apex.gPageContext$).html(a),$s(i,$v("p_calendar_date")),"C"==$v("p_calendar_type")&&$s(p,$v("p_calendar_end_date")),"Y"==u&&apex.widget.calendar.initDragDrop(),"Y"==v&&apex.widget.calendar.initAjaxDataAdd(),apex.widget.calendar.initAjaxDataModify(),"Y"==s&&loadCalendarData(),document.body.style.cursor=""}},r);apex.server.widget("calendar",{p_widget_action:"same",p_widget_mod:$v("p_calendar_type"),x01:x,x02:a,x03:$v("apex_cal_table_name"),x05:e,x06:$v("apex_cal_primary_key"),x07:c,x08:$v("p_date_column_name"),x09:l},t)}})},getDayData:function(a,e,t){var r=apex.jQuery.extend({dataType:"html",refreshObject:"#"+a},t);apex.server.widget("calendar",{p_widget_action:"DAY_DATA",x01:a,x02:e},r)}},ajax_calendar=apex.widget.calendar.ajax_calendar;