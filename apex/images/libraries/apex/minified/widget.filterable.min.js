!function(e,t){"use strict";var i="u-hidden",s=e.getAttribute,r=function(e,i){return-1===(""+(s(this,"filtertext")||t(this).text())).toLowerCase().indexOf(i)};t.widget("apex.filterable",{options:{filterReveal:!1,filterCallback:r,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr"},_create:function(){var e=this.options;t.extend(this,{_search:null,_timer:0}),this._setInput(e.input),e.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_getCreateOptions:e._getCreateOptions,_onKeyUp:function(){var e,t,i=this._search;if(i){if(e=i.val().toLowerCase(),(t=s(i[0],"lastval")+"")&&t===e)return;this._timer&&(window.clearTimeout(this._timer),this._timer=0),this._timer=this._delay((function(){if(!1===this._trigger("beforefilter",null,{input:i}))return!1;i[0].setAttribute("data-lastval",e),this._filterItems(e),this._timer=0}),250)}},_getFilterableItems:function(){var e=this.element,i=this.options.children,s=i?"function"==typeof i?i():i.nodeName?t(i):i.jquery?i:this.element.find(i):{length:0};return 0===s.length&&(s=e.children()),s},_filterItems:function(e){var s,n,l,o=[],h=[],a=this.options,u=this._getFilterableItems();if(null!=e)for(n=a.filterCallback||r,l=u.length,s=0;s<l;s++)(n.call(u[s],s,e)?h:o).push(u[s]);0===h.length?u[a.filterReveal&&0===e.length?"addClass":"removeClass"](i):(t(h).addClass(i),t(o).removeClass(i)),this._refreshChildWidget(),this._trigger("filter",null,{items:u})},_refreshChildWidget:function(){var e,i,s=["listview"];for(i=s.length-1;i>-1;i--)e=s[i],t.apex[e]&&(e=this.element.data("apex-"+e))&&"function"==typeof e.refresh&&e.refresh()},_setInput:function(e){var i=this._search;this._timer&&(window.clearTimeout(this._timer),this._timer=0),i&&(this._off(i,"keyup change input"),i=null),e&&(i=e.jquery?e:e.nodeName?t(e):this.document.find(e),this._on(i,{keydown:"_onKeyDown",keypress:"_onKeyPress",keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=i},_onKeyDown:function(e){e.keyCode===t.ui.keyCode.ENTER&&(e.preventDefault(),this._preventKeyPress=!0)},_onKeyPress:function(e){this._preventKeyPress&&(e.preventDefault(),this._preventKeyPress=!1)},_setOptions:function(e){var t=!(void 0===e.filterReveal&&void 0===e.filterCallback&&void 0===e.children);this._super(e),void 0!==e.input&&(this._setInput(e.input),t=!0),t&&this.refresh()},_destroy:function(){var e=this.options,t=this._getFilterableItems();e.enhanced?t.toggleClass(i,e.filterReveal):t.removeClass(i)},refresh:function(){this._timer&&(window.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}})}(apex.widget,apex.jQuery);