/*!
 Copyright (c) 2018, 2022 Oracle and/or its affiliates. All rights reserved.
*/
!function(t,a,e,n){"use strict";var i=n.ui.keyCode,r="STARS",l="VALUE",s=" fa ",o="a-StarRating",u="a-StarRating-star",c="a-StarRating-stars",p="a-StarRating-stars-fg",d="a-StarRating-value",f="a-StarRating-clear",v="is-focused";t.starRating=function(m,g){var h,S=i.RIGHT,k=i.LEFT,y="#"+a.escapeCSS(m)+"_INPUT",C=n(y),b=a.escapeCSS(m)+"_CLEAR_BTN",w=g.numStars,T=16,A=C.val(),R=C.val(),E=!0,x=r,V=n.extend({numStars:5,iconClass:"fa-star",increment:1,labelText:"#VALUE#",isRequired:!1,showClearButton:!0,showValue:r,readOnlyDisplay:r,readOnly:!1,iconTooltip:""},g);function L(t,a){return"0"===t||0===t||""===t||null===t||!1===t?t=V.isRequired||V.readOnly?"":0:(t=parseFloat(t),isNaN(t)&&(t=0),t<0?t=0:a&&t===A&&t<=V.numStars?t=L(0,!0):t>V.numStars&&(t=V.numStars)),t}function O(){return!C.prop("disabled")&&!V.readOnly}function N(t){let e,n="color:",i=V.activeColor,o=V.inactiveColor,f=a.htmlBuilder();if(i&&(i=n+i),o&&(o=n+o),f.markup(" <div ").attr("class",c).markup("> ").markup("<div ").attr("class","a-StarRating-starsInner").markup(">").markup("<div ").attr("class","a-StarRating-stars-bg").markup(">"),x!==l)for(let t=0;t<w;t++)f.markup("<span ").attr("class",u+s+V.iconClass).optionalAttr("style",o).markup("></span>");if(x!==r&&(void 0===t&&(t=0),f.markup("<div ").attr("class",d).markup(">").content(t).markup("</div>")),e=isNaN(t*T)?0:t*T,f.markup("</div>").markup("<div ").attr("class",p).attr("style","width:"+e+"px;").markup(">"),x!==l)for(let t=0;t<w;t++)f.markup("<span ").attr("class",u+s+V.iconClass).optionalAttr("style",i).markup("></span>");return f.markup("</div></div></div>"),f.toString()}function U(){let t=n("<span style='display: none' class='"+u+s+V.iconClass+"'></span>");h.append(t),T=t.width(),t.remove()}function _(){let t=C.val(),a=V.labelText;A=parseInt(t,10),E=!0,""===t&&(t=0),h.attr("title",V.labelText.replace(/#VALUE#/,t)),C.closest("."+o).find("."+p).css("width",t*T+"px"),C.closest("."+o).find("."+d).html(t),C.attr({"aria-valuenow":""+t,"aria-valuetext":V.labelText.replace(/#VALUE#/,""+t),value:C.val()}),C.closest("."+o).find("."+d).text(t),V.iconTooltip.includes("#VALUE#")&&(a=V.iconTooltip),C.parent().tooltip({show:apex.tooltipManager.defaultShowOption(),position:{my:"left top+15",at:"left center",collision:"flipfit"},content:a.replace(/#VALUE#/,t),tooltipClass:"ui-widget-content ui-corner-all ui-widget ui-tooltip"})}"SINGLE_STAR_AND_VALUE"===(x=V.readOnly?V.readOnlyDisplay:V.showValue)?w=1:!0===x?x="STARS_AND_VALUE":!1===x&&(x=r),h=C.addClass("u-vh is-focusable").wrap("<div class='"+o+"'></div>").parent(),U(),V.showClearButton&&!V.readOnly&&h.append(function(){let t,e=a.htmlBuilder();return e.markup("<div ").attr("class",f).optionalAttr("title",V.clearTooltip).markup(">").markup("<span ").attr("aria-hidden","true").attr("id",b).attr("class","a-Icon icon-starrating-clear").markup("></span>").markup("</div>"),t=n(e.toString()),t}()),x!==l?h.append(N()):h.append(function(){let t,e=a.htmlBuilder(),i=""===C.val()?0:"";return e.markup("<div ").attr("class",d).markup(">").content(i).markup("</div>"),t=n(e.toString()),t}()),C.attr({role:"spinbutton","aria-valuenow":"0","aria-valuemax":""+V.numStars}),""!==C.val()||V.isRequired||(C.attr({value:0}),R=C.val(),E=!1),"rtl"===h.css("direction")&&(S=i.LEFT,k=i.RIGHT),t.util.onVisibilityChange(C[0],(t=>{t&&U()})),h.on("focusin",(function(){C.closest("."+o).find("."+c).addClass(v)})).on("focusout",(function(){C.closest("."+o).find("."+c).removeClass(v)})).on("keydown",(function(t){let a=null,e=t.which;if(O()){switch(e){case i.HOME:a=0;break;case i.END:a=V.numStars;break;case i.DOWN:case k:a=L(Math.round(C.val())-V.increment,!0);break;case i.UP:case S:a=L(Math.round(C.val())+V.increment,!0);break;case i.DELETE:a=""}null!==a&&(C.val(a).trigger("change"),_())}})).on("click",(function(t){let a,e,i;if(i=n(t.target),e=i.closest("."+u),O()){if(a=e.parent().children().index(e)+1,0===a&&i.attr("id")!==b)return;C.val(L(a,!0)).trigger("change"),_(),C.trigger("focus")}E&&(n(this).tooltip("disable"),n(this).tooltip("enable").tooltip("open"))})).hover((function(){E&&n(this).tooltip("enable").tooltip("open")})).mouseleave((function(){E&&n(this).tooltip("disable")})),_(),e.create(m,{setValue:function(t){C.val(L(t,!1)),_()},getValue:function(){return""!==C.val()?C.val():"0"},displayValueFor:function(t){return N(L(t,!1))},isChanged:function(){return R!==C.val()},disable:function(){V.readOnly=!0,n(y).attr("disabled",!0),n("#"+a.escapeCSS(m)+" ."+f).hide()},enable:function(){V.showClearButton&&V.readOnly&&n("#"+a.escapeCSS(m)+" ."+f).show(),n(y).removeAttr("disabled"),V.readOnly=!1},reinit:function(t){C.val(L(t,!1)),_()},setFocusTo:function(){return n(y).trigger("focus"),C.closest("."+o).find("."+c).addClass(v),n(y)}})}}(apex.widget,apex.util,apex.item,apex.jQuery);