/*!
 Copyright (c) 2015, 2023, Oracle and/or its affiliates.
 */
!function(t,e,o,n){"use strict";const i="a-Toolbar",a=i+"--small",r=i+"--simple",l=i+"-group",s=i+"-groupContainer",u=s+"--start",c=s+"--center",d=s+"--end",p=l+"--together",h=i+"-item",f=i+"-input",b=i+"-inputText",m=i+"-static",g=i+"-button",C=g+"-item",_=i+"-radioGroup",y=i+"-toggleButton",k=i+"-menu",v=i+"-selectList",x="a-Button",A=x+"--hot",L="a-Button--withIcon",T="a-Button--noLabel",E="a-Icon",P=E+" icon-menu-drop-down",I="is-active",O="."+f,S="data-action",B="class",z="disabled",w="aria-label",G="aria-hidden",D="aria-controls",N="start",R="center",F="end",K=t.ui.keyCode,U=e.hasOwnProperty;let H=1;function q(t,e){t.markup("<span aria-hidden='true' ").attr(B,E+" "+e).markup("></span>")}function j(t,e,o,n,i){let a;e&&o&&q(t,e),i&&(a=n?"u-VisuallyHidden":"a-Button-label",t.markup(`<span class="${a}">`).content(i).markup("</span>")),e&&!o&&q(t,e)}function M(t,e,o,n){n&&e?(o||(o=e),t.attr("title",o).attr(w,e)):o&&t.attr("title",o)}t.widget("apex.toolbar",{widgetEventPrefix:"toolbar",options:{label:"",toolbarFor:null,idPrefix:null,actionsContext:null,small:!1,simple:!1,toolbarClass:"",cursorKeyNavigation:!1,data:[]},_create:function(){const o=this.element,s=this,u=this.options;let c;c=e.debounce((function(e,n){"update"!==n&&"updateChoices"!==n||(s.enterActions[e.name]&&o.find('[data-enter-action="'+e.name+'"]').prop(z,!!e.disabled),o.is(":visible")&&o.find("."+l).each((function(){let e,o=t(this);e=o.children().filter((function(){return!this.style||"none"!==this.style.display})).length>0,o.toggle(e)})))}),10),this.menus={},this.enterActions={},o.addClass(i).attr("role","toolbar").attr(w,u.label?u.label:n.formatMessage("APEX.TB.TOOLBAR")),u.toolbarFor&&o.attr(D,u.toolbarFor),u.small&&o.addClass(a),u.simple&&o.addClass(r),u.toolbarClass&&o.addClass(u.toolbarClass),apex.actions&&(this.actionsContext=u.actionsContext||apex.actions,this.actionsContext.observe(c),this.actionObserver=c),this.refresh(),u.cursorKeyNavigation&&(this.toolbarHasChanged(),this._on(this._keyNavHandlers))},_keyNavHandlers:{keydown:function(e){var o=this,n=e.which,i=t(e.target);function a(t){var n,i;t.attr("tabindex","-1"),n=(i=parseFloat(o.focusableElements.index(t[0])+1))>=o.focusableElements.length?o.focusableElements.first():o.focusableElements.filter(":eq("+i+")"),t.is(":input[type=radio]")&&t.attr("name")===n.attr("name")?a(n):n.attr("tabindex","0").trigger("focus"),e.preventDefault()}function r(t){var n,i;t.attr("tabindex","-1"),n=(i=parseFloat(o.focusableElements.index(t[0])-1))<0?o.focusableElements.last():o.focusableElements.filter(":eq("+i+")"),t.is(":input[type=radio]")&&t.attr("name")===n.attr("name")?r(n):n.attr("tabindex","0").trigger("focus"),e.preventDefault()}i.is(":input[type=text],:input[type=radio],select")?e.shiftKey&&n===K.TAB?r(i):n===K.TAB&&a(i):n===K.LEFT?r(i):n===K.RIGHT&&a(i)}},_destroy:function(){var e,o=this.element,n=this.options;for(e in o.removeClass(i+" "+a+" "+r+" "+n.toolbarClass).removeAttr("role").empty(),this.actionsContext&&this.actionsContext.unobserve(this.actionObserver),this.menus)U(this.menus,e)&&t("#"+e).remove()},_setOption:function(t,e){const o=this.element;"small"===t&&o.toggleClass(a,e),"simple"===t&&o.toggleClass(r,e),"toolbarClass"===t&&o.removeClass(this.options.toolbarClass).addClass(e),this._super(t,e),"data"===t&&this.refresh()},_getControlProperty:function(t,e){let o,n;return n=t[e],void 0===n&&t.action&&(o=this.actionsContext.lookup(t.action),o&&o[e]&&(n=o[e])),n},_getControlIconProperty:function(t,e){let o=this._getControlProperty(t,"icon");return o||void 0===e||(o=this._getControlProperty(t,e?"onIcon":"offIcon")),o},_getLocalizedControlProperty:function(t,e){let o,i=null;return t[e+"Key"]?i=n.getMessage(t[e+"Key"]):void 0!==t[e]&&(i=t[e]),!i&&t.action&&(o=this.actionsContext.lookup(t.action),o&&void 0!==o[e]&&(i=o[e])),i},_getLocalizedControlLabelProperty:function(t,e){let o=this._getLocalizedControlProperty(t,"label");return o||void 0===e||(o=this._getLocalizedControlProperty(t,e?"onLabel":"offLabel")),o},_getNoUpdate:function(t){return t.label||t.labelKey||t.icon||t.title||t.titleKey?"true":null},_getId:function(t){var e=this.options.idPrefix||this.element[0].id||"tb";return t.id?e+"_"+t.id:null},_forceId:function(t){t.id||(t.id="m"+H,H+=1)},_buildText:function(e,o){var n=t.extend({id:"",label:"",size:"30",maxChars:"4000",placeholder:"",action:""},o);n.enterAction&&(this.enterActions[n.enterAction]=!0),e.markup("<input").optionalAttr("id",this._getId(n)).attr(B,f+" "+b+" "+h).attr("title",this._getLocalizedControlProperty(n,"label")).attr("type","text").attr("size",n.size).attr("maxlength",n.maxChars).attr("value","").optionalAttr("placeholder",this._getLocalizedControlProperty(n,"placeholder")).optionalAttr("data-enter-action",n.enterAction).markup(" />")},_buildStatic:function(t,e){t.markup("<span").optionalAttr("id",this._getId(e)).attr(B,m+" "+h).markup(">"),e.content?t.markup(e.content):t.content(this._getLocalizedControlProperty(e,"label")),t.markup("</span>")},_buildSelect:function(t,e){var o,n=this.actionsContext.lookup(e.action);(o=this._getLocalizedControlProperty(e,"title"))||(o=this._getLocalizedControlProperty(e,"label")),t.markup("<select").optionalAttr("id",this._getId(e)).attr(B,v+" "+h).attr("size","1").optionalAttr("title",o).optionalAttr(w,o).optionalBoolAttr(z,n&&!!n.disabled).attr(S,e.action).markup("></select>")},_buildButton:function(t,e){let o,n,i,a,r,l,s=x+" "+h,u=e.menu||e.menuId;u&&(e.menu?(this._forceId(e),o=this._getId(e)+"_menu"):o=e.menuId),r=this.actionsContext.lookup(e.action),r&&r.get&&(l=r.get(),!l||r.onLabel||r.onLabelKey||(s+=" "+I)),i=this._getControlIconProperty(e,l),i&&(s+=" "+L),i&&e.iconOnly&&(s+=" "+T),e.hot&&(s+=" "+A),t.markup("<button type='button'").attr(B,s).optionalAttr("id",this._getId(e)).optionalBoolAttr(z,r&&!!r.disabled),n=this._getLocalizedControlLabelProperty(e,l),a=this._getLocalizedControlProperty(e,"title"),M(t,n,a,i&&e.iconOnly),u?t.attr("data-menu",o).attr("aria-haspopup",!0):t.attr(S,e.action).optionalAttr("data-no-update",this._getNoUpdate(e)),t.markup(">"),j(t,i,e.iconBeforeLabel,e.iconOnly,e.iconOnly?null:n),u&&q(t,P),t.markup("</button>"),e.menu&&(this.menus[o]=e.menu)},_buildRadioButtonGroup:function(t,e){t.markup("<div role='group'").attr(w,this._getLocalizedControlProperty(e,"label")).attr(B,_+" js-actionRadioGroup "+h).attr(S,e.action).attr("data-item",x).attr("data-item-wrap",C).markup("></div>")},_buildToggle:function(t,e){let o,n,i,a,r,l,s,u,c=this.actionsContext.lookup(e.action);this._forceId(e),n=this._getId(e),i=n+"_ON_STATE_ARIA_DESC",a=n+"_OFF_STATE_ARIA_DESC",u=c&&c.get(),o=x+" "+g+" "+y,u&&(o+=" "+I),r=this._getControlIconProperty(e,u),r&&(o+=" "+L),r&&e.iconOnly&&(o+=" "+T),t.markup("<div").attr(B,y+" js-actionToggle "+h).attr(S,e.action).optionalAttr("data-no-update",this._getNoUpdate(e)).markup(">"),c.onStateDescription&&t.markup("<span").attr("id",i).attr(B,"u-vh").attr(G,"true").markup(">").content(c.onStateDescription).markup("</span>"),c.offStateDescription&&t.markup("<span").attr("id",a).attr(B,"u-vh").attr(G,"true").markup(">").content(c.offStateDescription).markup("</span>"),t.markup("<button type='button'").attr(B,o).optionalAttr("data-no-update",this._getNoUpdate(e)).attr("name",e.action).attr("id",n).attr("aria-pressed",u?"true":"false").optionalAttr("aria-describedby",u?c.onStateDescription?i:null:c.offStateDescription?a:null).optionalAttr(D,c.ariaControls).attr(w,c.label).optionalBoolAttr(z,c&&!!c.disabled),l=this._getLocalizedControlLabelProperty(e,u),s=this._getLocalizedControlProperty(e,"title"),M(t,null,s,r&&e.iconOnly),t.markup(">"),j(t,r,e.iconBeforeLabel,e.iconOnly,l),t.markup("</button></div>")},_buildToolbar:function(t,e){var o,n=[],i=[],a=[];for(o=0;o<e.length;o++)e[o].align&&e[o].align!==N?e[o].align===R?i.push(e[o]):e[o].align===F&&a.push(e[o]):n.push(e[o]);n.length&&this._buildGroupContainer(t,N,n),i.length&&this._buildGroupContainer(t,R,i),a.length&&this._buildGroupContainer(t,F,a)},_buildGroupContainer:function(t,e,n){var i,a,r,h,f,b=s;switch(e){case N:b+=" "+u;break;case R:b+=" "+c;break;case F:b+=" "+d}for(t.markup("<div").attr(B,b).markup(">"),i=0;i<n.length;i++){for(f=l,(r=n[i]).customCSS&&(f+=" "+r.customCSS),r.groupTogether&&(f+=" "+p),t.markup("<div").attr(B,f).markup(">"),a=0;a<r.controls.length;a++)switch((h=r.controls[a]).type){case"STATIC":this._buildStatic(t,h);break;case"TEXT":this._buildText(t,h);break;case"SELECT":this._buildSelect(t,h);break;case"MENU":case"BUTTON":this._buildButton(t,h);break;case"RADIO_GROUP":this._buildRadioButtonGroup(t,h);break;case"TOGGLE":this._buildToggle(t,h);break;default:o.error("Unknown toolbar control type: "+h.type)}t.markup("</div>")}t.markup("</div>")},refresh:function(){let o,n,i,a=this,r=this.element,l=this.options,s=l.data,u=e.htmlBuilder();for(o in this.menus)U(this.menus,o)&&t("#"+o).remove();this._buildToolbar(u,l.data),r.html(u.toString());for(let t=0;t<s.length;t++){let e=s[t].controls;if(e)for(let t=0;t<e.length;t++){let o=e[t];i=this.actionsContext.lookup(o.action),i&&(i.hide&&this.actionsContext.update(o.action),i.choices&&this.actionsContext.updateChoices(o.action))}}for(o in r.find(O).on("keydown",(function(e){var o=t(e.target).attr("data-enter-action");o&&13===e.which&&(a.actionsContext.invoke(o),e.preventDefault())})),this.menus)U(this.menus,o)&&(t("<div/>",{id:o,class:k,style:"display:none;"}).appendTo("body"),n=this.menus[o],n.actionsContext=this.actionsContext,n.idPrefix=this.options.idPrefix||this.element[0].id||"tb",t("#"+o).menu(n))},toolbarHasChanged:function(){var t,e;this.focusableElements=this.element.find(":focusable"),e=(t=this.focusableElements.filter("[tabindex=0]")).length?this.focusableElements.index(t[0]):0,this.focusableElements.filter(":eq("+e+")").attr("tabindex","0").end().not(":eq("+e+")").attr("tabindex","-1")},hideControl:function(t){const e=this.find(t);e&&(e.action?this.actionsContext.hide(e.action):(this.findElement(t).hide(),this.actionObserver&&this.actionObserver({},"update")))},showControl:function(t){const e=this.find(t);e&&(e.action?this.actionsContext.show(e.action):(this.findElement(t).show(),this.actionObserver&&this.actionObserver({},"update")))},disableControl:function(t){const e=this.find(t);e&&(e.action?this.actionsContext.disable(e.action):this.findElement(t).prop(z,!0))},enableControl:function(t){const e=this.find(t);e&&(e.action?this.actionsContext.enable(e.action):this.findElement(t).prop(z,!1))},findGroup:function(t){let e=this.options.data;for(let o=0;o<e.length;o++){let n=e[o];if(n.id===t)return n}return null},find:function(e){let o,n,i=this.options.data;for(let t=0;t<i.length;t++){let n=i[t].controls;if(n)for(let t=0;t<n.length;t++)if(o=n[t],o.id===e)return o}for(n in this.menus)if(U(this.menus,n)&&(o=t("#"+n).menu("find",e),o))return o;return null},findElement:function(e){let o,n=this._getId({id:e});return o=t("#"+n),o}})}(apex.jQuery,apex.util,apex.debug,apex.lang);