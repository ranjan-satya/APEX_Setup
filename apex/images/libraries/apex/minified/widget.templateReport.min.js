/*!
 * Copyright (c) 2020, 2024, Oracle and/or its affiliates. All rights reserved.
 */
!function(e,t,a,n,o,i,r,s,l){"use strict";const c="data-rownum",g="data-id",u="["+g+"]";r.templateReportRegionInit=function(r,d){const p=n("#"+e.escapeCSS(r.regionStaticId+"_"+r.regionType));let f,m=null,R=null,h=!1;function w(t){let a=x.width(),n=x.height();p.data("apexTableModelView")&&(r._isTemplateReport||e.setOuterWidth(p,a),r.hasSize&&e.setOuterHeight(p,n),t||p.tableModelView("resize"))}function I(e){const t=p.tableModelView("getPageInfo")||{};let a=null;n.each(p.find(u),(function(e,o){const i=n(o);if(!t.scrollOffset)return a=i.attr(c),!1;if(i.offset().top-(t.rowHeight/2||0)>=t.scrollOffset)return a=i.attr(c),!1}));const i={ajaxIdentifier:e.ajaxIdentifier,id:e.regionId,pageChange:{offset:t.pageOffset,count:t.pageSize,firstDisplayRow:a}};o.plugin({regions:[i]})}function b(){n("button[data-menu^='tc_menu_a']",p).each((function(){const t=e.escapeCSS(this.getAttribute("data-menu"));n(`div.a-Menu[id=${t}]`).remove(),n(`#${t}`).menu()})),p.removeClass("is-loading")}s.info("Init template report region: ",r),d=l.initialModelData(d),d?.firstDisplayedRow>1&&(r.firstDisplayedRow=d.firstDisplayedRow-1),!r.lazyLoading&&d&&(d.totalRows&&(R=d.totalRows),f=d.moreData,m=d.values);const C=l.create(r.modelName,n.extend({},r.modelOptions,{shape:"table",recordIsArray:!0,delayClearData:!0,fields:r.columns[0],regionId:r.regionId,ajaxIdentifier:r.ajaxIdentifier,regionData:{ajaxColumns:r.ajaxColumns,ajaxActions:r.ajaxActions,ajaxActionMenus:r.ajaxActionMenus},pageItemsToSubmit:r.itemsToSubmit}),m,R,f);R=m=null,f=void 0;const x=p.parent();if(r.hasSize&&x.css("height",r.reportHeight||x.height()),w(!0),r.entityTitlePlural?r.noDataMessage=i.formatMessage("APEX.NO_DATA_FOUND_ENTITY",r.entityTitlePlural):void 0===r.noDataMessage&&(r.noDataMessage=i.getMessage("APEX.IG.NO_DATA_FOUND")),r.pagination.savePaginationToServer)if(r.pagination.scroll){const t=n(window);t.on("scroll",e.debounce((function(){p.is(":visible")&&t.scrollTop()>=p.offset().top-window.innerHeight&&t.scrollTop()<=p.offset().top+p.height()&&I(r)}),600)),r.pageChange=b}else r.pageChange=function(){b(),h&&I(r),h=!0};if(r.fixedRowHeight=!1,r._isTemplateReport&&(r.controlBreakBeforeTemplate||r.controlBreakTemplate)&&(r.applyTemplateOptions={iterationCallback:function(e,t,a,n,o,i){let r=t.getControlBreakId(a),s=t.getRecordMetadata(t.getRecordId(a));if(!s.controlBreakBefore){let e=t.getControlBreaks(r);e?.firstId&&(s=t.getRecordMetadata(e.firstId))}i.APEX$BEFORE_GROUP=s?.controlBreakBefore||"",i.APEX$AFTER_GROUP=s?.controlBreakAfter||""}}),p.on("tablemodelviewselectionchange",(()=>{p.trigger("apexselectionchange",[{selectedValues:p.tableModelView("getSelectedValues")}])})),p.on("tablemodelviewcurrentitemchange",(()=>{p.trigger("apexcurrentrowchange",[{currentValue:p.tableModelView("getCurrentItem")?.attr(g)}])})),p.tableModelView(r),r._isTemplateReport){new ResizeObserver(e.debounce((function(){w()}),100)).observe(p.parent()[0])}else t.onElementResize(p.parent()[0],(()=>{w()}));t.onVisibilityChange(p[0],(e=>{e&&(r._isTemplateReport||t.updateResizeSensors(x[0]),w())}));const T=["focus","getSelectedValues","selectAll","setSelectedValues","getSelection","setSelection","firstPage","lastPage","nextPage","previousPage"],S=[...T,"getCurrentItem","setCurrentItem","getCurrentItemValue","setCurrentItemValue","getRecords","getModel","getSelectedRecords","setSelectedRecords","getPageInfo","gotoPage","loadMore"];a.create(r.regionStaticId,(function(e){const t="tableModelView",a=p[t]("instance");n.extend(e,{type:r.regionType,parentRegionId:r.parentRegionStaticId,filterRegionId:r.filterRegionId,refresh:function(){return new Promise((e=>{const t=C.subscribe({onChange:a=>{"refresh"===a&&(C.unSubscribe(t),e())}});C.clearData()||(C.unSubscribe(t),e())}))}}),r._isTemplateReport||(e.widgetName=t,e.widget=function(){return p},e.refreshView=function(){a.refresh()}),(r._isTemplateReport?T:S).forEach((t=>{e[t]=a[t].bind(a)})),r._isTemplateReport&&(e.getCurrentRow=a.getCurrentItem.bind(a),e.setCurrentRow=a.setCurrentItem.bind(a),e.getCurrentRowValue=a.getCurrentItemValue.bind(a),e.setCurrentRowValue=a.setCurrentItemValue.bind(a))}))}}(apex.util,apex.widget.util,apex.region,apex.jQuery,apex.server,apex.lang,apex.widget,apex.debug,apex.model);