/*!
 Popup - a jQuery UI based widget based on dialog
 Copyright (c) 2018, 2024, Oracle and/or its affiliates. All rights reserved.
 */
!function(t){"use strict";const o="u-callout--top",e="u-callout--bottom",s="u-callout--left",l="u-callout--right";t.widget("apex.popup",t.ui.dialog,{widgetEventPrefix:"popup",closeBlurEvent:void 0,closeMousedownEvent:void 0,closeMouseDownTarget$:void 0,closeBlurTarget$:void 0,options:{parentElement:null,relativePosition:"below",callout:!1,noOverlay:!1,takeFocus:!0,closeDeadAreas:null},_create:function(){const o=this;let e=this.options,i=this.element;o.closeBlurEvent="blur.popupTracking"+this.uuid,o.closeMousedownEvent="mousedown.popupTracking"+this.uuid,e.resizable=!1,e.draggable=!1,e.modal=!e.noOverlay,this._super(),this.calloutBefore=l,this.calloutAfter=s,"rtl"===i.css("direction")&&(this.calloutBefore=s,this.calloutAfter=l),"auto"===e.width&&this.uiDialog.css("display","inline-block").hide(),this.uiDialog.addClass("ui-dialog--popup"),e.showTitle||this.uiDialog.children(".ui-dialog-titlebar").hide(),this._setPosition(),i.on("popupopen",(()=>{e.noOverlay?(o.closeMouseDownTarget$=t(document.body).add(t("iframe").map((function(){return this.contentDocument}))),o.closeBlurTarget$=t(window),setTimeout((()=>{this.closeBlurTarget$.on(o.closeBlurEvent,(()=>{i.popup("close")})),this.closeMouseDownTarget$.on(o.closeMousedownEvent,(o=>{!t(o.target).closest(".ui-dialog").not(".ui-dialog--popup").length&&(this._allowInteraction(o)||e.closeDeadAreas&&t(o.target).closest(e.closeDeadAreas).length)||(i.data("apex-popup").opener=t(o.target),o.data={mouseDownOutPopup:!i[0].contains(o.target)},i.popup("close",o))}))}),0),i.one("popupclose",(function(){o.closeBlurTarget$.off(o.closeBlurEvent),o.closeMouseDownTarget$.off(o.closeMousedownEvent)}))):t(".ui-widget-overlay").on("click",(function(){i.popup("close")})),this._updateCallout()}))},_destroy:function(){this.callout$&&this.callout$.remove(),this.closeBlurTarget$.off(this.closeBlurEvent),this.closeMouseDownTarget$.off(this.closeMousedownEvent),this.uiDialog[0].remove()},_setPosition:function(){let i,a,n=0,u=this.options,c=this.element,r=u.relativePosition;if(u.parentElement&&(this.positionTo$="string"==typeof u.parentElement?t(document).find(u.parentElement):t(u.parentElement),this.positionTo$[0]||(this.positionTo$=null)),u.callout&&this.positionTo$?(this.callout$||(this.callout$=t("<div class='u-callout'></div>"),c.after(this.callout$)),n=parseInt(c.parent().css("margin-top"),10)):this.callout$&&(this.callout$.remove(),this.callout$=null),this.positionTo$){const t=this.positionTo$;"above"===r?(i=e,a={my:"left bottom",at:"left top-"+n,of:t,collision:"fit flipfit"}):"below"===r?(i=o,a={my:"left top",at:"left bottom+"+n,of:t,collision:"fit flipfit"}):"before"===r?(i=l,a={my:"right top",at:"left-"+n+" top",of:t,collision:"flipfit fit"}):"after"===r?(i=s,a={my:"left top",at:"right+"+n+" top",of:t,collision:"flipfit fit"}):"inside"===r&&(i=o,a={my:"left top",at:"left+"+n+" top+"+n,of:t}),this.callout$&&this.callout$.removeClass(o+" "+e+" "+l+" "+s).addClass(i)}else a={my:"center",at:"center",of:window};this.options.position=a},_updateCallout:function(){let t,i,a,n,u,c;this.callout$&&this.positionTo$&&(c=this.callout$,n=this.element.offset(),u=this.positionTo$.offset(),c.hasClass(o)?n.top<u.top&&c.removeClass(o).addClass(e):c.hasClass(e)?n.top>u.top&&c.removeClass(e).addClass(o):c.hasClass(this.calloutAfter)?n.left<u.left&&c.removeClass(this.calloutAfter).addClass(this.calloutBefore):c.hasClass(this.calloutBefore)&&n.left>u.left&&c.removeClass(this.calloutBefore).addClass(this.calloutAfter),c.css("left",""),c.css("top",""),c.hasClass(o)||c.hasClass(e)?(t=parseInt(c.css("left"),10),a=u.left-n.left,a>0&&c.css("left",a+t)):(c.hasClass(s)||c.hasClass(l))&&(i=parseInt(c.css("top"),10),a=u.top-n.top,a>0&&c.css("top",a+i)))},_setOption:function(t,o){if("draggable"===t||"resizable"===t||"modal"===t)throw new Error("Popup "+t+" cannot be set.");this._super(t,o),"parentElement"!==t&&"callout"!==t&&"relativePosition"!==t||this._setPosition()},_focusTabbable:function(){this.options.takeFocus&&this._super()},close:function(o){const e=this,s=this.options;this._isOpen&&!1!==this._trigger("beforeClose",o)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),s.takeFocus&&!this.opener.filter(":focusable").trigger("focus").length&&t.ui.safeBlur(t.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,(function(){e._trigger("close",o)})))}})}(apex.jQuery);