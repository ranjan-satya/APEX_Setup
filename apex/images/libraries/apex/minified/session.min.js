apex.session={},function(e,i,s,t,n,o,a){"use strict";var r,m,d,l,c,f,u,_="apex_session_alert_dlg";function E(){o("#"+_).remove()}function S(e,s){var t=o.extend({id:_,confirm:!0},s);return E(),i.showDialog(e,t)}function x(){l&&(clearTimeout(l),n.info("Idle session warning timer cleared. ID="+l)),c&&(clearTimeout(c),n.info("Idle session expired timer cleared. ID="+c))}function g(e){var i=new Date,s=e.life_time_ms/1e3,t=r<s?r:s;return i.setSeconds(i.getSeconds()+t),i.toLocaleTimeString(void 0,{timeStyle:"medium"})}function I(i){x(),E(),l=setTimeout((function(){e.getTimeouts((function(i){n.info("Is session idle time still valid?",i),i.idle_time_ms-1<1e3*r?(n.info("...Yes, show warning."),S(t.formatMessage("APEX.SESSION.ALERT.IDLE_WARN",g(i)),{okLabelKey:"APEX.SESSION.ALERT.EXTEND",callback:function(i){i&&e.getTimeouts((function(e){n.info("Session extended",e),I(e)}),!0)}})):(n.info("...No, reset idle timers to new values."),I(i))}))}),i.idle_time_ms-1e3*r),c=setTimeout((function(){e.getTimeouts((function(e){n.info("Is session idle expired time still valid?",e),0===e.idle_time_ms?(n.info("...Yes, show expired alert."),f&&(clearTimeout(f),n.info("Max session warning timer cleared. ID="+f)),u&&(clearTimeout(u),n.info("Max session expired timer cleared. ID="+u)),S(t.getMessage("APEX.SESSION.ALERT.EXPIRED"),{okLabelKey:"APEX.SESSION.ALERT.CREATE_NEW",callback:function(e){e&&s.redirect(m)}})):(n.info("...No, reset idle timers to new values."),I(e))}))}),i.idle_time_ms),n.info("Idle session warning timer started for "+(i.idle_time_ms/1e3-r)+" seconds. ID="+l),n.info("Idle session expired timer started for "+i.idle_time_ms/1e3+" seconds. ID="+c)}e.getTimeouts=function(e,i){o.get({url:"apex_session.emit_timeouts?p_app_id="+a.APP_ID+"&p_session_id="+a.APP_SESSION+"&p_reset_idle="+(i?"Y":"N"),dataType:"json",success:e,error:function(e,i,s){n.error("Error occurred when making session.getTimeouts Ajax call.",e,i,s)}})},e.initTimeouts=function(e,i,o,a){var l;m=o,d=a,(r=e)>0&&(r>i.max_idle_time_ms/1e3?n.warn("Invalid metadata state. Session timeout warning time ("+r+" seconds) cannot be greater than the maximum session idle time ("+i.max_idle_time_ms/1e3+" seconds)."):(I(i),l=i,f=setTimeout((function(){n.info("Session max time about to expire, show warning."),x(),S(t.formatMessage("APEX.SESSION.ALERT.MAX_WARN",g(l)),{confirm:!1})}),l.life_time_ms-1e3*r),u=setTimeout((function(){n.info("Session max time expired, show expired alert."),S(t.getMessage("APEX.SESSION.ALERT.EXPIRED"),{okLabelKey:"APEX.SESSION.ALERT.CREATE_NEW",callback:function(e){e&&s.redirect(d)}})}),l.life_time_ms),n.info("Max session warning timer started for "+(l.life_time_ms/1e3-r)+" seconds. ID="+f),n.info("Max session expired timer started for "+l.life_time_ms/1e3+" seconds. ID="+u)))}}(apex.session,apex.message,apex.navigation,apex.lang,apex.debug,apex.jQuery,apex.env);