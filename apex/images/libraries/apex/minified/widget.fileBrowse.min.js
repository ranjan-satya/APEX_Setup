/*!
 Copyright (c) 2020, 2022, Oracle and/or its affiliates. All rights reserved.
*/
!function(e,t,n,i,a,r){"use strict";const s="div.apex-item-filedrop",l="div.apex-item-group--file";let o={item_type:"FILE",enable:function(){this.element.prop("disabled",!1),this.element.parents(l).removeClass("apex_disabled")},disable:function(){this.element.prop("disabled",!0),this.element.parents(l).addClass("apex_disabled")},isDisabled:function(){return!0===this.element.prop("disabled")},isChanged:function(){return this.node.value!==this.node.defaultValue},setValue:function(e){e?i.error("This input element accepts a filename, which may only be programmatically set to the empty string."):this.element.val("")},getValue:function(){let e;return e=function(e){let t=e||[],n=[];for(let e=0;e<t.length;e++)n.push(t[e].name);return n}(this.element[0].files),e},getValidity:function(){let e=this.element.prop("validity")||{},n=t.extend({},e);return this.element.attr("data-valid-message")?(n.valid=!1,n.badInput=!0,n.customError=!0,n):n||{valid:!0}}};function d(e,t){let n=t.type.toLowerCase(),i=t.name.toLowerCase();return(e||[]).some((function(e){return/\*$/.test(e)?(t=e,(/^[^/]+/.exec(n)||[]).pop()===t.slice(0,-2)):/^\./.test(e)?(a=e,function(e){return e.split(".").pop()}(i)===a.slice(1)):e===n;var t,a}))}function f(e,t){return!(t.size>1024*e)}function p(e,t){let n=[],i=e.attr("accept"),s=parseInt(e.data("max-file-size"),10),l=[],o=t||[];o.length>0&&(i&&0===n.length&&(l=i.split(",").map((function(e){return e.trim().toLowerCase()})),n=function(e,t,n,i){let r=i||[];for(let i=0;i<n.length;i++)d(t,n[i])||r.push({type:"error",location:["inline"],pageItem:e.attr("id"),message:a.formatMessageNoEscape("APEX.ITEM.FILE.ACCEPTED_TYPES",t),unsafe:!0});return r}(e,l,o,n)),s&&0===n.length&&(n=function(e,t,n,i){let r=i||[];function s(e){let t,n,i=0;for(;e>=1024;)e/=1024,i+=1;for(t=["B","KB","MB","GB","TB","PB","EB","ZB","YB"][i],i=0;e>=1024;)e/=1024,i+=1;return n=i<2?e.toFixed(0):e.toFixed(1),n+" "+t}for(let i=0;i<n.length;i++)f(t,n[i])||r.push({type:"error",location:["inline"],pageItem:e.attr("id"),message:a.formatMessage("APEX.ITEM.FILE.MAX_FILE_SIZE",s(1024*t)),unsafe:!1});return r}(e,s,o,n)),n=function(e){let t=[];return t=(e||[]).filter((function(e,t,n){return n.findIndex((function(t){return JSON.stringify(t)===JSON.stringify(e)}))===t})),t}(n),0===n.length?(r.clearErrors(),e.removeAttr("data-valid-message")):n.length>0&&(r.clearErrors(),r.showErrors(n),e.attr("data-valid-message",n.map((function(e){return e.message})).join(",")),e.val("").trigger("change")))}e.addAttachHandler((function(i){t("input[type='file'].apex-item-file",i).each((function(){let i=t(this),r=n.escapeCSS(this.id),l=i.data("display-style")||"INLINE";if("NATIVE"===l&&i.on("change",(function(){p(i,this.files)})),"INLINE"===l||"DROPZONE_INLINE"===l||"DROPZONE_BLOCK"===l){if(i.on("change",(function(){let e=this.files,n="",r=t(this),l=r.next(s).find(".apex-item-filedrop-filename");e&&e.length>1?n=a.formatMessage("APEX.ITEM.FILE.FILES_WITH_COUNT",e.length):e[0]&&(n=e[0].name),n?l.text(n):l.text(""),e&&e.length>0?(r.next(s).addClass("has-files"),r.next(s).find(".apex-item-filedrop-description").hide()):(r.next(s).removeClass("has-files"),r.next(s).find(".apex-item-filedrop-description").show()),p(i,e)})),i.next(s).on("click",(function(){i.trigger("click")})),i.next(s)[0].addEventListener("dragover",(function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",i.trigger("focus"),i.next(s).addClass("is-dragging")})),i.next(s)[0].addEventListener("dragleave",(function(e){e.preventDefault(),i.blur(),i.next(s).removeClass("is-dragging")})),i.next(s)[0].addEventListener("drop",(function(e){e.preventDefault(),i.blur(),i.next(s).removeClass("is-dragging"),i.prop("disabled")||(i[0].files=e.dataTransfer.files,i.trigger("change"))})),i.data("show-progress")){"A"===(t("#pReloadOnSubmit").val()||"A")&&t(document).on("apexbeforepagesubmit",(function(){i[0].files.length>0&&i.next(s).addClass("is-loading")}))}i.data("allow-paste")&&window.addEventListener("paste",(function(e){e.clipboardData.files&&e.clipboardData.files.length>0&&(i.prop("disabled")||(i[0].files=e.clipboardData.files,i.trigger("change")))}))}e.create(r,o)}))}))}(apex.item,apex.jQuery,apex.util,apex.debug,apex.lang,apex.message);