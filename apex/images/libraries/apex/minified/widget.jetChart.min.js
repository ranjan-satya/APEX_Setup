/*!
 * Copyright (c) 2015, 2024, Oracle and/or its affiliates.
 */
!function(e,t,r,a,i,o,n,s){"use strict";const c=r.hasOwnProperty;apex.widget.jetChart={init:function(l,u,m,f,p,d,v,g){require(["ojs/ojcore","jquery","ojs/ojchart","ojs/ojgauge","ojs/ojgantt","ojs/ojvalidation","ojs/ojtimezonedata"],(function(p){var y,h=e("#"+r.escapeCSS(l)+"_jet",apex.gPageContext$),x=f||{};function j(){if(e("#"+r.escapeCSS(l)).hasClass("is-maximized"))h.css("max-width","100%").css("height",e(window).height()/100*80);else{var t="100%",a=null;u&&(t=u+"px"),m?a=m+"px":"gantt"===x.type&&(a="100%"),h.css("width","100%").css("max-width",t),a?h.css("height",a):h.css("height",""),"dial"!==x.type&&h.css("min-width","100px")}}function b(){t.plugin(g,{pageItems:x.pageItems},{dataType:"json",refreshObject:h,loadingIndicator:h,loadingIndicatorPosition:"centered",success:A})}function A(t){var r,i,n,l=["pie","funnel","pyramid","scatter","bubble","gantt","stock"],u=0,m="dial"===x.type?"dial":"chart",f="gantt"===x.type?"gantt":m;if("function"==typeof x.dataFilter&&(t=x.dataFilter(t)),"dial"===m)x.title&&h.closest("div").attr("title",x.title.replace(/#VALUE#/g,t.value).replace(/#MAX#/g,t.max));else if(-1===e.inArray(x.type,l)&&t.series.length>1&&"mixedFrequency"!==x.timeAxisType&&"skipGaps"!==x.timeAxisType&&x.sorting){s.chartSortArray(t.groups,x.sorting);for(var g=0;g<t.series.length;g++){s.chartFillGaps(t.groups,t.series[g].items,x.sorting,d);for(var y=0;y<t.series[g].items.length;y++)t.series[g].items[y].id=""+u,u+=1}}h[f={chart:"ojChart",dial:"ojStatusMeterGauge",gantt:"ojGantt"}[f]](t),s.onVisibilityChange(h[0],(function(e){e?(p.Components.subtreeShown(h[0]),j(),h[f]("refresh")):p.Components.subtreeHidden(h[0])})),e(window).on("apexwindowresized",(function(){j()})),"ojChart"===f&&("pie"===x.type?h[f]({drill:function(e,t){(i=t.data.link)&&(a.log("Chart link: "+i),o.redirect(i))},dataLabel:function(a){var i,o,s,l,u;switch(i=Math.round(a.value/a.totalValue*100)+"%",s=a.value,l=function(e){for(r in e)if(c(e,r)&&e[r].items.length>0)for(n in e[r].items)if(e[r].items[n].labelDisplay)return e[r].items[n].labelDisplay}(t.series),x.valueFormats&&x.valueFormats.value&&x.valueFormats.value.converter&&(s=x.valueFormats.value.converter.format(a.value)),-1!==e.inArray(l,["LABEL","ALL","LBL_VAL","LBL_PCT"])&&(o=a.seriesData?a.seriesData.name:"Other"),l){case"VALUE":u=s;break;case"PERCENT":u=i;break;case"LABEL":u=o;break;case"LBL_VAL":u=o+" - "+s;break;case"LBL_PCT":u=o+" - "+i;break;case"ALL":u=o+" - "+i+" ( "+s+" )";break;case"COMBO":u=i+" ( "+s+" )"}return u}}):h[f]({drill:function(r,n){-1===e.inArray(x.type,l)?n.group&&n.series&&(i=function(e,t,r){var a;function i(e,t,r){var a;for(a=0;a<e.length;a++)if("pie"===x.type||"funnel"===x.type||"pyramid"===x.type){if(e[a].name===t)return e[a].link}else if("stock"===x.type){var i=new Date(e[a].name);if(i.getTime()===r||i===r)return e[a].link}else{if(e[a].name===r)return e[a].link;var o=new Date(e[a].name);if(o.getTime()===r||o===r)return e[a].link}}for(a in e)if(c(e,a))if(e[a].id){if((e[a].id===t||e[a].name===t)&&e[a].items.length>0)return i(e[a].items,t,r)}else if(e[a].name&&e[a].name===t&&e[a].items.length>0)return i(e[a].items,t,r)}(t.series,n.series,n.group)):i=n.data.link,i&&(a.log("Chart link: "+i),o.redirect(i))}})),"ojStatusMeterGauge"===f&&h[f]({tooltip:{renderer:function(e){var r;return t.tooltipRendered&&(r=t.customTooltip?t.customTooltip:e.label),r}}}),"ojGantt"===f&&t.tooltip&&h[f]({tooltip:{renderer:function(e){return e.data.customTooltip}}}),v>0&&setTimeout((function(){b()}),1e3*v)}y="dial"===x.type?"ojStatusMeterGauge":"gantt"===x.type?"ojGantt":"ojChart",n.jetChart.formatData(x,!1),h[y](x),i.create(l,{type:"JetChart",widgetName:y,refresh:function(){j(),b()},focus:function(){h.trigger("focus")},widget:function(){return h}}),i(l).refresh()}))},initReportChart:function(a,i,o,c){require(["ojs/ojcore","jquery","ojs/ojchart","ojs/ojvalidation"],(function(l){var u,m,f,p=e("#"+r.escapeCSS(a),apex.gPageContext$);function d(){var e="500px";p.css("width","100%"),p.css("max-width","100%"),e&&p.css("height",e),p.css("min-width","100px")}m={legend:{rendered:"off"},animationOnDisplay:"auto",animationOnDataChange:"auto",hoverBehavior:"dim",groups:[],series:[],valueFormats:[]},p[u="ojChart"](m),d(),f={p_widget_name:"worksheet",p_widget_mod:"GET_CHART_JSON",x01:i,x02:o},t.plugin(c,f,{dataType:"json",type:"GET",success:function(e){n.jetChart.formatData(e,!0),p[u](e),p[u]({dataLabel:function(t){var r,a;return a=t.value,e.valueFormats&&e.valueFormats.value&&e.valueFormats.value.converter&&(a=e.valueFormats.value.converter.format(a)),r=t.seriesData?t.seriesData.name:"Other","pie"===t.seriesData.type?r+" - "+a:null}})}}),s.onVisibilityChange(p[0],(function(e){e?(l.Components.subtreeShown(p[0]),d(),p[u]("refresh")):l.Components.subtreeHidden(p[0])}))}))},formatData:function(e,t){var r,a,i,o,n=e,s=new oj.ColorAttributeGroupHandler;if(t)if("bar"!==n.type){for(o=n.series,a=0;a<o.length;a++)o[a].color=s.getValue(o[a].name);n.series=o}else{for(o=n.series[0].items,a=0;a<o.length;a++)o[a].color=s.getValue(o[a].name);n.series[0].items=o}if("gantt"!==n.type)if("dial"===n.type){if(n.metricLabel)for(const e of Object.keys(n.metricLabel))"converter"===e&&(n.metricLabel[e]=oj.Validation.converterFactory("number").createConverter(n.metricLabel[e]))}else{if(n.valueFormats)for(const e of Object.keys(n.valueFormats))for(const[t,a]of Object.entries(n.valueFormats[e]))"converter"===t&&(r=a.formatType?"datetime":"number",n.valueFormats[e][t]=oj.Validation.converterFactory(r).createConverter(n.valueFormats[e][t]));if(n.xAxis&&n.xAxis.tickLabel)for(const[e,t]of Object.entries(n.xAxis.tickLabel))"converter"===e&&(r=t.formatType?"datetime":"number",n.xAxis.tickLabel[e]=oj.Validation.converterFactory(r).createConverter(n.xAxis.tickLabel[e]));if(n.yAxis&&n.yAxis.tickLabel)for(const[e,t]of Object.entries(n.yAxis.tickLabel))"converter"===e&&(r=t.formatType?"datetime":"number",n.yAxis.tickLabel[e]=oj.Validation.converterFactory(r).createConverter(n.yAxis.tickLabel[e]));if(n.y2Axis&&n.y2Axis.tickLabel)for(const[e,t]of Object.entries(n.y2Axis.tickLabel))"converter"===e&&(r=t.formatType?"datetime":"number",n.y2Axis.tickLabel[e]=oj.Validation.converterFactory(r).createConverter(n.y2Axis.tickLabel[e]))}else{if(n.majorAxis&&n.majorAxis.converter)for(i in n.majorAxis.converter)c(n.majorAxis.converter,i)&&(r="datetime",n.majorAxis.converter[i]=oj.Validation.converterFactory(r).createConverter(n.majorAxis.converter[i]));if(n.minorAxis&&n.minorAxis.converter)for(i in n.minorAxis.converter)c(n.minorAxis.converter,i)&&(r="datetime",n.minorAxis.converter[i]=oj.Validation.converterFactory(r).createConverter(n.minorAxis.converter[i]))}return n}}}(apex.jQuery,apex.server,apex.util,apex.debug,apex.region,apex.navigation,apex.widget,apex.widget.util);