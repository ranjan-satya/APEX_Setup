/*!
 Copyright (c) 2012, 2024, Oracle and/or its affiliates.
*/
apex.util=function(e,t,n){"use strict";function r(e){return"string"==typeof e?e.replace(/([.$*+\-?(){}|^[\]\\])/g,"\\$1"):""}function l(e){return null===e?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function i(e){return(e=""+e).replace(/[^A-Za-z0-9\-_.,]/gu,(function(e){let t=e.codePointAt().toString(16).toUpperCase();return t.length%2!=0&&(t="0"+t),"&#x"+t+";"}))}const a=function(e){return l(""+e)};let o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const s=Object.entries;function u(e){return"object"==typeof e&&o(e,"v")}const c=new RegExp("(["+r(" !#$%&'()*+,./:;<=>?@[\\]^`{|}~\"")+"])","g"),p=/<[^<>]+>/;let d=null,f=null;const g=Array.isArray,h=e.extend,m={eq:function(e,t){if(g(e)){for(let n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}return e===t},neq:function(e,t){return!m.eq(e,t)},null:function(e){return null===e||""===e||g(e)&&0===e.length},notnull:function(e){return!m.null(e)},in:function(e,t){if("string"!=typeof t)return!1;if(t=","+t+",",g(e)){for(let n=0;n<e.length;n++)if(t.indexOf(","+e[n]+",")>=0)return!0;return!1}return t.indexOf(","+e+",")>=0},notin:function(e,t){return!m.in(e,t)}};let x=1;const w={markup:function(e){return this.html+=e,this},attr:function(e,t){return 1===arguments.length&&(t=e,e=null),e&&(this.html+=" "+e+"='"),this.html+=i(t),e&&(this.html+="'"),this},optionalAttr:function(e,t){return t&&"object"!=typeof t&&(this.html+=" "+e+"='"+i(t)+"'"),this},optionalBoolAttr:function(e,t){return!0===t&&(this.html+=" "+e),this},content:function(e){return this.html+=a(e),this},clear:function(){this.html=""},toString:function(){return this.html}};let y=null;const b=new Map,v=new Map,T={node:!1,element:{},item_type:!1,id:!1},A=/&(([A-Z0-9_$#]+(?:%[A-Za-z0-9_]+)?)|"([^"\r\n]+)")(!([A-Z]+))?\./g,E=/%([A-Za-z0-9_]+)$/,S=/#([_$A-Z0-9]+)(?:(?:!)([A-Z]+))?#|{([iIcClLeEoOwWaA{!]([^/\r\n]|\/(?!}))*)\/}/g,P=/^(!|\w+(?:\s+|$))(.*)?$/,I=/^(.+)_LABEL$/,C=/^[_$A-Z0-9]+$/,_=/^[^"\r\n]+$/,O=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script\s*>/gi,M=/\$[^$]*$/,k=/^"([^"]+)"\s+([^"&\r\n]+)$/,R=/\n\s*([_$A-Z0-9]+)\s*:=/g,$=/[#&{]|\/}/,L=/{((?:else)?if|case|loop)\s+(?:((?:!\s*)?[?=]?)\s*|"([^"]+)"\s+)?([^"/}\r\n]+)\/}/gi,D=/&\{((?:[^"}]|(?:"(?:[^"]|"")*"))+)\}(?:!(HTML|ATTR|JS|RAW|STRIPHTML))?\./g,F=/^[^"\s]+(\s*[^="\s]+=(?:(?!&")[^"}\s]+|"(?:[^"]|"")*"|&"(?:[^"]|"")*"[^"}\s]*.)?)*$/,V=/^((?:[^"\s])+)/,N=/(?:^(?:[^"\s])+)?\s([^="\s]+)=(?:((?!&")[^"}\s]+)|(?:"((?:[^"]|"")*)")|(&"(?:[^"]|"")*"[^"}\s]*.)?)*/g;function X(e){let t=v.get(e);if(!t){let n=apex.gPageContext$[0].getElementById(e);t=n?apex.item(n):T,v.set(e,t)}return t.node?t:null}function q(e){return!0===e?"Y":"N"}function j(e,t,n,r,l){let i=e.getOption("fields"),a=null;return void 0!==i[t]&&(a=i[t][n]||"","tmpl"===r?a=Y(a,l):"bool"===r&&(a=q(a)),a=""+a),a}function H(e){let t,n,r={};if(!F.test(e))return!1;for(t=V.exec(e)[1];null!==(n=N.exec(e));)r[n[1]]=n[2]||n[3]||n[4]||"";return{messageKey:t,parameters:r}}const B={label:function(t){let n=e("#"+Q.escapeCSS(t.id)+"_CONTAINER");return n.length||(n=e("body")),n.find("[for='"+Q.escapeCSS(t.id)+"']").text()},display:function(e){let t=e.displayValueFor(e.getValue());return g(t)&&(t=t.join(", ")),t},valid:function(e){return q(e.getValidity().valid)},message:function(e){return e.getValidationMessage()},changed:function(e){return q(e.isChanged())},disabled:function(e){return q(e.isDisabled())}},W={display:function(e,t,n,r){let l,i=n.getOption("fields"),a=n.getValue(r,e);if(void 0!==i[e]&&(l=i[e]),l&&l.cellTemplate)a=Y(l.cellTemplate,t);else if("object"==typeof a&&a.d)a=a.d;else if(l&&l.elementId){let e=X(l.elementId);e&&(a=e.displayValueFor(a))}return a},label:function(e,t,n){let r=n.getOption("fields"),l=null;if(void 0!==r[e]){let t=r[e];l=Q.stripHTML(t.label||t.heading||"")}return l},heading:function(e,t,n){let r=n.getOption("fields"),l=null;if(void 0!==r[e]){let t=r[e];l=t.heading||t.label||""}return l},heading_class:function(e,t,n){return j(n,e,"headingCssClasses")},column_class:function(e,t,n){return j(n,e,"columnCssClasses")},field_class:function(e,t,n){return j(n,e,"fieldCssClasses")},field_col_span:function(e,t,n){return j(n,e,"fieldColSpan")},width:function(e,t,n){return j(n,e,"width")},required:function(e,t,n){return j(n,e,"isRequired","bool")},readonly:function(e,t,n,r,l){let i,a=j(n,e,"readonly","bool");return"Y"!==a&&(l&&l.fields&&l.fields[e]&&(i=l.fields[e]),(i&&i.ck||!n.allowEdit(r))&&(a="Y")),a},link:function(e,t,n,r,l){let i,a,o="",s=n.getOption("fields");return l&&l.fields&&l.fields[e]&&(a=l.fields[e]),void 0!==s[e]&&(i=s[e]),(a&&a.url||i.linkTargetColumn)&&(o=i.linkTargetColumn?n.getValue(r,i.linkTargetColumn)||null:a.url),o},link_text:function(e,t,n){return j(n,e,"linkText","tmpl",t)},link_attrs:function(e,t,n){return j(n,e,"linkAttributes","tmpl",t)},hidden:function(e,t,n){return j(n,e,"hidden","bool")}};function U(e,t,n){let r,l=null;return t&&B[n]?(r=X(t),r&&(l=B[n](r))):(r=X(e),r&&(l=r.getValue())),[l,r]}const Z="STRIPHTML",z="RAW",G="ATTR",J="HTML";function K(e,t,n,r,l,i){const a=apex.model;let o,s,u,c,p,d,f,g,h=i.length-1,m=i[h],x=m.model,w=m.record,y=m.recMeta,b=[],v=null,T=null;for(;null===T&&w&&x;){let A;t&&W[n]?(T=W[n](t,l,x,w,y),A=t):(T=x.getValue(w,e),void 0===T&&(T=null),A=e,null===T&&(g=I.exec(e),g&&(p=g[1],d=x.getOption("fields"),void 0!==d[p]&&(T=d[p].label||d[p].heading||null),A=p))),w=null,null===T?(o=x.getOption("parentModel"),s=x.getOption("parentRecordId"),o&&s?(x=a.get(o),x&&(b.push(o),w=x.getRecord(s),c=x.getRecordId(w),y=null,c&&(y=x.getRecordMetadata(c)))):h>0&&(h-=1,m=i[h],x=m.model,w=m.record,y=m.recMeta)):(w=null,d=x.getOption("fields"),f=d[A],f&&void 0!==f.escape&&(r=f.escape?J:z),f&&void 0!==f.elementId&&(u=f.elementId,v=X(u)))}for(let e=0;e<b.length;e++)a.release(b[e]);return[T,v,r]}function Y(e,r,a,s){const u=apex.model,c=new Map;let p,d,f,m,x,w,T,I,L,F,V,N,j,B,W=[],ee=[],te=[],ne=[],re=s||[];const le={if:function(e,t){let n,r={matched:!1};return ie(t)?(n=ae(t),ee.push(r),n?(r.matched=!0,e):ge(e,{else:1,elseif:1,endif:1},"if","endif")):e},elseif:function(e,n){let r,l=ee[ee.length-1];return!ie(n)||oe(ee,"elseif","if")?e:(r=ae(n),l.hasElse&&t.error("applyTemplate 'elseif' must come before 'else'"),!l.matched&&r?(l.matched=!0,e):ge(e,{else:1,elseif:1,endif:1},"if","endif"))},else:function(e,n){let r=ee[ee.length-1];return se("else",n),oe(ee,"else","if")?e:(r.hasElse&&t.error("applyTemplate 'if' must have only one 'else'"),r.hasElse=!0,r.matched?ge(e,{endif:1},"if","endif"):(r.matched=!0,e))},endif:function(e,t){return se("endif",t),oe(ee,"endif","if")||ee.pop(),e},case:function(e,n){let r,l={matched:!1};if(r=W[e],"text"===r.type&&""===r.text.trim()&&(e+=1),r=W[e],"directive"===r.type&&"when"===r.name){if(!ie(n))return e;te.push(l),l.value=pe(n,!1).trim()}else t.error("applyTemplate must have 'when' right after 'case'");return e},when:function(e,n){let r=te[te.length-1];return oe(te,"when","case")?e:(r.hasOtherwise&&t.error("applyTemplate 'when' must come before 'otherwise'"),r.matched?ge(e,{endcase:1},"case","endcase"):r.value===n.trim()?(r.matched=!0,e):ge(e,{when:1,otherwise:1,endcase:1},"case","endcase"))},otherwise:function(e,n){let r=te[te.length-1];return se("otherwise",n),oe(te,"otherwise","case")?e:(r.hasOtherwise&&t.error("applyTemplate 'case' must have only one 'otherwise'"),r.hasOtherwise=!0,r.matched?ge(e,{endcase:1},"case","endcase"):(r.matched=!0,e))},endcase:function(e,t){return se("endcase",t),oe(te,"endcase","case")||te.pop(),e},with:function(e){let n,r,l,i,a,o,s,u,p=0,d="",f=ge(e,{apply:1},"with","apply");for(n=e;n<f;n++)d+=W[n].text;if(l=W[e=n],l&&"directive"===l.type&&"apply"===l.name)for(c.clear(),r=R.exec(d);r;)a=r.index+r[0].length,0===p&&(i=r[1],o=a),r=R.exec(d),s=r?r.index:d.length,u=d.substring(a,s),u.includes("{with")&&(p+=1),u.includes("{apply")&&(p-=u.split("{apply").length-1),0===p&&c.set(i,d.substring(o,s).trim());else t.error("applyTemplate missing 'apply' after 'with'");return e},apply:function(e,n){let o=!1;if(n){let e=b.get(n);if(e){o=!0;let n=h({},a),s=e.args||[],u={...r};u.formalArgs=s;for(let e=0;e<s.length;e++){let n=s[e],r=n.name;!0!==n.required||c.has(r)&&""!==c.get(r)||t.error("applyTemplate 'apply' missing required argument "+r),c.has(r)||c.set(r,n.default||"")}for(const[e,t]of c.entries()){let o,u,c=null,p=s.find((t=>t.name===e));p&&p.escape&&p.escape!==z&&(c=p.escape),t.match($)?(o=r.defaultEscapeFilter,c&&(r.defaultEscapeFilter=!1),u=Y(t,r,a,re),r.defaultEscapeFilter=o):u=t,c===G?u=i(u):c===J?u=l(u):c===Z&&(u=l(Q.stripHTML(u.replace("&nbsp;","")))),n[e]=u}p+=Y(e.template,u,n),c.clear()}}return o||t.warn("applyTemplate 'apply' missing or unknown template name"),e},loop:function(e,n){let l,i,a,o,s,c=null,p={};if(ne.push(p),n){if(s=fe(n),/^\[.*,.*]$/.test(s))try{s=JSON.parse(s),g(s)&&2===s.length||(s=null)}catch(e){s=null}s&&(l=u&&u.get(s))}else s=null,l=r.model,l||t.error("applyTemplate no model or item to loop over");if(l)o=r.extraSubstitutions,p.prevExtraData=o,o=r.extraSubstitutions=Object.create(o),p.model=l,re.push(p),l.forEach((function(t,i,a){let s=l.getRecordMetadata(a);B="directive",p.record=t,p.recMeta=s,o.APEX$I=""+(i+1),o.APEX$ID=a,o.APEX$META=function(e){let t="",n="O";return e.agg&&(n=""),e.deleted?n="D":e.inserted?n="I":e.updated&&(n="U"),e.canEdit&&(t+="U"),e.canDelete&&(t+="D"),{selected:!!e.sel,state:n,allowedOperations:t,valid:!(e.deleted||e.agg||e.error||e.warn),agg:e.agg||"",highlight:e.highlight||"",endControlBreak:!!e.endControlBreak,grandTotal:!!e.grandTotal,errorMessage:e.error?e.message:"",warningMessage:e.warning?e.message:""}}(s),r.iterationCallback&&r.iterationCallback(n,l,t,i,r.placeholders,o),c=he(W,e)})),r.extraSubstitutions=p.prevExtraData,s&&u.release(s),re.pop(),null!==c&&me(c-1);else if(n){let t,l,s,u=k.exec(n);if(u)t=u[1],l=u[2];else{l=n;let e=X(l);e&&(t=e.getSeparator(),s=e.getMultiValueStorage()),t=t||":"}if(t.length>1&&(t=new RegExp(t)),i=pe(l,!0),i){o=r.extraSubstitutions,p.prevExtraData=o,o=r.extraSubstitutions=Object.create(o),a=s?Q.toArray(i,s):Q.toArray(i,t);for(let t=0;t<a.length;t++)B="directive",o.APEX$I=""+(t+1),o.APEX$ITEM=a[t],r.iterationCallback&&r.iterationCallback(n,null,null,t,r.placeholders,o),c=he(W,e);r.extraSubstitutions=p.prevExtraData,null!==c&&me(c-1)}}return null===c&&(c=ge(e,{endloop:1},"loop","endloop"),c<W.length&&(c=me(c))),c},endloop:function(e,t){return se("endloop",t),oe(ne,"endloop","loop")||ne.pop(),e},"!":function(e){return d=d.substring(x+L.length+3),e}};function ie(e){return!(null==e||!_.test(e))||(t.error("applyTemplate missing or invalid name for 'if', 'elseif', or 'case'"),!1)}function ae(e){let t,n,l=null,i=!1;return e.startsWith("!")&&(i=!0,e=e.substr(1).trim()),n=e.substr(0,1),"?=".includes(n)?e=e.substr(1).trim():n=null,t=pe(e,!1),t=t.trim(),r.includePageItems&&(l=X(e)),t="?"===n?!(l&&l.isEmpty()||""===t):"="===n?!r.falseValues.includes(t):!(l&&l.isEmpty()||""===t||r.falseValues.includes(t)),i&&(t=!t),t}function oe(e,n,r){let l=e.length<1;return l&&t.error("applyTemplate '"+n+"' without '"+r+"'"),l}function se(e,n){""!==n&&t.warn("applyTemplate extra text after directive '"+e+"' ignored")}function ue(e,t,n){if(!1!==t)if(t||(t=n),!1===n&&t!==Z&&(t=z),t===J)e=l(e);else if(t===G)e=i(e);else if(t===Z)e=Q.stripHTML(e.replace("&nbsp;","")),!1!==n&&(e=l(e));else if(t!==z&&t)throw new Error("Invalid template filter: "+t);return e}function ce(e,n,l){let i,a,s,u,c,p,d=r.defaultEscapeFilter;if(s=E.exec(e),s&&(p=e.substring(0,s.index),c=s[1],u=c.toLowerCase()),i=function(e){let n=null;if(e.startsWith("APP_TEXT$")){let r=e.substr(9),l=M.exec(r);l&&(l[0].length>1&&t.warn("applyTemplate message text substitution "+l[0]+" language ignored."),r=r.replace(M,"")),r&&(n=apex.lang.getMessage(r))}return n}(e),null===i&&re.length>0&&([i,a,d]=K(e,p,u,d,r,re)),null===i&&r.includePageItems&&([i,a]=U(e,p,u)),null===i&&r.includeBuiltinSubstitutions&&(i=y[e]||null),null===i&&r.extraSubstitutions&&(i=r.extraSubstitutions[p||e]||null,null!=i&&p&&"object"==typeof i&&(i=i[c],"boolean"==typeof i?i=q(i):void 0===i&&(i=null))),null===i)i="";else{if("object"==typeof i&&o(i,"v")&&(i=i.v),"string"!=typeof i&&(n||!l))if(g(i)){let e=":";a&&(e=a.getSeparator()),i=i.join(e)}else i=""+i;i=ue(i,n,d)}return i}function pe(e,t){const n=r.placeholders;if(C.test(e)){if(a&&void 0!==a[e])return a[e];if(n&&void 0!==n[e])return n[e]}return ce(e,!1,t)}function de(e,t){let n,l,i,o;return n=a&&void 0!==a[e]?a[e]:r.placeholders[T],r.formalArgs&&(o=r.formalArgs.find((t=>t.name===e)),o&&(l=o.escape)),(!1===r.defaultEscapeFilter||l&&l===t)&&(i=!1),ue(n,t,i)}function fe(e,l){return n.COMPATIBILITY_MODE>=24.2&&e.includes("&{")&&(e=e.replace(D,((e,n,i)=>{let a;if(n)return a=H(n),a?function(e,n){let l="",i={},a=r.defaultEscapeFilter;if(e){for(const n in e.parameters)"$lang"===n?t.warn("applyTemplate message text substitution "+n+" language ignored."):i[n]=fe(e.parameters[n],J);l=apex.lang.formatMessageNoEscape(e.messageKey,i),l=ue(l,n,a)}return l}(a,i||l):e}))),e.replace(A,((e,t,n,r,i,a)=>{let o="";return r&&(n=r),n&&(o=ce(n,a||l)),o}))}function ge(e,t,n,r){let l,i,a,o=0;for(l=e;l<W.length;l++){if(i=W[l],a=i.name,"directive"===i.type){if(t[a]&&0===o)break;a===n?o+=1:a===r&&(o-=1)}if(o<0)break}return l}function he(e,t){let n,r=t;for(;;){if(r>=e.length){r=null;break}if(r=me(r),n=e[r],n&&"directive"===n.type&&"endloop"===n.name){r+=1;break}}return r}function me(e){let t=W[e];if(e+=1,"text"===t.type){let e=t.text;"directive"===B&&(e=e.replace(/^\s+/," ")),p+=fe(e),B=t.type}else"ph"===t.type?(p+=t.value,B=t.type):"directive"===t.type&&(j=le[t.name],j?(B=t.type,e=j(e,t.arg)):(p+=fe(t.text),B="text"));return e}if((r=h({placeholders:null,directives:!0,defaultEscapeFilter:J,includePageItems:!0,model:null,record:null,extraSubstitutions:{},includeBuiltinSubstitutions:!0,falseValues:["F","f","N","n","0"],clearItemCache:!0},r||{})).falseValues.includes("N")||r.falseValues.push("N"),!a&&r.clearItemCache&&v.clear(),r.model&&r.record&&0===re.length){let e=null,t=r.model,n=r.record,l=t.getRecordId(n);l&&(e=t.getRecordMetadata(l)),re.push({model:t,record:n,recMeta:e})}if(!y&&r.includeBuiltinSubstitutions&&(y={APP_USER:n.APP_USER,APP_ID:n.APP_ID,APP_PAGE_ID:n.APP_PAGE_ID,APP_SESSION:n.APP_SESSION,APP_FILES:n.APP_FILES,WORKSPACE_FILES:n.WORKSPACE_FILES,REQUEST:$v("pRequest"),DEBUG:$v("pdebug"),IMAGE_PREFIX:n.APEX_FILES,APEX_FILES:n.APEX_FILES,APEX_VERSION:n.APEX_VERSION,APEX_BASE_VERSION:n.APEX_BASE_VERSION}),(a||r.directives)&&null===r.placeholders&&(r.placeholders={}),F=null!==r.placeholders,V=r.directives,F||V){for(d=e,f=S.exec(d),x=f?f.index:-1,w=0;f;){if(T=f[1],I=f[2],L=f[3],"{{/}"===f[0])W.push({type:"text",text:d.substring(w,x)+"{"}),w=x+f[0].length;else if(T&&F){let e=de(T,I);void 0!==e?(x>w&&W.push({type:"text",text:d.substring(w,x)}),W.push({type:"ph",text:f[0],value:e})):(W.push({type:"text",text:d.substring(w,x+T.length+2)}),S.lastIndex-=1),w=x+f[0].length}else L&&V&&(x>w&&W.push({type:"text",text:d.substring(w,x)}),m=P.exec(L),m?W.push({type:"directive",text:f[0],name:m[1].trim().toLowerCase(),arg:(m[2]||"").trim()}):W.push({type:"text",text:f[0]}),w=x+f[0].length);f=S.exec(d),x=f?f.index:-1}d.length>w&&W.push({type:"text",text:d.substring(w)})}else W.push({type:"text",text:e});for(let e=1;e<W.length;e++){let t=W[e],n=W[e-1];"text"===t.type&&"text"===n.type&&(n.text+=t.text,W.splice(e,1),e-=1)}for(r.iterationCallback&&r.model&&r.record&&r.iterationCallback(null,r.model,r.record,null,r.placeholders,r.extraSubstitutions),p="",N=0,B=null;N<W.length;)N=me(N);for((ee.length>0||te.length>0||ne.length>0)&&t.error("applyTemplate missing 'endif', 'endcase', or 'endloop'");O.test(p);)p=p.replace(O,"");return p}const Q={debounce:function(e,t,n=!1){let r;return function(...l){let i=this;n?(r||e.apply(i,l),clearTimeout(r),r=setTimeout((function(){r=null}),t)):(clearTimeout(r),r=setTimeout((function(){r=null,e.apply(i,l)}),t))}},throttle:function(e,t,n=!0){let r,l;return function(...i){let a=this;const o=function(){r=l&&(e.apply(a,l),l=null,n)?setTimeout(o,t):null};r?l=i:n?(e.apply(a,i),r=setTimeout(o,t)):(l=i,r=setTimeout(o,t))}},toArray:function(t,n=":"){let r,l,i=n;if("object"!=typeof n||n instanceof RegExp||(i=n?.separator,l=n?.type),""===t||null==t)return[];if(Array.isArray(t))return t;if("json-array"!==l)return r="string"==typeof t?t.split(i||":"):e.makeArray(t),r;{const e="Value provided is not a valid JSON array";try{if(r=JSON.parse(t),!Array.isArray(r))throw new Error(e);return r}catch(t){throw t instanceof SyntaxError?new Error(e):t}}},arrayEqual:function(e,t){let n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0},unorderedArrayEqual:function(e,t){if(e.length!==t.length)return!1;const n=[...e],r=[...t];return n.sort(),r.sort(),n.every(((e,t)=>e===r[t]))},binarySearch:function(e,t,n){let r,l,i=0,a=e.length-1;for(;i<=a;)if(r=a+i>>1,l=n(t,e[r]),l>0)i=r+1;else{if(!(l<0))return r;a=r-1}return i},escapeHTML:l,escapeHTMLAttr:i,escapeRegExp:r,escapeCSS:function(e){return e?CSS&&CSS.escape?CSS.escape(e):e.replace(c,"\\$1"):""},getContextString:function(){return"p_context="+$v("pContext")},htmlBuilder:function(){const e=Object.create(w);return e.clear(),e},makeApplicationUrl:function(e={}){let t="f?p=";if(t+=e.appId||n.APP_ID,t+=":",t+=e.pageId||n.APP_PAGE_ID,t+=":",t+=e.session||n.APP_SESSION,t+=":",t+=e.request||$v("pRequest"),t+=":",t+=e.debug||$v("pdebug")||"",t+=":",t+=e.clearCache||"",t+=":",e.itemNames&&(t+=e.itemNames.join(",")),t+=":",e.itemValues)for(let n=0;n<e.itemValues.length;n++)n>0&&(t+=","),t+=encodeURIComponent(e.itemValues[n]);return t+=":",t+=e.printerFriendly||"",t},showSpinner:function(t,n){const r=Q.htmlBuilder(),l=e(window);let i,a,o,s,u,c,p=h({alert:apex.lang.getMessage("APEX.PROCESSING"),spinnerClass:""},n),d=t&&!p.fixed?"string"==typeof t?e(document).find(t):e(t):e("body"),f=d.offset(),g={top:l.scrollTop(),left:l.scrollLeft()};return r.markup("<span").attr("class","u-Processing"+(p.spinnerClass?" "+p.spinnerClass:"")).attr("role","alert").markup(">").markup("<span").attr("class","u-Processing-spinner").markup(">").markup("</span>").markup("<span").attr("class","u-VisuallyHidden").markup(">").content(p.alert).markup("</span>").markup("</span>"),i=e(r.toString()),i.appendTo(d),p.fixed?(o=(l.height()-i.height())/2,a=(l.width()-i.width())/2,i.css({position:"fixed",top:o+"px",left:a+"px"})):(g.bottom=g.top+l.height(),g.right=g.left+l.width(),f.bottom=f.top+d.outerHeight(),f.right=f.left+d.outerWidth(),o=f.top>g.top?f.top:g.top,s=f.bottom<g.bottom?f.bottom:g.bottom,u=(s-o)/2,c=g.top-f.top,c>0&&(u+=c),i.position({my:"center",at:"left+50% top+"+u+"px",of:d,collision:"fit"})),i},delayLinger:function(){var e={};function t(t){var n=e[t];return n||(n={count:0,timer:null},e[t]=n),n}function n(t){delete e[t]}return{start:function(e,n){var r=t(e);r.count+=1,1!==r.count||null!==r.timer||r.showing||(r.start=(new Date).getTime(),r.timer=setTimeout((()=>{r.timer=null,r.showing=!0,n()}),200))},finish:function(e,r){var l,i=t(e);if(0===i.count)throw new Error("delayLinger.finish called before start for scope "+e);l=(new Date).getTime()-i.start,i.count-=1,0===i.count&&(null===i.timer?l<1e3?setTimeout((()=>{0===i.count&&(i.showing=!1,r(),n(e))}),1e3-l):(i.showing=!1,r(),n(e)):(clearTimeout(i.timer),i.timer=null,n(e)))}}}(),setOuterHeight:function(e,t){["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom","marginTop","marginBottom"].forEach((function(n){let r=parseInt(e.css(n),10);isNaN(r)||(t-=r)})),e.height(t)},setOuterWidth:function(e,t){["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight","marginLeft","marginRight"].forEach((function(n){let r=parseInt(e.css(n),10);isNaN(r)||(t-=r)})),e.width(t)},getDateFromISO8601String:function(e){var t,n,r,l=0,i=0,a=0,o=0,s=/^(\d\d\d\d)-(\d\d)-(\d\d)(T(\d\d):(\d\d)(:(\d\d)(.(\d\d\d))?)?Z?)?$/.exec(e);if(!s)throw new Error("Invalid date format");return t=parseInt(s[1],10),n=parseInt(s[2],10)-1,r=parseInt(s[3],10),s[5]&&(l=parseInt(s[5],10),i=parseInt(s[6],10),s[8]&&(a=parseInt(s[8],10),s[10]&&(o=parseInt(s[10],10)))),new Date(Date.UTC(t,n,r,l,i,a,o))},getTopApex:function(){var e,t;function n(e){var t;try{t=e.apex||null}catch(e){t=null}return t}if(null!==f)return f;if(f=n(top),null!==f)return f;for(e=window;null!==(t=n(e))&&e.parent&&e.parent!==e;)f=t,e=e.parent;return f},getScrollbarSize:function(){if(null===d){const t=e("<div>").css({width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}).appendTo("body");d={width:t[0].offsetWidth-t[0].clientWidth,height:t[0].offsetHeight-t[0].clientHeight},t.remove()}return d},invokeAfterPaint:(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,0)}).bind(window),cancelInvokeAfterPaint:(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||function(e){return window.clearTimeout(e)}).bind(window),stripHTML:function(e){for(;p.exec(e);)e=e.replace(p,"");return e},getNestedObject:function(e,t){let n=e;return t.length>0&&t.split(".").forEach((function(e){void 0===n[e]&&(n[e]={}),n=n[e]})),n},checkCondition:function(e,n){let r,l,i,a;if(n=n||{},e.item){if(r=apex.item(e.item),!r.node)return t.warn("No such item: ",e.item),!1;if(l=r.getValue(),n.multiValued&&!g(l)&&""!==l){const e=r.getMultiValueStorage();l=e?Q.toArray(l,e):Q.toArray(l,r.getSeparator())}}return void 0!==e.value&&(i=e.value,n.doSubstitution&&i.match($)&&(i=Y(i,n))),void 0!==e.value2&&(a=e.value2,n.doSubstitution&&a.match($)&&(a=Y(a,n))),!!m[e.op](l,i,a)},watchCondition:function(n,r,l){let i,a,o="watchCond"+x;if(x+=1,r=r||{},n.item){if(i=apex.item(n.item),!i.node)return void t.warn("No such item: ",n.item);e(i.node).on("change."+o,(function(){let e=apex.item(n.item).getValue();e!==a&&(a=e,l(Q.checkCondition(n,r)))}))}return l(Q.checkCondition(n,r)),o},unwatchCondition:function(t,n){let r;if(t.item){if(r=apex.item(t.item),!r.node)return;e(r.node).off("change."+n)}},defineTemplates:function(e){if(g(e))for(let n=0;n<e.length;n++){let r=e[n],l=r.name;if(l&&l.match(C))if(r.template){r.args||(r.args=[]);for(let e=0;e<r.args.length;e++){let n=r.args[e];n.required&&n.default&&(delete n.default,t.warn("defineTemplates default value for required arg removed: "+l)),void 0===n.escape||[G,J,Z,z].includes(n.escape)||(t.warn("defineTemplates invalid escape value removed: "+l),delete n.escape),n.name&&n.name.match(C)||(r.args.splice(e,1),e-=1,t.warn("defineTemplates argument with missing or invalid name removed: "+l))}b.set(l,r)}else t.warn("defineTemplates missing template ignored: "+l);else t.warn("defineTemplates template with invalid name ignored: "+l)}else for(const[n,r]of s(e))n.match(C)?b.set(n,{name:n,args:[],template:r}):t.warn("defineTemplates template with invalid name ignored: "+n)},listTemplates:function(){return[...b.keys()]},getTemplateDef:function(e){return b.get(e)||null},applyTemplate:Y,dataValue:function(e,t){let n,r,l,i,a,s=null,u=[];if(r=E.exec(e),r&&(l=e.substring(0,r.index),a=r[1],i=a.toLowerCase()),t.model&&t.record&&0===u.length){let e=null,n=t.model,r=t.record,l=n.getRecordId(r);l&&(e=n.getRecordMetadata(l)),u.push({model:n,record:r,recMeta:e})}if(u.length>0&&([s,n]=K(e,l,i,null,t,u)),null===s&&([s,n]=U(e,l,i)),null===s)s="";else if("object"==typeof s&&o(s,"v")&&(s=s.v),"string"!=typeof s)if(g(s)){let e=":";n&&(e=n.getSeparator()||e),s=s.join(e)}else s=""+s;return s},extractTemplateDependencies:function(e,t={}){let n,r=[];if((t=h({directives:!0,model:null,extraSubstitutions:{}},t)).directives){let t=null;for(n=L.exec(e);n;){let l=!1,i=n[1].toLowerCase(),a=n[4];apex.model&&"loop"===i&&(t||(t=apex.model.list(!0)),t.includes(a)&&(l=!0)),l||r.push({name:a}),n=L.exec(e)}}for(n=A.exec(e);n;){let t,l,i,a=!1,o=n[2]||n[3];if(t=E.exec(o),i=o,t&&(i=o.substring(0,t.index),l=t[1]),["APEX$ITEM","APEX$ID","APEX$I","APEX$META"].includes(i)&&(a=!0),!a){let e={name:i,subst:o};l&&(e.prop=l),n[5]&&(e.format=n[5]),r.push(e)}n=A.exec(e)}return r},cssDurationToMilliseconds:e=>{let t=parseFloat(e);return isNaN(t)?0:e.includes("ms")?t:1e3*t},equalValue:function(e,t){let n=e,r=t;if(null!==e&&u(e)&&(n=e.v,null!==t&&u(t)&&(r=t.v)),g(n)&&g(r)){if(n.length!==r.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!=r[e])return!1;return!0}return n==r},sanitizeHtml:e=>{if(window.DOMPurify)return window.DOMPurify.sanitize(e,{ADD_ATTR:["target"]});throw new Error("DOMPurify cannot be found.")},setPCTGraphStyles:function(){e("div[data-pct-chart], div[data-ft-chart], div[data-width-chart], div[data-width-fill]").each((function(){const t=e(this),n=t.attr("data-pct-chart"),r=t.attr("data-ft-chart"),l=t.attr("data-width-fill"),i=t.attr("data-width-chart");t.css({"--a-percent-chart-background-color":n,"--a-percent-chart-bar-background-color":r,"inline-size":i||l+"%"})}))}};return Q.escapeHTMLContent=a,Q.hasOwnProperty=o,Q.unescapeHTML=function(e){return null===e?"":e.replace(/&#X2F;/gi,"/").replace(/&#X27;/gi,"'").replace(/&(quot|QUOT);/g,'"').replace(/&(gt|GT);/g,">").replace(/&(lt|LT);/g,"<").replace(/&(amp|AMP);/g,"&")},Q.getTextMessagesFromTemplate=function(e){if(!e)return;return[...[...e.matchAll(D)],...[...e.matchAll(A)].flatMap((e=>{const t=e[2]||e[3];return t.startsWith("APP_TEXT$")?(e[1]=t.substr(9),[e]):[]}))].map((function(e){let t=H(e[1]);if(t)return t.message=e[0],t})).filter((e=>e))},Q}(apex.jQuery,apex.debug,apex.env);