/*!
 * Copyright (c) 2020, 2024, Oracle and/or its affiliates.
 */
!function(e,t,o,i,a,r){"use strict";const l="html",n="markdown",d="intermediate",c="full",s="multiline",u="rich-text",m="escaped",k="plain-text",g=()=>{const e=new marked.Marked;return e.use({tokenizer:{autolink:()=>null,url:()=>null},renderer:{checkbox(...e){return Object.getPrototypeOf(this).checkbox.call(this,...e).trimRight()},code(...e){return Object.getPrototypeOf(this).code.call(this,...e).replace("\n</code>","</code>")}}}),t=>o.sanitizeHtml(e.parse(t,{gfm:!0,breaks:!0,tables:!0}))},p=()=>{const e=new TurndownService({codeBlockStyle:"fenced",hr:"---",headingStyle:"atx"});return t=>e.turndown(t)};class b{constructor(e,t,o){this.htmlDataProcessor=new ckeditor5.HtmlDataProcessor(e),this.markdown2html=t,this.html2markdown=o}toView(e){const t=this.markdown2html(e);return this.htmlDataProcessor.toView(t)}toData(e){const t=this.htmlDataProcessor.toData(e);return this.html2markdown(t)}useFillerType(){}keepHtml(){}}class h extends ckeditor5.Plugin{constructor(e){super(e);let{markdown2html:t,html2markdown:o}=e.config.get("markdown");e.data.processor=new b(e.data.viewDocument,t,o)}static get pluginName(){return"Markdown"}}window.CKEditor5=ckeditor5,window.ClassicEditor={...ckeditor5.ClassicEditor,libraryClasses:{Plugin:ckeditor5.Plugin,ButtonView:ckeditor5.ButtonView,Model:ckeditor5.Model,Collection:ckeditor5.Collection,dropdownUtils:ckeditor5,clipboard:ckeditor5.Clipboard,language:ckeditor5.TextPartLanguage},extraPlugins:{Markdown:h,SimpleUploadAdapter:ckeditor5.SimpleUploadAdapter,ImageUpload:ckeditor5.ImageUpload,CKFinder:ckeditor5.CKFinder,CKFinderUploadAdapter:ckeditor5.UploadAdapter,RestrictedEditingMode:ckeditor5.RestrictedEditingMode,Title:ckeditor5.Title,MediaEmbed:ckeditor5.MediaEmbed,MediaEmbedToolbar:ckeditor5.MediaEmbedToolbar,PendingActions:ckeditor5.PendingActions,ListStyle:ckeditor5.ListStyle}},i.rte=function(i,b,f){let y=r.extend(!0,{mode:l,label:null,toolbar:d,minHeight:180,maxHeight:null,executeOnInitialization:null,automaticStyleWrap:!0,displayValueMode:k,editorOptions:{language:"en",plugins:[ckeditor5.Alignment,ckeditor5.AutoImage,ckeditor5.Image,ckeditor5.ImageCaption,ckeditor5.ImageInsert,...b.mode===l?[ckeditor5.ImageResize]:[],ckeditor5.ImageStyle,ckeditor5.ImageTextAlternative,ckeditor5.ImageToolbar,ckeditor5.Autoformat,ckeditor5.AutoLink,ckeditor5.Autosave,ckeditor5.BlockQuote,ckeditor5.Bold,ckeditor5.Code,ckeditor5.Italic,ckeditor5.Strikethrough,ckeditor5.Subscript,ckeditor5.Superscript,ckeditor5.Underline,ckeditor5.CodeBlock,ckeditor5.Essentials,ckeditor5.Font,ckeditor5.Heading,ckeditor5.Highlight,ckeditor5.HorizontalLine,...b.mode===l?[ckeditor5.HtmlEmbed]:[],...b.allowCustomHtml?[ckeditor5.GeneralHtmlSupport,ckeditor5.HtmlComment]:[],ckeditor5.Indent,ckeditor5.IndentBlock,ckeditor5.Link,ckeditor5.LinkImage,ckeditor5.List,...b.mode===l&&b.toolbar===c?[ckeditor5.ListProperties]:[],ckeditor5.TodoList,...b.mode===n?[h]:[],ckeditor5.Mention,ckeditor5.PageBreak,ckeditor5.Paragraph,ckeditor5.PasteFromOffice,ckeditor5.RemoveFormat,...b.allowCustomHtml?[ckeditor5.SourceEditing]:[],ckeditor5.SpecialCharacters,ckeditor5.SpecialCharactersArrows,ckeditor5.SpecialCharactersCurrency,ckeditor5.SpecialCharactersEssentials,ckeditor5.SpecialCharactersLatin,ckeditor5.SpecialCharactersMathematical,ckeditor5.SpecialCharactersText,ckeditor5.Table,ckeditor5.TableCellProperties,ckeditor5.TableProperties,ckeditor5.TableToolbar,ckeditor5.TableCaption,ckeditor5.TextTransformation,ckeditor5.WordCount],extraPlugins:[],removePlugins:[],toolbar:(()=>{let e=[];return b.mode===l?"basic"===b.toolbar?e=["bold","italic","|","bulletedList","numberedList","|","undo","redo"]:b.toolbar===d?e=["heading","|","bold","italic","underline","strikethrough",...b.toolbarStyle===s?["-"]:["|"],"link","bulletedList","numberedList","|","blockQuote","insertTable","|","undo","redo"]:b.toolbar===c&&(e=["heading","|","bold","italic","underline","strikethrough","subScript","superScript","code","removeFormat",...b.toolbarStyle===s?["-"]:["|"],"fontSize","fontFamily","fontColor","fontBackgroundColor","highlight","|","alignment","indent","outdent","|","bulletedList","numberedList","todoList",...b.toolbarStyle===s?["-"]:["|"],"specialCharacters","link","blockQuote","pageBreak","horizontalLine","insertTable","codeBlock","|","undo","redo","|","htmlEmbed",...b.allowCustomHtml?["sourceEditing"]:[]]):b.mode===n&&(e=["heading","|","bold","italic","code","|","link","bulletedList","numberedList","|","blockQuote","codeBlock","|","undo","redo"]),e})(),image:b.mode===l?{styles:["full","side","alignLeft","alignCenter","alignRight","alignBlockLeft","alignBlockRight"],toolbar:["imageStyle:inline","imageStyle:wrapText","imageStyle:breakText","|","toggleImageCaption","imageTextAlternative"]}:{styles:[],toolbar:["imageTextAlternative"]},codeBlock:{languages:[{language:"plaintext",label:"Plaintext"},{language:"html",label:"HTML"},{language:"css",label:"CSS"},{language:"js",label:"JavaScript"},{language:"sql",label:"SQL"}]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableCellProperties","tableProperties"]},fontSize:{options:["tiny","small","default","big","huge"],supportAllValues:!1},...b.mode===n?{markdown:{markdown2html:g(),html2markdown:p()}}:{},htmlEmbed:b.mode===l?{showPreviews:!0,sanitizeHtml:e=>{const t=o.sanitizeHtml(e);return{html:t,hasChanged:e!==t}}}:void 0,htmlSupport:b.allowCustomHtml?{allow:[{name:/.*/,attributes:!0,classes:!0,styles:!0}]}:void 0}},b);if("function"==typeof f){const e=f(y);e&&(y=e)}Array.isArray(y.editorOptions.toolbar)&&(y.editorOptions.toolbar={items:[...y.editorOptions.toolbar],removeItems:[],shouldNotGroupWhenFull:y.toolbarStyle===s,enableHTMLEmbed:b.mode===l}),r(i).each((function(){let i,d,c,s,g=r(this),p=this.id+"_WIDGET",b=this.id,h=g.val();g.hide().parent().append(`<div id="${o.escapeHTMLAttr(p)}"></div>`),c=function(){d.focus()},i={item_type:"RICH_TEXT_EDITOR",delayLoading:!0,enable:function(){d.disableReadOnlyMode("apex-readonly")},disable:function(){d.enableReadOnlyMode("apex-readonly")},isDisabled:function(){return d.isReadOnly},setValue:function(e){d.setData(e??"")},getValue:function(){let e=d.getData(),t='<div class="ck-content">';return y.mode===l&&y.automaticStyleWrap&&/( class="|<blockquote|<code|<hr|<pre)/.test(e)&&!e.startsWith(t)&&(e=t+e+"</div>"),e},displayValueFor:function(e){if(y.mode===l){if(y.displayValueMode===u)return o.sanitizeHtml(e);if(y.displayValueMode===m)return o.escapeHTML(e);if(y.displayValueMode===k)return o.stripHTML(e.replace(/<p>|<p\/>|<br>|<br\/>|<br \/>|<BR>|\n|&nbsp;/g," ")).replace(/\s\s+/g," ");a.error("Illegal value for displayValueMode: "+y.displayValueMode)}else if(y.mode===n){if(y.displayValueMode===u)return`<div class="ck-content">${y.editorOptions.markdown.markdown2html(e)}</div>`;if(y.displayValueMode===m)return o.escapeHTML(e);if(y.displayValueMode===k)return o.stripHTML(y.editorOptions.markdown.markdown2html(e).replace(/<p>|<p\/>|<br>|<br\/>|<br \/>|<BR>|\n|&nbsp;/g," ")).replace(/\s\s+/g," ");a.error("Illegal value for displayValueMode: "+y.displayValueMode)}},setFocusTo:function(){return{focus:c}},isChanged:function(){return h!==this.getValue()},getEditor:function(){return d},getValidity:function(){return g.val(this.getValue()),g[0].validity||{valid:!0}},getPopupSelector:function(){return".ck.ck-balloon-panel"}},s=e.create(b,i),y.editorOptions.initialData=h,ckeditor5.ClassicEditor.create(document.getElementById(p),y.editorOptions).then((function(e){let o;d=e,d.editing.view.change((e=>{e.setStyle("min-height",(y.minHeight||150)+"px",d.editing.view.document.getRoot()),y.maxHeight&&e.setStyle("max-height",y.maxHeight+"px",d.editing.view.document.getRoot())})),d.editing.view.document.on("change:isFocused",(function(e,t,i){i?o=d.getData():d.getData()!==o&&g.trigger("change")}));const a=t.formatMessage("APEX.RICH_TEXT_EDITOR.ACCESSIBLE_LABEL",y.label||"");r("label.ck.ck-label.ck-voice-label",d.ui.view.element).text(a),y.executeOnInitialization&&y.executeOnInitialization(d),h=i.getValue(),s.resolve()})).catch((function(e){a.error(e)})),g.on("focus",c)}))},r.ui.dialog&&r.widget("ui.dialog",r.ui.dialog,{_allowInteraction:function(e){return r(e.target).closest(".ck").length>0||this._super(e)}})}(apex.item,apex.lang,apex.util,apex.widget,apex.debug,apex.jQuery);