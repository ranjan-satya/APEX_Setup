define(['exports', 'preact/jsx-runtime', 'preact/compat', 'preact/hooks', './LayerHost-eab40731', 'css!./DragAndDropStyles.styles.css', './useReorderableItem-d977f935', 'css!./ReorderableItemStyles.styles.css', './HiddenAccessible-037ef42d', './collectionUtils-6740111c', './classNames-08d99695', './UNSAFE_ListView/themes/ListViewStyles.css', './mergeProps-bcfa6a92', './List-5958c802', './Menu-51409b28', './MenuItem-644f8619', 'preact', './useTooltipControlled-abf886f2', 'css!./IconStyle.styles.css', './SelectMenuGroupContext-67f24a8f', './logger-0f873e29', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./MenuSeparatorStyles.styles.css', 'module', './UNSAFE_Menu/themes/redwood/MenuSeparatorVariants.css', './useItemAction-66d976c4', './useContextMenuGesture-06cf28ca'], (function(e,r,t,o,n,s,l,c,i,a,u,d,f,y,g,m,p,x,R,h,C,S,I,b,M,K,v){"use strict";const E=(e,r)=>{if(null!=e){const t=e.querySelectorAll("[role='row']");if(t.length>r)return a.getKey(t[r])}return null};function P(e,r){const t=Math.abs(null==r?e.scrollTop:r),o={y:t,key:void 0,offsetY:void 0};let n=0;const s=e.querySelectorAll("[role='row']");if(s.length>0&&0===t)return o.key=E(e,0),o.offsetY=0,o;for(let r=0;r<s.length;r++){const l=s[r].getBoundingClientRect().height;if(n+=l,t<n){o.key=E(e,r),o.offsetY=l+t-n;break}}return o}function T(e,r){const t=function(e,r){if(null!=r){let t,o=!1;if(null!=r.key?(o=!0,t=r.key):null!=r.offsetY&&null==r.y&&(o=!0,t=P(e).key),o){if(null!=t){let o=0;const n=e.querySelectorAll("[role ='row']");for(let e=0;e<n.length;e++){if(t===a.getKey(n[e]))return o+(null!=r.offsetY?r.offsetY:0);o+=n[e].getBoundingClientRect().height}}}else if(null!=r.y)return r.y}return}(e,r);e.scrollTop=null!=t?t:0}const L=t.memo((function({currentKey:e,children:t,dragKey:n,setDragKey:s,onReorder:c,rootRef:i,itemKey:f}){const y=o.useRef(null),g={itemOverlayFront:d.styles.reorderableItemOverlayFront,itemOverlayRear:d.styles.reorderableItemOverlayRear,itemDragger:d.styles.reorderableItemDragger},m=o.useCallback((e=>{e.dataTransfer?.setData("text/listview-items-key",JSON.stringify(f))}),[f]),{rootProps:p,isDragged:x,overlayZoneBeforeProps:R,overlayZoneAfterProps:h}=l.useReorderableItem({currentKey:e,isDisabled:!c,draggable:!!c,dragKey:n,setDragKey:s,onReorder:c,rootRef:i,ref:y,getItem:()=>y?.current?.closest(a.ITEM_SELECTOR),setTransferData:m,itemStyles:g,itemSelector:a.ITEM_SELECTOR,isVertical:!0}),C=u.classNames([p?.class,d.styles.reorderableItemDnd]);return r.jsxs("div",{...p,draggable:!1,class:C,children:[t,!x&&n&&r.jsxs(r.Fragment,{children:[r.jsx("div",{...R}),r.jsx("div",{...h})]})]})}),((e,r)=>!(!e||!r)&&(e?.children===r?.children&&e?.currentKey===r?.currentKey&&e?.dragKey===r?.dragKey)));function w({contextMenuConfig:e,contextMenuContext:t,...o}){const n=e.accessibleLabel;return r.jsx(r.Fragment,{children:r.jsx(g.Menu,{...o,...n&&{"aria-label":n},children:o.isOpen&&e.itemsRenderer(t)})})}const O={mouse:{initialFocus:"menu",placement:"bottom-start",offsetValue:0},keyboard:{initialFocus:"firstItem",placement:"bottom-start",offsetValue:0},touch:{initialFocus:"menu",placement:"end",offsetValue:40}},k={isOpen:!1,initialFocus:"menu",placement:"bottom-start",offsetValue:0,anchorRef:{current:null}},D=t.forwardRef(((e,t)=>{const{currentKey:n,contextMenuConfig:s,onCurrentKeyChange:c}=e,u=o.useRef(),d=o.useRef(null),g=e.data?e.data.map((r=>({data:r,metadata:{key:e.getRowKey(r)}}))):null,m=e.onLoadMore?e.onLoadMore:()=>{},p=g?{offset:0,data:g,sizePrecision:e.hasMore?"atLeast":"exact",totalSize:g.length}:null;o.useImperativeHandle(t,(()=>({getScrollPosition:()=>d.current?P(d.current):{y:0}}))),o.useLayoutEffect((()=>{d.current&&u.current!==e.scrollPositionOverride&&(T(d.current,e.scrollPositionOverride),u.current=e.scrollPositionOverride)}),[e.scrollPositionOverride]);const x=null!=e.onReorder,{reorderProps:R,reorderItemProps:h,reorderContext:C,reorderInstructionsId:S,reorderInstructions:I}=(({currentKey:e,onReorder:r,rootRef:t,viewportConfig:n})=>{const s=null!=r,[c,i]=o.useState(void 0),{reorderProps:u,reorderContext:d,reorderInstructionsId:g,reorderInstructions:m}=l.useReorderable({onReorder:r,rootRef:t,itemSelector:a.ITEM_SELECTOR,isDisabled:!s,columns:1}),p=o.useRef(!1);return o.useEffect((()=>{if(s&&p.current){const r=t.current,o=a.findElementByKey(r,e,a.ITEM_SELECTOR);if(o){const e=n?.scroller()||r;y.scrollToVisible(o,e,0),p.current=!1}}})),s?{reorderProps:f.mergeProps({onKeyDown:e=>{s&&("ArrowUp"===e.key||"ArrowDown"===e.key)&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&(p.current=!0,u.onKeyDown?.(e))},onDragOver:e=>{void 0!==c&&(p.current=!1,a.dragToScroll(e,void 0!==c,t.current))}}),reorderItemProps:{currentKey:e,dragKey:c,setDragKey:i,onReorder:r,rootRef:t},reorderContext:d,reorderInstructionsId:g,reorderInstructions:m}:{reorderProps:u,reorderContext:d,reorderInstructionsId:g,reorderInstructions:m}})({currentKey:e.currentKey,onReorder:e.onReorder,rootRef:d,viewportConfig:e.viewportConfig}),{triggerProps:b,menuProps:M,contextMenuContext:E}=((e,r,t,n,s)=>{const[l,c]=o.useState(),[i,u]=o.useState(k),{triggerProps:d}=v.useContextMenuGesture((({gesture:r,anchor:o,target:l})=>{let i=o;if("keyboard"===r){i=a.findElementByKey(s.current,t,a.ITEM_SELECTOR)||o;const r=K.findItemContext(t,e);c(r)}else{const r=a.keyExtractor(l,a.ITEM_SELECTOR),t=K.findItemContext(r,e);c(t),n?.({value:r})}u({...O[r],anchorRef:{current:i},isOpen:!0})}),{isDisabled:!r}),f=o.useCallback((e=>{"dismissed"!==e.reason&&"itemAction"!==e.reason||s.current?.focus({preventScroll:!0}),u({...k})}),[s]);return{menuProps:{...i,onClose:f},onClose:f,contextMenuContext:l,triggerProps:d}})(p,s,n,c,d);return x&&h?r.jsxs(r.Fragment,{children:[r.jsxs(l.ReorderableContext.Provider,{value:C,children:[r.jsx(y.List,{...e,contextMenuTriggerProps:b,reorderProps:R,onLoadRange:m,scrollerRef:d,data:p,children:t=>r.jsx(L,{...h,itemKey:t.metadata.key,children:e.children(t)})}),r.jsx("span",{id:S,children:r.jsx(i.HiddenAccessible,{children:I})})]}),s&&r.jsx(w,{...M,contextMenuConfig:s,contextMenuContext:E})]}):r.jsxs(r.Fragment,{children:[r.jsx(y.List,{...e,onLoadRange:m,scrollerRef:d,data:p,contextMenuTriggerProps:b,children:e.children}),s&&r.jsx(w,{...M,contextMenuConfig:s,contextMenuContext:E})]})}));e.ListView=D}));
//# sourceMappingURL=ListView-27d10b67.js.map
