define(['exports', 'preact/jsx-runtime', 'preact/compat', 'preact/hooks', './Calendar-d1c38937', './InputDateMask-b7a27faa', './HiddenAccessible-037ef42d', './IconButton-1b328b69', './clientHints-030d25aa', './FormFieldContext-3c44aaaa', './logger-0f873e29', './TabbableModeContext-a9c97640', './useTranslationBundle-6ef0dab6', 'css!./UserAssistanceStyles.styles.css', 'module', './UNSAFE_UserAssistance/themes/redwood/UserAssistanceVariants.css', './InlineUserAssistance-f4d1fa1b', './Flex-1f27b601', 'css!./MessageBannerStyles.styles.css', 'module', './UNSAFE_MessageBanner/themes/redwood/MessageBannerVariants.css', 'preact', './useTooltipControlled-abf886f2', 'css!./IconStyle.styles.css', 'css!./MessageStyles.styles.css', './MessageFormattingUtils-2e19d8de', './LayerHost-eab40731', './TransitionGroup-3b9d81b6', './MessagesContext-602a69a2', 'css!./HiddenAccessibleStyles.styles.css', 'css!./ComponentMessageStyles.styles.css', 'module', './UNSAFE_ComponentMessage/themes/redwood/ComponentMessageVariants.css', './Popup-249d77c3', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./LabelStyles.styles.css', 'module', './UNSAFE_Label/themes/redwood/LabelVariants.css', './InputGroupContext-372087af', 'module', './UNSAFE_Popup/themes/redwood/PopupVariants.css', './UNSAFE_InputDatePicker/themes/InputDatePickerDropdownStyles.css', './Sheet-6447f399', './UNSAFE_DatePicker/themes/DatePickerContract.css', './DatePicker-3996fc76', './SectionedContent-655a773a', './stringUtils-0ae982c2', './FormContext-5130e198', './useFormContext-30acdd33', './useId-c9578d26', './getFormatParse-b7ff0219', './maskUtils-86dd685a', './calendarDateUtils-1f56aaf5'], (function(e,t,s,a,n,r,o,i,l,d,c,u,m,p,h,f,y,b,C,D,S,x,A,k,v,g,F,V,I,T,P,R,M,U,w,j,_,B,H,E,N,L,O,W,Y,Z,z,G,q,J,K,Q,X){"use strict";const $=({anchorRef:e,assistiveText:s,dayFormatter:n,daysOutsideMonth:r,helpSourceLink:o,helpSourceText:i,isDisabled:l,isOpen:c,isReadonly:u,label:p,onClose:h,onCommit:f,max:b,messages:C,min:D,monthAndYearPicker:S,testId:x,todayButton:A,todayTimeZone:k,userAssistanceDensity:v,value:g})=>{const[F,V]=a.useState(!1),[I,T]=a.useState(c),P=a.useCallback((e=>{V(e.placement.startsWith("top"))}),[]);I!==c&&(T(c),c||V(!1));const R=ee(),{datePicker_label:M}=m.useTranslationBundle("@oracle/oraclejet-preact"),U=M(),w=t.jsx(Y.DatePicker,{dayFormatter:n,daysOutsideMonth:r,onCommit:f,max:b,min:D,maxWidth:R?"100%":void 0,width:R?"100%":W.datePickerPropVars.maxWidth,monthAndYearPicker:S,testId:x,todayTimeZone:k,todayButton:A,value:g}),j=!c||F&&!R||l||u||!(s||o||C&&C.length>0)||"efficient"!==v&&"reflow"!==v?void 0:t.jsx(d.FormFieldContext.Provider,{value:{isFocused:!0},children:t.jsx("div",{class:L.userAssistanceStyles,children:t.jsx(y.InlineUserAssistance,{assistiveText:s,fieldLabel:p,helpSourceLink:o,helpSourceText:i,messages:C,userAssistanceDensity:v})})}),_=x?x+(R?"_sheet":"_dropdown"):void 0,B=t.jsx("div",{class:L.dropdownStyles,children:t.jsx(Z.SectionedContent,{"aria-label":U,footer:j,hasFocusTrap:!0,main:w,role:"dialog",testId:_})});return R?t.jsx(O.Sheet,{initialFocus:"firstFocusable",isOpen:c,onClose:h,children:t.jsx(Z.SectionedContent,{"aria-label":U,footer:j,hasFocusTrap:!0,main:w,role:"dialog",testId:_})}):t.jsx(Z.StickyPositioningDropdown,{anchorRef:e,initialFocus:"firstFocusable",isOpen:c,onClose:h,onPosition:P,sizeOptions:{isMaxWidthAdjusted:!1,isMaxHeightAdjusted:!0},children:B})},ee=()=>"phone"===l.getClientHints().deviceType,te=e=>e&&X.isCompleteCalendarDate(e)?e:void 0,se=(e,t)=>{switch(t.type){case"dateChanged":return{...e,dateValue:t.data,completeDateValue:te(t.data)};case"dateSelected":return{...e,dateValue:t.data,completeDateValue:t.data};case"reset":return{completeDateValue:te(t.data),dateValue:t.data};default:return e}},ae=({onCommit:e,onInput:t,value:s})=>{const[n,r]=a.useState(!1),o=a.useRef(null),i=a.useRef(null),l=a.useRef(!1),d=a.useRef(),c=a.useRef(!1),u=a.useRef(),m=a.useRef(s),p=a.useRef(s),h=a.useRef(s),f=a.useRef(!1),{state:y,dispatch:b}=(({value:e})=>{const[t,s]=a.useReducer(se,{completeDateValue:te(e),dateValue:e});return{state:t,dispatch:s}})({value:s});Q.calendarDatesAreDifferent(h.current,s)&&(h.current=s,Q.calendarDatesAreDifferent(s,y.dateValue)&&(b({type:"reset",data:s}),p.current=s,m.current=s)),a.useEffect((()=>{Q.calendarDatesAreDifferent(y.dateValue,p.current)&&(t({previousValue:p.current,value:y.dateValue}),p.current=y.dateValue),f.current&&Q.calendarDatesAreDifferent(y.dateValue,m.current)&&(e?.({previousValue:m.current,value:y.dateValue}),m.current=y.dateValue,f.current=!1)}),[e,t,y.dateValue]);const C=a.useCallback((e=>{b({type:"dateChanged",data:e.value})}),[b]),D=a.useCallback((()=>{Q.calendarDatesAreDifferent(m.current,y.dateValue)&&(e?.({value:y.dateValue,previousValue:m.current}),m.current=y.dateValue)}),[e,y.dateValue]),S=a.useCallback((()=>{l.current||c.current||r((e=>!e)),l.current=!1,c.current=!1}),[]),x=a.useCallback((e=>{"outsideMousedown"===e.reason?(l.current=!0,clearTimeout(d.current),d.current=setTimeout((()=>{l.current=!1}),200)):"dismissed"!==e.reason&&"keyboardDismissed"!==e.reason||o.current?.focus(),r(!1)}),[]);return{calendarIconActionHandler:S,datePickerCommitHandler:a.useCallback((e=>{o.current?.focus(),c.current=!0,clearTimeout(u.current),u.current=setTimeout((()=>{c.current=!1}),500),f.current=!0,b({type:"dateSelected",data:e.value}),r(!1)}),[b]),dropdownCloseHandler:x,completeDateValue:y.completeDateValue,dateValue:y.dateValue,iconRef:o,isOpen:n,maskCommitHandler:D,maskInputHandler:C,maskRef:i}},ne=s.forwardRef((({"aria-describedby":e,assistiveText:s,dayFormatter:l,daysOutsideMonth:d,helpSourceLink:c,helpSourceText:u,isDisabled:p,isReadonly:h,label:f,max:y,messages:b,min:C,monthAndYearPicker:D,todayTimeZone:S,todayButton:x,value:A,onCommit:k,onInput:v,testId:g,userAssistanceDensity:F,...V},I)=>{const{calendarIconActionHandler:T,datePickerCommitHandler:P,completeDateValue:R,dateValue:M,dropdownCloseHandler:U,iconRef:w,isOpen:j,maskCommitHandler:_,maskInputHandler:B,maskRef:H}=ae({onCommit:k,onInput:v,value:A}),E=a.useRef(null),{inputDatePicker_selectDate:N,inputDatePicker_instruction:L}=m.useTranslationBundle("@oracle/oraclejet-preact"),O=N(),{userAssistanceDensity:W}=q.useFormContext(),Y=F??W;a.useImperativeHandle(I,(()=>({focus:()=>{H.current?.focus()},blur:()=>{H.current?.blur()}})));const Z=J.useId(),G=L(),K=p||h?void 0:t.jsx(o.HiddenAccessible,{id:Z,isHidden:!0,children:G}),Q=p||h?e:z.merge([e,Z]),X=t.jsx(i.IconButton,{"aria-haspopup":"dialog","aria-label":O,isDisabled:p,ref:w,size:"sm",testId:g?g+"_calendarIcon":void 0,variant:"ghost",onAction:T,children:t.jsx(n.SvgCalendar,{})}),ee=j;return t.jsxs(t.Fragment,{children:[t.jsx(r.InputDateMaskContext.Provider,{value:{isDropdownOpen:j,isInputDatePickerParent:!0},children:t.jsx(r.InputDateMask,{"aria-describedby":Q,assistiveText:s,endContent:X,helpSourceLink:c,helpSourceText:u,isDisabled:p,isReadonly:h,label:f,onCommit:_,onInput:B,mainFieldRef:E,messages:b,testId:g,ref:H,userAssistanceDensity:F,value:M,...V})}),K,ee&&t.jsx($,{anchorRef:E,assistiveText:s,dayFormatter:l,daysOutsideMonth:d,helpSourceLink:c,helpSourceText:u,isDisabled:p,isReadonly:h,isOpen:j,label:f,onClose:U,onCommit:P,max:y,messages:b,min:C,monthAndYearPicker:D,testId:g?g+"_datePicker":void 0,todayTimeZone:S,todayButton:x,userAssistanceDensity:Y,value:R})]})}));e.InputDatePicker=ne}));
//# sourceMappingURL=InputDatePicker-0012b304.js.map
