define(['exports', 'preact/jsx-runtime', 'preact/hooks', './Layer-3cc44164', 'preact/compat', './LayerHost-eab40731', './Modal-8c095bea', './FocusTrap-eb3989cb', './tabbableUtils-62c44f56', './positionUtils-3193ab54', './clientHints-030d25aa', './useOutsideClick-4519a64e', './useAnimation-5bd3adfc', './useUser-6dd85af9', './useTestId-82cf22a4', './useSwipe-9600cd2e', './useComponentTheme-5aa41a8f', './colors-86fa94ea', './mergeInterpolations-9ede4cf7', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupTheme', './classNames-08d99695', './UNSAFE_Layer/themes/LayerStyles.css', 'css!./LayerStyles.styles.css', './useThemeInterpolations-41cbd433', './useColorScheme-711c1e4b', './useScale-e6b83382', './theme-a8f3d819', './Theme-d945adae', 'preact', './Common/themes/redwood/theme', './Common/themes/themeContract.css', './UNSAFE_Modal/themes/ModalStyles.css', 'css!./ModalStyles.styles.css', './vanilla-extract-recipes-createRuntimeFn.esm-d881c69a', './FocusTracker-545d5904', './PRIVATE_FocusTracker/themes/FocusTrackerStyles.css', 'css!./FocusTrackerStyles.styles.css', './head-9cb1a3da', './_arity-5a5f5f71', './_curry3-83878f86', './_curry1-df649359', './_curry2-86c52b86', './_isArray-32602db6', './_isString-d0ada3cb', './arrayUtils-6ee96a35', './logger-0f873e29', './mergeDeepWithKey-aaab9019', './_isObject-42bafc94', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupBaseTheme.css', 'module', './UNSAFE_DrawerPopup/themes/DrawerPopupStyles.css', 'css!./DrawerPopupStyles.styles.css', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupVariants.css', 'css!./DrawerPopupVariants.styles.css'], (function(e,t,s,r,a,o,n,i,l,c,u,d,p,m,f,b,h,y,w,g,v,S,P,D,E,F,T,k,C,_,A,O,x,U,M,R,I,N,j,L,H,W,X,Y,z,B,K,V,$,q,G,J,Q,Z){"use strict";const ee="0px",te=250;e.DrawerPopup=({children:e,isOpen:a=!1,autoFocusRef:o,placement:v="start",modality:S="modal",onClose:P,onTransitionEnd:D,"aria-label":E,"aria-labelledby":F,"aria-describedby":T,testId:k,...C})=>{const[_,A]=s.useState(a?"initial":"unmounted"),[O,x]=s.useState("hidden"),[U,M]=s.useState(!a),[R,I]=s.useState("overlay"),N=s.useRef(null),j=s.useRef(null),L="bottom"===v,H={opening:()=>L?{from:{translateY:z()},to:{translateY:ee},options:{duration:te}}:{from:{translateX:Y()},to:{translateX:ee},options:{duration:te}},closing:()=>L?{from:{translateY:ee},to:{translateY:z()},options:{duration:te}}:{from:{translateX:ee},to:{translateX:Y()},options:{duration:te}}},W=f.useTestId(k),{direction:X}=m.useUser(),Y=()=>{return`${"right"===c.normalizePosition(v,X)?"":"-"}${e=N.current,Math.round(e.getBoundingClientRect().width)}px`;var e},z=()=>{return`${e=N.current,Math.round(e.offsetHeight)}px`;var e},{nodeRef:B}=p.useAnimation(_,{animationStates:H,isAnimatedOnMount:!0,onAnimationEnd:()=>{"opening"===_?((()=>{const e=l.getAutofocusFocusables(N.current);e.length>0?l.focusOn(e[0]):l.focusWithin(N.current)})(),D?.(!0)):a||(B(null),x("hidden"),A("unmounted"),D?.(!1))}});s.useEffect((()=>{if("unmounted"!==_||a){if("unmounted"!==_||!a)return"initial"===_&&a?(B(N.current),M(!1),void A("opening")):void("opening"===_&&a?x("visible"):a||(M(!0),A("closing")));A("initial")}}),[a,_,B]),s.useEffect((()=>{if("modeless"===S&&("opening"===_&&(j.current=l.getActiveElement(),j.current?.addEventListener("keydown",K)),"closing"===_))return()=>{j.current?.removeEventListener("keydown",K)}}),[S,_]);const K=e=>{j.current===l.getActiveElement()&&"F6"===e.code&&(e.preventDefault(),e.stopPropagation(),l.focusWithin(N.current))},V=s.useCallback((e=>{const t=j.current;switch(e.code){case"Escape":P?.({reason:"escapeKey"});break;case"F6":if("modeless"===S){e.preventDefault(),e.stopPropagation(),t&&l.focusOn(t);break}}}),[P]),$=s.useCallback((()=>{P?.({reason:"outsideClick"})}),[P]);d.useOutsideClick({isDisabled:U,ref:N,handler:$});const q=u.getClientHints(),G=s.useCallback((()=>"ios"===q.platform?document.documentElement.clientWidth:window.innerWidth),[q.platform]),J=s.useCallback((()=>{const e=G();"overlay"===R&&e<600&&I("fullOverlay"),"fullOverlay"===R&&e>600&&I("overlay")}),[G,R]);s.useEffect((()=>{if(N.current&&"opening"===_){const e=new ResizeObserver((()=>{J()}));return e.observe(document.body),()=>{e.unobserve(document.body)}}}),[_,J]);const Q=s.useCallback((e=>{const t=e.direction;("ltr"===X&&"start"===v&&"left"===t||"end"===v&&"right"===t||"rtl"===X&&"start"===v&&"right"===t||"end"===v&&"left"===t||"bottom"===v&&"down"===t)&&P?.({reason:"swipe"})}),[X,v,P]),{swipeProps:Z}=b.useSwipe(Q,{threshold:50,maximumTime:750,tolerance:40}),{classes:se}=h.useComponentTheme(g.DrawerPopupRedwoodTheme,{placement:L?v:"rtl"===X?"start"===v?"right":"left":"start"===v?"left":"right",visibility:O,displayModeHorizontal:["start","end"].indexOf(v)>-1?R:void 0}),re=[...Object.values(y.colorInterpolations)],ae=w.mergeInterpolations(re),{...oe}=ae(C),ne=()=>t.jsx("div",{ref:N,className:se,style:oe,tabIndex:-1,role:"dialog",onKeyDown:V,"aria-label":E,"aria-labelledby":F,"aria-describedby":T,...Z,...W,children:t.jsx(i.FocusTrap,{autoFocusRef:o,children:e})}),ie="unmounted"!==_;return ie?"modal"===S?t.jsx(n.Modal,{isOpen:ie,children:ne()}):t.jsx(r.Layer,{children:ne()}):null},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=UNSAFE_DrawerPopup.js.map
