{"version":3,"file":"OverflowTabBarItem-8f35961d.js","sources":["../../src/UNSAFE_RedwoodIcons/OverflowH/OverflowH.tsx","../../src/UNSAFE_TabBarCommon/OverflowTabBarItem.tsx"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n// DO NOT MODIFY THIS FILE MANUALLY!\n// This file is automatically generated based on the corresponding SVG image in\n// the packages/oraclejet-preact/resources/icons folder.\nimport { ComponentProps } from 'preact';\nimport { Icon } from '../../UNSAFE_Icon';\ntype Props = Omit<ComponentProps<typeof Icon>, 'viewBox'>;\nconst SvgOverflowH = (props: Props) => (\n  <Icon viewBox=\"0 0 24 24\" {...props}>\n    <g fill=\"none\">\n      <path\n        d=\"M6 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm8 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm8 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0z\"\n        fill=\"currentcolor\"\n      />\n    </g>\n  </Icon>\n);\nexport { SvgOverflowH as OverflowH };\n","import { ComponentChild, ComponentProps, createRef } from 'preact';\nimport { useCallback, useRef } from 'preact/hooks';\nimport type { BundleType } from '../resources/nls/bundle';\nimport { useTranslationBundle } from '../hooks/UNSAFE_useTranslationBundle';\nimport { getClientHints } from '../utils/PRIVATE_clientHints';\nimport { mergeInterpolations } from '../utils/UNSAFE_mergeInterpolations';\nimport { flexitemInterpolations } from '../utils/UNSAFE_interpolations/flexitem';\nimport type { FlexitemProps } from '../utils/UNSAFE_interpolations/flexitem';\nimport { classNames } from '../utils/UNSAFE_classNames';\nimport {\n  NavigationListItem,\n  NavigationList,\n  RemovableNavigationListItem,\n  FocusableHandle\n} from '../UNSAFE_NavigationList';\nimport { OverflowH } from '../UNSAFE_RedwoodIcons/OverflowH';\nimport { useTabBarContext } from './useTabBarContext';\nimport { Dropdown } from '../UNSAFE_Dropdown';\nimport { Sheet } from '../UNSAFE_Sheet';\nimport { BaseTabBarItem } from './BaseTabBarItem';\nimport { styles } from './themes/OverflowTabBarItemStyles.css';\nimport { TabBarItem } from './TabBarItem';\n\nexport type OverflowSelectionDetail<K> = {\n  value: K;\n};\n\nexport type CloseDetail = {\n  /**\n   * dismissed represents dismissing the DropDown\n   */\n  reason: 'dismissed' | 'itemAction' | 'outsideMousedown';\n};\n\nexport type Item<K extends string | number> = Omit<\n  ComponentProps<typeof TabBarItem<K>>,\n  'testId' | 'aria-controls'\n> & {\n  isRemovable?: boolean;\n  /**\n   * Accepts the tabpanel element's ID associated with the tab item\n   **/\n  tabPanelId?: string;\n};\n\nexport type OverflowTabBarItemProps<K extends string | number> = {\n  /**\n   * Key of the TabBarItem\n   */\n  overflowItemKey: K;\n  /**\n   * Whether to open the popup\n   */\n  isOpen: boolean;\n  /**\n   * Property that triggers a callback when DropDown is supposed to be closed.\n   */\n  onClose?: (detail: CloseDetail) => void;\n  /**\n   * The icon of the OverflowTabBarItem\n   */\n  icon?: ComponentChild;\n  /**\n   * The content to be rendered inside the Badge component.\n   */\n  badge?: string;\n  /**\n   * An array of data used by NavigationList to render individual overflow items.\n   */\n  overflowItems?: Item<K>[];\n};\n\n/**\n * An OverflowTabBarItem renders TabBarItems in a device appropriate popup. OverflowTabBarItem is used internally in an OverflowTabBar.\n */\n\nexport function OverflowTabBarItem<K extends string | number>({\n  overflowItemKey,\n  icon,\n  badge,\n  overflowItems,\n  isOpen,\n  onClose\n}: OverflowTabBarItemProps<K>) {\n  const { selection, showFocusRing, isEdgeBottom, onSelect, onRemove, layout } = useTabBarContext();\n\n  const isPointerSelection = useRef<boolean>(false);\n\n  const overflowTabBarItemRef = useRef<HTMLDivElement>(null);\n  const navigationListRef = createRef<FocusableHandle>();\n\n  const handleSelectionChange = useCallback<\n    Required<ComponentProps<typeof NavigationList>>['onSelectionChange']\n  >(\n    (detail: { value: string | number; reason?: 'pointer' | 'keyboard' }) => {\n      if (detail.reason === 'pointer') {\n        isPointerSelection.current = true;\n      }\n      onSelect?.({ value: detail.value });\n      onClose?.({ reason: 'itemAction' });\n    },\n    [onSelect, onClose]\n  );\n\n  const handleDropdownClose = useCallback(\n    (e: CloseDetail) => {\n      onClose?.({ reason: e.reason });\n    },\n    [onClose]\n  );\n\n  const handleSheetClose = useCallback(() => {\n    onClose?.({ reason: 'dismissed' });\n  }, [onClose]);\n\n  //When NavigationList steals focus the app resets it. Not always would it be reset to\n  //parent of OverflowTabBarItem. Though currentKey would be correct, but focusRing would would not be visible\n  //Hence we check for isPointerSelection.current\n\n  const focusRingRequirement = showFocusRing && !isPointerSelection.current && !getIsMobile();\n\n  const overflowContainsKey = (searchKey: K) => {\n    return overflowItems?.find((item) => item.itemKey === searchKey) != null;\n  };\n\n  const currentPanelId = overflowItems?.find((item) => item.itemKey === selection)?.tabPanelId;\n\n  const translations = useTranslationBundle<BundleType>('@oracle/oraclejet-preact');\n\n  const isSelected = selection !== undefined && overflowContainsKey(selection as K);\n\n  //instead of specifying flex: '1 0 auto' in cssProps var\n  const styleInterpolations = mergeInterpolations<FlexitemProps>([\n    ...Object.values(flexitemInterpolations)\n  ]);\n  const flexDimensions = styleInterpolations({\n    flex: layout === 'stretch' ? '1 0 auto' : '0 0 auto'\n  });\n\n  const navContainerClasses = classNames([styles.navContainerBase]);\n\n  const navContainerRef = useRef<HTMLDivElement>(null);\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === 'ArrowDown') {\n        event.preventDefault();\n        navigationListRef.current?.focus();\n      }\n    },\n    [navigationListRef]\n  );\n  const getNavigationList = useCallback(() => {\n    return (\n      <div onKeyDown={handleKeyDown} tabIndex={0} ref={navContainerRef} class={navContainerClasses}>\n        <NavigationList\n          ref={navigationListRef}\n          selection={selection}\n          onSelectionChange={handleSelectionChange}\n          onRemove={onRemove}>\n          {overflowItems?.map((item) =>\n            item.isRemovable ? (\n              <RemovableNavigationListItem\n                itemKey={item.itemKey}\n                label={item.label}\n                badge={item.badge}\n                metadata={item.metadata}\n                severity={item.severity}\n              />\n            ) : (\n              <NavigationListItem\n                itemKey={item.itemKey}\n                label={item.label}\n                badge={item.badge}\n                metadata={item.metadata}\n                severity={item.severity}\n              />\n            )\n          )}\n        </NavigationList>\n      </div>\n    );\n  }, [\n    handleKeyDown,\n    navContainerClasses,\n    navigationListRef,\n    selection,\n    handleSelectionChange,\n    onRemove,\n    overflowItems\n  ]);\n\n  return (\n    <>\n      {overflowItems && overflowItems.length > 0 && (\n        <div ref={overflowTabBarItemRef} style={flexDimensions}>\n          <BaseTabBarItem\n            aria-controls={currentPanelId}\n            itemKey={overflowItemKey}\n            label={translations.overflowItemLabel()}\n            icon={icon ? icon : <OverflowH />}\n            badge={badge}\n            showFocusRingOverride={focusRingRequirement}\n            selectionOverride={isSelected}\n            displayOverride={'icons'}\n            aria-haspopup={true}\n          />\n        </div>\n      )}\n      {getIsMobile() ? (\n        <Sheet isOpen={isOpen} onClose={handleSheetClose}>\n          {getNavigationList()}\n        </Sheet>\n      ) : (\n        <Dropdown\n          initialFocus=\"firstFocusable\"\n          isOpen={isOpen}\n          onClose={handleDropdownClose}\n          placement={isEdgeBottom ? 'top-end' : 'bottom-end'}\n          anchorRef={overflowTabBarItemRef}>\n          {getNavigationList()}\n        </Dropdown>\n      )}\n    </>\n  );\n}\n\nconst getIsMobile = () => {\n  const { deviceType } = getClientHints();\n  return deviceType === 'phone';\n};\n"],"names":["_jsx","_jsxs","_Fragment","OverflowH"],"mappings":"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"}