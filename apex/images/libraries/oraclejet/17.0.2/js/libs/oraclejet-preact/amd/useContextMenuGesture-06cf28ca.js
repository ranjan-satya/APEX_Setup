define(['exports', 'preact/hooks', './clientHints-030d25aa', './textSelectionUtils-06c7855d'], (function(e,t,n,r){"use strict";const c=750,o=5;e.useContextMenuGesture=(e,u={isDisabled:!1})=>{const s="ios"===n.getClientHints().platform,a=t.useRef(!1),l=t.useRef({}),i=t.useRef(!1),d=t.useRef(),g=t.useCallback((()=>!!i.current||r.getIsSelectionPending()),[]),m=t.useCallback((()=>{document.body.style.userSelect=l.current.bodyUserSelectValue,document.body.style.webkitUserSelect=l.current.webkitBodyUserSelectValue,l.current.iosOpenedContextMenu=!1}),[]);t.useEffect((()=>{const e=()=>{const{timeNeededForSelection:e,iosStartTime:t}=l.current;t&&!e&&"Range"===document.getSelection()?.type&&(clearTimeout(d.current),l.current.timeNeededForSelection=Date.now()-t,l.current.launchIosContextMenu?.(c))},t=e=>{"#text"===(e?.target).nodeName?(i.current=!0,setTimeout((()=>{i.current=!1}),10)):i.current=!1};return s?document.addEventListener("selectionchange",e,!0):document.addEventListener("selectstart",t,!0),()=>{document.removeEventListener("selectionchange",e,!0),document.removeEventListener("selectstart",t,!0)}}),[s]);const y=t.useCallback((t=>{g()||(t.preventDefault(),a.current?a.current=!1:e({gesture:"touch"===t.pointerType?"touch":"mouse",anchor:{x:t.clientX,y:t.clientY,contextElement:t.currentTarget},currentTarget:t.currentTarget,target:t.target}))}),[e,g]),b=t.useCallback((t=>{if(!g()&&"F10"===t.key&&t.shiftKey){a.current=!0;const n=t.currentTarget;e({gesture:"keyboard",anchor:n,currentTarget:n,target:t.target})}}),[e,g]),h=t.useCallback((t=>{if(1===t.touches.length){const n=l.current.timeNeededForSelection;let r=2*c;void 0===n?l.current.iosStartTime=Date.now():r=n+c;const o=t.touches[0];l.current.touchPageCoords={x:o.pageX,y:o.pageY};const u=t.currentTarget,s=n=>{d.current=setTimeout((()=>{l.current.bodyUserSelectValue=document.body.style.userSelect,l.current.webkitBodyUserSelectValue=document.body.style.webkitUserSelect,document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.getSelection()?.empty(),l.current.iosOpenedContextMenu=!0,e({gesture:"touch",anchor:{x:o.clientX,y:o.clientY,contextElement:u},currentTarget:u,target:t.target})}),n)};l.current.launchIosContextMenu=s,s(r)}}),[e]),C=t.useCallback((e=>{const t=e.touches[0];(Math.abs(l.current.touchPageCoords?.x-t.pageX)>o||Math.abs(l.current.touchPageCoords?.y-t.pageY)>o)&&clearTimeout(d.current)}),[]),T=t.useCallback((e=>{clearTimeout(d.current),l.current.iosOpenedContextMenu&&(e.preventDefault(),setTimeout((()=>{m()}),500))}),[m]),S=t.useCallback((()=>{clearTimeout(d.current),l.current.iosOpenedContextMenu&&m()}),[m]);return{triggerProps:u.isDisabled?{}:{onContextMenu:y,onKeyDown:b,...{...s?{onTouchStart:h,onTouchMove:C,onTouchEnd:T,onTouchCancel:S}:{}}}}}}));
//# sourceMappingURL=useContextMenuGesture-06cf28ca.js.map
