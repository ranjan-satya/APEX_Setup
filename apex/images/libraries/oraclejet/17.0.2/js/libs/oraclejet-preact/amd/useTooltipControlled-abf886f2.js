define(['exports', 'preact/jsx-runtime', 'preact/hooks', './useId-c9578d26', './Floating-85851b1a', './Layer-3cc44164', 'preact/compat', './LayerHost-eab40731', './useHover-1890d6a0', './useFocus-4194fc59', './useTouch-37489bb5', './mergeProps-bcfa6a92', './useAnimation-5bd3adfc', './useComponentTheme-5aa41a8f', './useTestId-82cf22a4', './useThemeInterpolations-41cbd433', './classNames-08d99695', './hooks/UNSAFE_useTooltip/themes/redwood/TooltipContentTheme', './EnvironmentProvider-46d0a245', './useColorScheme-711c1e4b'], (function(e,t,n,o,s,r,u,i,c,a,l,d,m,h,p,f,g,b,v,T){"use strict";const y=({children:e,id:o,isOpen:s,isDatatip:r,onTransitionEnd:u,testId:i,...c})=>{const a=n.useRef(null),l=n.useRef(null),d=p.useTestId(i),{baseTheme:v,variantClasses:T,styles:y}=h.useComponentTheme(b.TooltipContentRedwoodTheme,{variant:r?"datatip":"tooltip"}),k=f.useThemeInterpolations(),{nodeRef:P}=m.useAnimation(s?"mounted":"unmounted",{animationStates:{mounted:e=>{const t=e.firstChild;return{from:{maxHeight:"0",opacity:"0%"},to:{maxHeight:`${t?.offsetHeight}px`,opacity:r?"100%":"95%"},options:{duration:r?1:100,easing:[0,0,.2,1]}}},unmounted:e=>({from:{opacity:r?"100%":"95%"},to:{maxHeight:"0",opacity:"0%"},options:{duration:r?1:100,easing:[0,0,.2,1]}})},isAnimatedOnMount:!0,onAnimationEnd:()=>u?.()});return n.useEffect((()=>{a.current&&l.current?.offsetHeight&&(a.current.style.height=`${l.current?.offsetHeight}px`)}),[]),t.jsx("div",{ref:a,id:o,role:"tooltip",class:g.classNames([y.wrapper,k,v]),...d,children:t.jsx("div",{ref:P,class:y.inner,...c,children:t.jsx("div",{ref:l,class:g.classNames([T,y.content]),children:e})})})};const k=new class{constructor(){this.keyDownHandler=e=>{"Tab"===e.key&&(this.tabKeyActive=!0,setTimeout((()=>{this.tabKeyActive=!1}),100))},this.register=e=>{this.activeCallback&&this.activeCallback!==e&&this.activeCallback(),this.activeCallback=e},this.unregister=e=>{this.activeCallback===e&&(this.activeCallback=null)},this.isTabKeyActive=()=>this.tabKeyActive,this.activeCallback=null,this.tabKeyActive=!1,window.addEventListener("keydown",this.keyDownHandler,!0)}};e.useTooltipControlled=({text:e,isOpen:u=!1,variant:i="tooltip",position:m="bottom",focusStrategy:h="browser",isDisabled:p=!1,anchor:f={x:"element",y:"element"},offset:g={mainAxis:0,crossAxis:0},onToggle:b,testId:P})=>{const x=p||!e,C=n.useRef(!0),[E,A]=n.useState(!x&&u?"mounting":"unmounted"),R=n.useRef(E),w=e=>{R.current=e,A(e)},[H,D]=n.useState(!1);D(!1);const I="datatip"===i,[S,j]=n.useState(!1),F="logical"===h,L=n.useRef(!0),{hoverProps:K,isHover:B}=c.useHover({}),{touchProps:M,isTouch:N}=l.useTouch({isDisabled:p}),{focusProps:O,isFocus:_}=a.useFocus({isDisabled:F}),{hoverProps:G,isHover:U}=c.useHover({isDisabled:p}),$="pointer"===f.x||"pointer"===f.y,V=n.useRef(o.useId()),X=n.useRef(null),Y=n.useRef({x:-9999,y:-9999}),q=$&&!_?Y:X,z=I?0:250,J=n.useRef(null),Q=T.useColorScheme(),W=Q&&"light"!==Q?"light":"dark",Z=n.useRef(!1),ee=n.useRef(!1),te=()=>{J.current&&(clearTimeout(J.current),J.current=null)};n.useEffect((()=>{Z.current=F?S:_&&k.isTabKeyActive(),Z.current&&(ee.current=!1)}),[_,S,F]),n.useEffect((()=>{ee.current=B,ee.current&&(Z.current=!1)}),[B]),n.useEffect((()=>{L.current?L.current=!1:$&&B&&"unmounted"===E||(e=>{if(e)switch(E){case"unmounted":w("mountPending");break;case"unmounting":w("mounting"),b?.({value:!0});break;case"unmountPending":te(),w("mounted")}else switch(E){case"mounting":case"mounted":w("unmountPending");break;case"mountPending":te(),de(),w("unmounted")}})(B&&ee.current||(_||S)&&Z.current||U||N)}),[B,_,S,U,N,$,E,b]);const ne=n.useCallback((()=>{Z.current=!1,ee.current=!1,b?.({value:!1})}),[]);n.useEffect((()=>{C.current?C.current=!1:w(u?"mounting":"unmounting")}),[u]),n.useEffect((()=>()=>{te(),Z.current=!1,ee.current=!1}),[]),n.useEffect((()=>{"mounted"===E?k.register(ne):"unmounted"===E&&k.unregister(ne)}),[E,ne]),n.useEffect((()=>(J.current||"mountPending"!==E&&"unmountPending"!==E||(J.current=setTimeout((()=>{te(),"mountPending"!==E&&"unmountPending"!==E||E!==R.current||b?.({value:"mountPending"===E})}),z)),()=>{te()})),[E,z,b]);const oe=e=>{j(!0),X.current=e,q.current=e},se=()=>{j(!1)},re=n.useCallback((e=>{(e.eventPhase===Event.AT_TARGET||e.eventPhase===Event.BUBBLING_PHASE&&I)&&(X.current=e.target)}),[I]),ue=n.useCallback((e=>{e.eventPhase===Event.AT_TARGET&&(Z.current=!1)}),[]),ie=F?{}:{onFocus:re,onBlur:ue},ce={onMouseEnter:n.useCallback((e=>{X.current=e.target}),[])},ae={onKeyDown:n.useCallback((e=>{"Escape"===e.code&&Z.current&&(e.preventDefault(),Z.current=!1,b?.({value:!1}))}),[b])};let le;const de=()=>{Y.current={x:-9999,y:-9999}};if(x)le=d.mergeProps(K,O,ce,ie);else{const e={"aria-describedby":V.current,...$&&{onMouseLeave:()=>{"mounting"!==E&&te()},onMouseMove:e=>{(e=>{if("unmounted"!==E&&("datatip"!==i||"mounted"!==E))return;const t=X?.current?.getBoundingClientRect(),n=document.body.scrollLeft+(t?.left||0)+(t?.width||0),o=document.body.scrollTop+(t?.top||0)+(t?.height||0),s="pointer"===f.x?e.clientX:n,r="pointer"===f.y?e.clientY:o;"mounted"===E?(Y.current={x:s,y:r},!0!==H&&D(!0)):"unmounted"===E&&(te(),J.current=setTimeout((()=>{"unmounted"===E&&(Y.current={x:s,y:r},b?.({value:!0}))}),z))})(e)}}};le=d.mergeProps(K,O,M,ce,ie,e,ae,F?{onLogicalFocus:oe,onLogicalBlur:se}:{})}if(x)return te(),de(),{tooltipContent:null,tooltipProps:le};const me=(e=>{let t="bottom";switch(e){case"top":case"end":case"bottom":case"start":t=e;break;case"top-end":t="top-end-corner";break;case"bottom-end":t="bottom-end-corner";break;case"bottom-start":t="bottom-start-corner";break;case"top-start":t="top-start-corner"}return t})(m),he=t.jsx(y,{id:V.current,testId:P,isOpen:["mounting","mounted","unmountPending"].includes(E),...G,isDatatip:I,onTransitionEnd:()=>{"mounting"===E&&w("mounted"),"unmounting"===E&&(de(),w("unmounted"))},children:e}),pe=t.jsx(r.Layer,{children:t.jsx(s.Floating,{anchorRef:q,placement:me,offsetValue:g,children:"tooltip"===i?t.jsx(v.EnvironmentProvider,{environment:{colorScheme:W},children:he}):t.jsx(t.Fragment,{children:he})})});return{tooltipContent:!["unmounted","mountPending"].includes(E)&&pe,tooltipProps:le}}}));
//# sourceMappingURL=useTooltipControlled-abf886f2.js.map
