define(['exports', 'preact/jsx-runtime', './classNames-08d99695', './SvgSymbol-d0266621', './UNSAFE_Legend/themes/LegendStyles.css', './Text-e132dec0', 'preact/compat', 'preact/hooks', './useUser-6dd85af9', './datatipUtils-1b8ab042', './useDatatip-d00735e9', './useTextDimensions-b37344b4', './useContextMenu-e6b10380', './Menu-51409b28', './MenuItem-644f8619', 'preact', './useTooltipControlled-abf886f2', 'css!./IconStyle.styles.css', './SelectMenuGroupContext-67f24a8f', './logger-0f873e29', './UNSAFE_Separator/themes/SeparatorStyles.css', 'css!./MenuSeparatorStyles.styles.css', 'module', './UNSAFE_Menu/themes/redwood/MenuSeparatorVariants.css', './LayerHost-eab40731', './Common/themes/themeContract.css', './utils-61ef4ad6', './eventsUtils-5d567a9d'], (function(e,t,n,i,o,r,s,l,a,d,c,u,m,h,x,g,f,y,I,S,b,C,p,F,v,M,W,w){"use strict";function T(e){const{imageMarkerStyle:n}=o.styles;return t.jsx("img",{class:n,src:e.source})}const k=({markerColor:e="#a6acb1",lineColor:n="#a6acb1",markerShape:r="square",isHidden:s=!1,lineStyle:l="none",...a})=>{const{legendSymbolBaseStyle:d}=o.styles,c=!(null==a.width&&null==a.height)&&("rectangle"===r||"ellipse"===r),u="none"!=l&&"none"!=r?2:3;return t.jsx("div",{className:d,style:{width:a.width,height:a.height},children:a.source?t.jsx(T,{source:a.source}):t.jsx(i.SvgSymbol,{setAspectRatioNone:c,markerShape:s?"square":r,lineStyle:s?"none":l,lineColor:n,lineLength:a.lineLength,lineWidth:null!=a.lineWidth?a.lineWidth:u,markerColor:s?"transparent":e,borderColor:s?e||n:a.borderColor,setAbsolutePos:!0})})},R=({text:e,type:i="label",id:s,align:l="start",...a})=>{const{legendTextBaseStyle:d,legendTextTitle:c,legendTitleStartAlign:u,legendTitleCenterAlign:m,legendTitleEndAlign:h}=o.styles,x="title"===i;return t.jsx("div",{class:n.classNames([d,x?c:"",x&&"start"===l?u:"",x&&"center"===l?m:"",x&&"end"===l?h:""]),style:{...a},children:t.jsx(r.Text,{size:"inherit",variant:"inherit",weight:"inherit",truncation:"ellipsis",id:s,children:e})})},L=e=>{const t=e.dataset.ojItem,n=e.dataset.ojSection;if(null!=t&&null!=n)return{itemIdx:Number(t),sectionIdx:Number(n)}};function A(e,t){if(t)return 0===t.length||new Set(t).has(e)}function j(e,t){if(t)return new Set(t).has(e)}const E=(e,t,n)=>{if(!e.isFocusVisible)return!1;const{itemIdx:i,sectionIdx:o}=e;return null==n?i===t:i===t&&o===n};const P=[{tokenVar:W.xUnits(1),key:"unit",cssProp:"padding"},{tokenVar:M.dvtVars.label.sm.fontSize,key:"fontSize",cssProp:"font-size"}];function D(e,t,n,i,r,s){if(e){if(null==t&&null==r&&"off"!==s)return o.styles.legendItemIsCurrentWithCursor;if(null==t&&"on"===n&&"off"!==s)return o.styles.legendItemIsCurrentWithCursor;if(null==r&&"dim"===i&&"off"!==s)return o.styles.legendItemIsCurrentWithoutCursor}return""}const H=s.forwardRef((({id:e,text:i,sectionIdx:r,itemIdx:s,isHighlighted:l,symbolHeight:a,symbolWidth:d,isFocused:c,isCurrent:u,isHidden:m,actionable:h="inherit",hoverBehavior:x="none",hideAndShowBehavior:g="off",...f},y)=>{const I={fontFamily:f.textFontFamily,fontSize:f.textFontSize,color:f.textColor,fontStyle:f.textFontStyle,fontWeight:f.textFontWeight,textDecoration:f.textTextDecoration},S={lineStyle:f.lineStyle,lineWidth:f.lineWidth,markerShape:f.markerShape,markerColor:f.markerColor,source:f.source,borderColor:f.borderColor,lineColor:f.lineColor},b=l||null==l,{legendItemBaseStyle:C,legendItemOpacity:p,legendItemFocusRing:F}=o.styles;return t.jsxs("div",{class:n.classNames([C,D(u,l,g,x,m,h),b?"":p,c?F:"",f.class]),style:{gridRow:f.gridRow,gridColumn:f.gridCol,minWidth:void 0!==f.minWidth?`${f.minWidth}px`:void 0},id:e,ref:y,"data-oj-section":r,"data-oj-item":s,role:null!=m?"menuitemcheckbox":"img","aria-checked":null!=m?!m:void 0,"aria-label":f["aria-label"]||i,children:[t.jsx(k,{...S,isHidden:m,lineLength:d,width:null!=d?`${d}px`:void 0,height:null!=a?`${a}px`:void 0}),t.jsx(R,{...I,text:i,type:"label"})]})})),z=(e,t,n,i)=>{let o=0,r=d.DATATIP_OFFSET;if(e.current&&n.isCurrent&&t.current){const n=t.current,s=e.current.getBoundingClientRect();o=s.x+s.width/2-(n.x+n.width/2),o=i?-1*o:o,r+=n.y-s.y,r=Math.min(d.DATATIP_OFFSET,Math.max(r,s.height-n.height+d.DATATIP_OFFSET))}return{crossAxis:o,mainAxis:r}},N=(e,t,n,i,o)=>{let r=0,s=0,l=0;return l=o?1.5*t+o:4*t,e?.forEach((e=>{const o=e,{width:a}=n(o.text,i),d=2.5*t+a;s+=l+d,r=Math.max(r,Math.ceil(l+d))})),{maxItemWidth:r,horizontalSectionWidth:s}};e.BaseLegend=({orientation:e="horizontal",highlightedIds:i,hiddenIds:r,focusedItemInfo:s,hoveredItemInfo:l,sectionIdx:a,activeId:d,isReadOnly:c,items:u,symbolHeight:m,symbolWidth:h,hideAndShowBehavior:x="off",hoverBehavior:g="none",...f})=>{const y="horizontal"===e,I=y?`repeat(${f.itemsPerRow}, ${f.itemWidth})`:void 0,{baseLegendStyles:S,baseLegendHorizontal:b,baseLegendVertical:C,baseLegendVerticalItem:p,baseLegendPaddingBottom:F,baseLegendPaddingTop:v,baseLegendPaddingEnd:M}=o.styles;return t.jsx("div",{className:n.classNames([S,y?b:C]),style:{gridTemplateColumns:I,maxWidth:"100%"},children:u.map(((e,o)=>{const{markerColor:I,markerShape:S,source:b,borderColor:C,lineColor:W,isCurrent:w,isFocused:T,isHidden:k,isHighlighted:R,key:L,actionable:P,text:D,lineStyle:z,lineWidth:N}=function(e,t,n,i,o,r,s,l){let a=!1;if(!o){const e=t===i.itemIdx&&n===i.sectionIdx,o=t===r?.itemIdx&&n===r?.sectionIdx;a=!!(e&&i.isCurrent||o&&r?.isCurrent)}return{isCurrent:a,isHighlighted:A(e.id,l),isHidden:j(e.id,s),isFocused:E(i,t,n),key:e.id,...e}}(e,o,a,s,c,l,r,i),B=s.sectionIdx===a&&s.itemIdx===o,{gridRow:V,gridCol:U}=function(e,t,n,i){let o,r;return n&&i&&e>n&&(o=t%i+1,r=Math.floor(t/i)+1),{gridRow:o,gridCol:r}}(u.length,o,f.itemsPerRow,f.itemsPerCol),O=null!=V&&V!=f.itemsPerCol,$=null!=V&&1!=V;return t.jsx(H,{ref:B?f.focusedItemRef:void 0,text:D,itemIdx:o,sectionIdx:a,symbolHeight:m,symbolWidth:h,markerColor:I,markerShape:S,lineStyle:z,lineWidth:N,source:b,borderColor:C,"aria-label":e["aria-label"],lineColor:W,isCurrent:w,isFocused:T,isHidden:k,isHighlighted:R,gridRow:V,gridCol:U,minWidth:f.itemWidth,id:w?d:"",textColor:f.textColor,textFontFamily:f.textFontFamily,textFontSize:f.textFontSize,textFontStyle:f.textFontStyle,textFontWeight:f.textFontWeight,textTextDecoration:f.textTextDecoration,class:n.classNames([y?"":p,$?v:"",O?F:"",M]),hideAndShowBehavior:x,hoverBehavior:g,actionable:P},L)}))})},e.LegendText=R,e.getAriaProps=function(e,t,n,i,o){return{"aria-label":t,"aria-disabled":e,role:n&&!e?"menu":"application","aria-describedby":i,"aria-labelledby":o}},e.getDatatipText=function(e,t,n,i){const o=i?.isCurrent;return o&&null!=i.itemIdx?t(i,e)?.datatip:n&&n.isCurrent?t(n,e)?.datatip:void 0},e.getGridNums=(e,t)=>{let n,i;return t?.isWrapped&&(n=t.itemsPerRow,i=Math.ceil(e/n),n=Math.ceil(e/i)),{itemsPerRow:n,itemsPerCol:i}},e.getIsLegendItemActionable=function(e,t,n){return i=>{let o;return o=n&&null!=i.sectionIdx?e[i.sectionIdx].items[i.itemIdx]:e[i.itemIdx],!t&&"off"!==o?.actionable}},e.getItemInfo=L,e.getKeyUpHandler=function(e,t,n,i){return o=>{switch(o.code){case"Space":i&&(e(),w.cancelEvent(o));break;case"Enter":e(),w.cancelEvent(o);break;case"Home":t({itemIdx:0,sectionIdx:0,isFocusVisible:!0,isCurrent:!0}),w.cancelEvent(o);break;case"End":t({itemIdx:-1,sectionIdx:-1,isCurrent:!0,isFocusVisible:!0}),w.cancelEvent(o);break;case"Tab":t({...n,isCurrent:!0,isFocusVisible:!0}),w.cancelEvent(o)}}},e.getLegendTextStyle=function(e,t){return{fontStyle:e.fontStyle,fontSize:t.fontSize??e.fontSize,fontWeight:e.fontWeight,fontFamily:e.fontFamily}},e.isEqualItem=(e,t)=>e?.itemIdx===t?.itemIdx&&e?.sectionIdx===t?.sectionIdx,e.legendVars=P,e.useLegendContextMenu=({rootRef:e,contextMenuConfig:t,focusedItemInfo:n,items:i,sections:o,isReadOnly:r,onContextMenuDismissed:s})=>{const{contextMenuProps:l,contextMenuContent:a}=m.useContextMenu({onContextMenuHandler:({gesture:t,target:r})=>{let s,l,a,d,c;return"keyboard"===t?(l=n.itemIdx,a=n.sectionIdx,i?s=e.current?.querySelector(`[data-oj-item="${l}"]`):o&&(s=e.current?.querySelector(`[data-oj-item="${l}"][data-oj-section="${a}"]`))):(l=L(r)?.itemIdx,o&&(a=L(r)?.sectionIdx)),i?d=void 0!==l?i[l]:null:o&&(d=void 0!==a&&void 0!==l?o[a]?.items[l]:null),c=d?{type:"item",data:d}:{type:"background"},{context:c,elem:s}},contextMenuOptions:{isDisabled:!t||r},rootRef:e,contextMenuConfig:t,onContextMenuDismissed:s});return{contextMenuContent:a,contextMenuProps:l}},e.useLegendDatatip=({text:e,rootDimsRef:t,focusedItemRef:n,focusedItemInfo:i,touchResponse:o})=>{const{direction:r}=a.useUser(),s="rtl"===r,[d,u]=l.useState(z(n,t,i,s));l.useLayoutEffect((()=>{u(z(n,t,i,s))}),[i,n,s,t]);const m=i?.isCurrent?"element":"pointer";return c.useDatatip({content:e,placement:"top",anchor:m,offset:d,touchResponse:o})},e.useLegendLayout=function({resolvedVars:e,sections:t,items:n,rootRef:i,rootDimsRef:o,orientation:r,legendFontStylesObj:s={},symbolWidth:a}){const{textMeasureContent:d,getTextDimensions:c}=u.useTextDimensions(),m=l.useRef(r),h=m.current!==r,[x,g]=l.useState(!1);return l.useLayoutEffect((()=>{h&&(m.current=r,g(!x))}),[h,x,r]),{textMeasureContent:d,layoutInfo:l.useMemo((()=>{if(!i.current||!Object.keys(e).length||!c||h||"vertical"===r)return;const l=parseFloat(e.unit);o.current=i?.current?.getBoundingClientRect();let d=0,u=!1;if(t&&t.forEach((e=>{const{maxItemWidth:t,horizontalSectionWidth:n}=N(e.items,l,c,s,a);u||(u=n>Math.ceil(o.current?.width)),d=Math.max(d,t)})),n){const{maxItemWidth:e,horizontalSectionWidth:t}=N(n,l,c,s,a);d=e,u=t>Math.ceil(o.current?.width)}return{maxItemWidth:Math.min(d,o.current?.width),itemsPerRow:Math.max(1,Math.floor(o.current?.width/d)),isWrapped:u}}),[t,n,o,i,s,e,a,c,r,h])}}}));
//# sourceMappingURL=useLegendContextMenu-5b1ca75b.js.map
