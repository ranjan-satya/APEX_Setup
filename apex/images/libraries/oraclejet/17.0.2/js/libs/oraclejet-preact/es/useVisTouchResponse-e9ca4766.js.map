{"version":3,"file":"useVisTouchResponse-e9ca4766.js","sources":["../../src/hooks/PRIVATE_useVisTouchResponse/useVisTouchResponse.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * Licensed under The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\n\nimport { Ref, useEffect, useState } from 'preact/hooks';\n\ntype TouchResponseAutoOptions =\n  | {\n      type: 'auto';\n      supportsTouchDragGestures: true;\n    }\n  | {\n      type: 'auto';\n      supportsTouchDragGestures: false;\n      rootRef: Ref<HTMLElement>;\n    };\n\ntype TouchResponseTouchStartOptions = {\n  type: 'touchStart';\n};\n\ntype TouchResponseTouchHoldOptions = {\n  type: 'touchHold';\n};\n\n/**\n * Returns resolved touch response related values.\n */\nexport function useVisTouchResponse(\n  options: TouchResponseAutoOptions | TouchResponseTouchStartOptions | TouchResponseTouchHoldOptions\n) {\n  const resolvedAutoTouchResponse = useVisAutoTouchResponse(\n    options.type === 'auto' ? options : { type: 'auto', supportsTouchDragGestures: true } // dummy options; the output won't be used here for non-auto type.\n  );\n\n  return options.type === 'auto'\n    ? resolvedAutoTouchResponse\n    : {\n        touchResponse: options.type,\n        touchResponseStyle: {\n          touchAction: options.type === 'touchStart' ? 'none' : 'auto'\n        }\n      };\n}\n\nfunction useVisAutoTouchResponse(options: TouchResponseAutoOptions) {\n  const { supportsTouchDragGestures } = options;\n  const rootRef = !supportsTouchDragGestures ? options.rootRef : undefined;\n\n  const [touchResponse, setTouchResponse] = useState<'touchStart' | 'touchHold'>('touchHold');\n\n  useEffect(() => {\n    if (supportsTouchDragGestures) {\n      setTouchResponse('touchHold');\n    } else if (rootRef && rootRef.current) {\n      setTouchResponse(resolveTouchResponse(rootRef.current));\n    }\n  }, [rootRef, supportsTouchDragGestures]);\n\n  return {\n    touchResponse,\n    touchResponseStyle: {\n      touchAction: touchResponse === 'touchStart' || supportsTouchDragGestures ? 'none' : 'auto'\n    }\n  };\n}\n\nconst resolveTouchResponse = (root: HTMLElement) => {\n  // Almost entirely copied from Dvt.EventManager.isTouchResponseTouchStart\n  const TOUCH_RESPONSE_PADDING_CHECK = 10;\n  let r: HTMLElement | null = root;\n  while (r) {\n    const style = window.getComputedStyle(r);\n    if (\n      (style.overflow !== 'hidden' &&\n        ((r.scrollWidth > r.clientWidth + TOUCH_RESPONSE_PADDING_CHECK &&\n          style.overflowX !== 'hidden') ||\n          (r.scrollHeight > r.clientHeight + TOUCH_RESPONSE_PADDING_CHECK &&\n            style.overflowY !== 'hidden'))) ||\n      (window.frameElement && window.frameElement.nodeName == 'IFRAME')\n    ) {\n      return 'touchHold';\n    }\n    if (r.nodeName === 'HTML') {\n      break;\n    }\n    r = r.parentElement;\n  }\n  return 'touchStart';\n};\n"],"names":[],"mappings":";;;AAAA;;;;;;AAMG;AAuBH;;AAEG;AACG,SAAU,mBAAmB,CACjC,OAAkG,EAAA;IAElG,MAAM,yBAAyB,GAAG,uBAAuB,CACvD,OAAO,CAAC,IAAI,KAAK,MAAM,GAAG,OAAO,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,yBAAyB,EAAE,IAAI,EAAE;KACtF,CAAC;AAEF,IAAA,OAAO,OAAO,CAAC,IAAI,KAAK,MAAM;AAC5B,UAAE,yBAAyB;AAC3B,UAAE;YACE,aAAa,EAAE,OAAO,CAAC,IAAI;AAC3B,YAAA,kBAAkB,EAAE;AAClB,gBAAA,WAAW,EAAE,OAAO,CAAC,IAAI,KAAK,YAAY,GAAG,MAAM,GAAG,MAAM;AAC7D,aAAA;SACF,CAAC;AACR,CAAC;AAED,SAAS,uBAAuB,CAAC,OAAiC,EAAA;AAChE,IAAA,MAAM,EAAE,yBAAyB,EAAE,GAAG,OAAO,CAAC;AAC9C,IAAA,MAAM,OAAO,GAAG,CAAC,yBAAyB,GAAG,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC;IAEzE,MAAM,CAAC,aAAa,EAAE,gBAAgB,CAAC,GAAG,QAAQ,CAA6B,WAAW,CAAC,CAAC;IAE5F,SAAS,CAAC,MAAK;QACb,IAAI,yBAAyB,EAAE;YAC7B,gBAAgB,CAAC,WAAW,CAAC,CAAC;SAC/B;AAAM,aAAA,IAAI,OAAO,IAAI,OAAO,CAAC,OAAO,EAAE;YACrC,gBAAgB,CAAC,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;SACzD;AACH,KAAC,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC,CAAC,CAAC;IAEzC,OAAO;QACL,aAAa;AACb,QAAA,kBAAkB,EAAE;AAClB,YAAA,WAAW,EAAE,aAAa,KAAK,YAAY,IAAI,yBAAyB,GAAG,MAAM,GAAG,MAAM;AAC3F,SAAA;KACF,CAAC;AACJ,CAAC;AAED,MAAM,oBAAoB,GAAG,CAAC,IAAiB,KAAI;;IAEjD,MAAM,4BAA4B,GAAG,EAAE,CAAC;IACxC,IAAI,CAAC,GAAuB,IAAI,CAAC;IACjC,OAAO,CAAC,EAAE;QACR,MAAM,KAAK,GAAG,MAAM,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;AACzC,QAAA,IACE,CAAC,KAAK,CAAC,QAAQ,KAAK,QAAQ;aACzB,CAAC,CAAC,CAAC,WAAW,GAAG,CAAC,CAAC,WAAW,GAAG,4BAA4B;AAC5D,gBAAA,KAAK,CAAC,SAAS,KAAK,QAAQ;iBAC3B,CAAC,CAAC,YAAY,GAAG,CAAC,CAAC,YAAY,GAAG,4BAA4B;AAC7D,oBAAA,KAAK,CAAC,SAAS,KAAK,QAAQ,CAAC,CAAC;AACpC,aAAC,MAAM,CAAC,YAAY,IAAI,MAAM,CAAC,YAAY,CAAC,QAAQ,IAAI,QAAQ,CAAC,EACjE;AACA,YAAA,OAAO,WAAW,CAAC;SACpB;AACD,QAAA,IAAI,CAAC,CAAC,QAAQ,KAAK,MAAM,EAAE;YACzB,MAAM;SACP;AACD,QAAA,CAAC,GAAG,CAAC,CAAC,aAAa,CAAC;KACrB;AACD,IAAA,OAAO,YAAY,CAAC;AACtB,CAAC;;;;"}