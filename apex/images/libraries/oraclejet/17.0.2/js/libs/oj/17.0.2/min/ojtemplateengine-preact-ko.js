/**
 * @license
 * Copyright (c) 2014, 2024, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["knockout","ojs/ojkoshared","ojs/ojcontext","ojs/ojtemplateengine-utils","ojs/ojlogger"],function(e,t,o,r,n){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;return new class{constructor(){this._defaultProps=new Map,this._bindingProvider={__ContextFor:e.contextFor,__ExtendBindingContext:t.extendBindingContext,__KoComputed:e.computed,__Observable:e.observable}}execute(e,t,o,n,a,d){const s=t.getAttribute("data-oj-as"),c=r.TemplateEngineUtils.getContext(this._bindingProvider,e,t,o,n,s,d);if(t.render)return this._executeVDomTemplate(e,t,c,d);throw new Error(`The render property is expected on the template for component ${e.id}`)}clean(t,o){let n=r.PreactTemplate.findTemplateRoots(t,o);return n.forEach(e=>{r.PreactTemplate.clean(e)}),0===n.length?e.cleanNode(t):null}resolveProperties(e,t,o,n,a,d,s,c){const l=t.render;if(l){const e=r.TemplateEngineUtils.getResolvedDefaultProps(this._defaultProps,o,n);return r.PreactTemplate.resolveVDomTemplateProps(t,l,o,n,a,e,s)}throw new Error(`The render property is expected on the template for component ${e.id}`)}defineTrackableProperty(e,t,o,n){r.TemplateEngineUtils.createPropertyBackedByObservable(this._bindingProvider,e,t,o,n)}_executeVDomTemplate(t,a,d,s){const c=o.getContext(a).getBusyContext(),l=e.pureComputed({read:()=>a.render(d.$current,s)}).extend({rateLimit:{timeout:0,method:(e,t)=>{let o;return()=>{if(!o){const r=c.addBusyState({description:"pending changes for the template element"});o=setTimeout(()=>{o=void 0,e(),r()},t)}}}}}),i=l();r.PreactTemplate.extendTemplate(a,r.PreactTemplate._ROW_CACHE_FACTORY,e=>{a._cachedRows.forEach(o=>{let n=e(o.currentContext,s);r.PreactTemplate.renderNodes(t,n,o,s)})});const p=document.createElement("div"),u={currentContext:d.$current,template:a,parentStub:p,computedVNode:l,vnode:void 0,nodes:void 0};return r.PreactTemplate.renderNodes(t,i,u,s),a._cachedRows.push(u),l.subscribe(e=>{const o=a._cachedRows.find(e=>e.computedVNode===l);o&&(o.nodes[0].isConnected||n.warn(`PreactTemplateEngineKo subscription is called to replace disconnected row for the template slot '${a.slot}' on ${t.tagName}`),r.PreactTemplate.renderNodes(t,e,o,s))}),u.nodes}}});
//# sourceMappingURL=ojtemplateengine-preact-ko.js.map